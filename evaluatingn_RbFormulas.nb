(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    307929,       7113]
NotebookOptionsPosition[    302832,       7020]
NotebookOutlinePosition[    303179,       7035]
CellTagsIndexPosition[    303136,       7032]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Initialization and Folder Selection", "Section",
 CellChangeTimes->{{3.7338249482694693`*^9, 
  3.733824956461092*^9}},ExpressionUUID->"3325b93f-79a1-4d3b-a9bc-\
058ed70576c9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dropBoxOn", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Dropbox\>\"", ",", "\"\<00School\>\"", ",", "\"\<research\>\"", 
      ",", "\"\<DataRuns\>\""}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"SystemInformation", "[", 
      RowBox[{"\"\<Kernel\>\"", ",", "\"\<OperatingSystem\>\""}], "]"}], 
     "\[Equal]", "\"\<Unix\>\""}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"folder", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "\"\</\>\"", ",", "\"\<home\>\"", ",", "\"\<karl\>\"", ",", 
         "dropBoxOn"}], "}"}], "]"}]}], ";"}], " ", ",", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Home", " ", "coputer", " ", "is", " ", "Linux"}], ",", " ", 
      RowBox[{
      "so", " ", "needs", " ", "\"\</\>\"", " ", "at", " ", "beginning"}]}], 
     " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"folder", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "\"\<C:\>\"", ",", "\"\<Users\>\"", ",", "\"\<kahrendsen2\>\"", ",", 
         "dropBoxOn"}], "}"}], "]"}]}], ";"}]}], 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Lab", " ", "computer", " ", "is", " ", "Windows"}], ",", " ", 
     RowBox[{
     "so", " ", "needs", " ", "\"\<C:\>\"", " ", "at", " ", "beginning", 
      "\"\<\>"}]}], "*)"}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", "folder", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"FileNames", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.714923340617999*^9, 3.714923409091219*^9}, {
   3.7149234410815325`*^9, 3.714923515164487*^9}, {3.7149235538857613`*^9, 
   3.7149235906850386`*^9}, {3.7149236648570905`*^9, 3.714923682295718*^9}, {
   3.7149242031385703`*^9, 3.7149243244831505`*^9}, {3.7149254927118435`*^9, 
   3.7149255481996174`*^9}, {3.7149256224971676`*^9, 3.71492562344081*^9}, {
   3.714925935922892*^9, 3.7149259845309715`*^9}, {3.7149264121099586`*^9, 
   3.714926413109638*^9}, {3.7149266461270847`*^9, 3.7149266480393734`*^9}, {
   3.7149300252161994`*^9, 3.714930038496237*^9}, {3.7149303846117835`*^9, 
   3.7149303846978426`*^9}, {3.714935110489539*^9, 3.7149351134165306`*^9}, {
   3.714935186441227*^9, 3.714935191272521*^9}, 3.714935876715088*^9, 
   3.7149943160695724`*^9, {3.714994350071789*^9, 3.7149943501499186`*^9}, {
   3.7149945442342997`*^9, 3.714994577017685*^9}, {3.714999779194906*^9, 
   3.7149998922803974`*^9}, {3.7149999380958853`*^9, 
   3.7149999875522413`*^9}, {3.7150000379148965`*^9, 
   3.7150000519314365`*^9}, {3.7150040857950153`*^9, 
   3.7150040898597813`*^9}, {3.715004428964706*^9, 3.7150044337409554`*^9}, {
   3.7150044743405857`*^9, 3.715004591399249*^9}, {3.7150047677042217`*^9, 
   3.7150047682545967`*^9}, {3.7150142060381875`*^9, 3.715014246677844*^9}, {
   3.715082636460879*^9, 3.7150826374271936`*^9}, {3.7159969142439656`*^9, 
   3.7159969344741354`*^9}, {3.7159972733630776`*^9, 3.715997286730089*^9}, {
   3.717773319569236*^9, 3.717773441892082*^9}, {3.7177734739690943`*^9, 
   3.717773476797385*^9}, {3.7177781187348285`*^9, 3.717778186663056*^9}, {
   3.7177782291589766`*^9, 3.7177782354712725`*^9}, {3.7182244395450597`*^9, 
   3.718224499936946*^9}, {3.7183568422335863`*^9, 3.718356872080847*^9}, {
   3.718359701869505*^9, 3.7183597102228236`*^9}, {3.718360001222587*^9, 
   3.718360044518225*^9}, {3.718381484990987*^9, 3.718381501071179*^9}, {
   3.722776233158925*^9, 3.7227762470845146`*^9}, {3.722781133382804*^9, 
   3.7227811516651697`*^9}, {3.723996173043811*^9, 3.723996178453082*^9}, {
   3.725156876624435*^9, 3.725156898815741*^9}, {3.725156965587986*^9, 
   3.72515696645461*^9}, {3.725622921845503*^9, 3.725622922924735*^9}, {
   3.725760876329088*^9, 3.725760877139533*^9}, {3.725796377506467*^9, 
   3.7257963785781937`*^9}, {3.732364689571804*^9, 3.732364695619491*^9}, {
   3.7390192693810863`*^9, 3.7390192770690413`*^9}, {3.7399581398143167`*^9, 
   3.739958150076726*^9}},ExpressionUUID->"f56046ef-d6db-4932-a120-\
404537e22800"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"15-06-09_USBCounterError\"\>", 
   ",", "\<\"15-07-06mockPolarizationData\"\>", ",", "\<\"16-01-14\"\>", 
   ",", "\<\"16-01-21_Data\"\>", ",", "\<\"16-05-25_PolarizationData\"\>", 
   ",", "\<\"16-07-06_PolarizationData\"\>", 
   ",", "\<\"16-08-04_PolarizationData\"\>", 
   ",", "\<\"16-08-07_HeliumTargetPictures\"\>", 
   ",", "\<\"16-08-09_PolarizationData\"\>", 
   ",", "\<\"16-10-17_polarimeter\"\>", ",", "\<\"16-10-27_DataReport\"\>", 
   ",", "\<\"16-11-03_faradayRotation\"\>", 
   ",", "\<\"16-11-07_faradayRotation\"\>", 
   ",", "\<\"16-11-18_faradayRotation\"\>", 
   ",", "\<\"16-12-09_faradayRotation\"\>", ",", "\<\"17-01-31\"\>", 
   ",", "\<\"17-02-17_plusMinus\"\>", 
   ",", "\<\"17-03-06_PlusMinusWavemeter\"\>", 
   ",", "\<\"17-03-10_non-RbFaradayRotation\"\>", 
   ",", "\<\"17-03-15_AimingFor5e12\"\>", 
   ",", "\<\"17-03-15_wavemeterNoRb\"\>", ",", "\<\"17-03-28\"\>", 
   ",", "\<\"17-03-29_pumpLaserFindingCircular\"\>", 
   ",", "\<\"17-03-30_WavemeterReliability\"\>", 
   ",", "\<\"17-04-04_polarization\"\>", ",", "\<\"17-04-06_polarization\"\>",
    ",", "\<\"17-04-07_wmReliability\"\>", ",", "\<\"17-04-18\"\>", 
   ",", "\<\"17-04-18_polarization\"\>", ",", "\<\"17-04-22\"\>", 
   ",", "\<\"17-04-25_ProbePolarizationDriftOpenChamber\"\>", 
   ",", "\<\"17-04-30_laserReport\"\>", ",", "\<\"17-05-17_DirtyGunRun\"\>", 
   ",", "\<\"17-05-18_ProbeDrift\"\>", ",", "\<\"17-05-19_BetterLaser\"\>", 
   ",", "\<\"17-05-24_SimplifiedPolarization\"\>", 
   ",", "\<\"17-05-25_LaserProfiling\"\>", 
   ",", "\<\"17-05-25_LaserProfiling - Shortcut.lnk\"\>", 
   ",", "\<\"17-06-02\"\>", ",", "\<\"17-06-06_IntensityOfProbeStudy\"\>", 
   ",", "\<\"17-06-11\"\>", ",", "\<\"17-06-13\"\>", ",", "\<\"17-06-16\"\>", 
   ",", "\<\"17-06-17\"\>", ",", "\<\"17-06-25\"\>", 
   ",", "\<\"17-07-01_nRbVsBufferGasAnalysis\"\>", 
   ",", "\<\"17-07-01_PumpLaserAnalysis\"\>", 
   ",", "\<\"17-07-03_lowerNRb_BGPStudy\"\>", 
   ",", "\<\"17-07-03_ProbeDrift\"\>", ",", "\<\"17-07-03_pumpBroadening\"\>",
    ",", "\<\"17-07-06_lotsOfProbeMeasurements\"\>", 
   ",", "\<\"17-07-06_MagneticField\"\>", ",", "\<\"17-07-06_probePower\"\>", 
   ",", "\<\"17-07-12_polVsPumpPower\"\>", 
   ",", "\<\"17-08-01_rgaInitialScans\"\>", 
   ",", "\<\"17-08-03_redoingSystemDiagnostic\"\>", 
   ",", "\<\"17-08-06_probeDrift\"\>", 
   ",", "\<\"17-08-18_furtherPolarizationStudy\"\>", 
   ",", "\<\"17-08-19_furtherPolarizationStudy2\"\>", 
   ",", "\<\"17-08-22_furtherPolarizationStudyFoundLeak\"\>", 
   ",", "\<\"17-08-29_BvsProbePower_probeDetuneVsMagnetRot\"\>", 
   ",", "\<\"17-09-05_Polarizations_100mTBGP\"\>", ",", "\<\"17-09-20\"\>", 
   ",", "\<\"17-10-03_ElectronGun\"\>", ",", "\<\"17-10-16_ElectronGun\"\>", 
   ",", "\<\"17-10-24_UnpolarizedPolarization\"\>", 
   ",", "\<\"17-10-26_24And30eVRuns\"\>", 
   ",", "\<\"17-10-28_24and30eVRedux\"\>", 
   ",", "\<\"17-11-04_MoreUnpolarizedRuns\"\>", 
   ",", "\<\"17-11-06_UnpolarizedRuns2\"\>", 
   ",", "\<\"17-11-15_BalancedPhotoDetector\"\>", 
   ",", "\<\"17-11-18_SystemDiagnosis\"\>", 
   ",", "\<\"17-12-18_SystemDiagnosis\"\>", 
   ",", "\<\"17-12-20_PolarizingElectrons\"\>", 
   ",", "\<\"18-01-03_PolarizingElectrons\"\>", 
   ",", "\<\"18-01-04_PolarizingElectrons\"\>", 
   ",", "\<\"18-01-10_ChamberWarming\"\>", 
   ",", "\<\"18-01-11_SystemDiagnostics\"\>", 
   ",", "\<\"18-01-12_recreatingPolFigure\"\>", 
   ",", "\<\"18-01-13_recreatingPolFigureIncreasedT\"\>", 
   ",", "\<\"18-01-16_morePolarization\"\>", 
   ",", "\<\"18-01-20_electronPolarization\"\>", 
   ",", "\<\"18-01-25_excitationFunctions\"\>", 
   ",", "\<\"18-01-28_bufferGasPressureVsCounts\"\>", 
   ",", "\<\"18-01-28_exFnCurrentNormalized.png\"\>", 
   ",", "\<\"18-01-28_exFnMolyCounts.png\"\>", 
   ",", "\<\"18-01-28_exFnRawCounts.png\"\>", 
   ",", "\<\"18-01-28_exFnSignalCounts.png\"\>", 
   ",", "\<\"18-01-28_hayesReproduction\"\>", 
   ",", "\<\"18-02-12_polarizedElectrons\"\>", ",", "\<\"18-02-13\"\>", 
   ",", "\<\"18-02-24_DataFrom18-02-13AllElectronEi100\"\>", 
   ",", "\<\"18-02-27\"\>", ",", "\<\"18-03-01\"\>", ",", "\<\"18-03-02\"\>", 
   ",", "\<\"18-03-03\"\>", ",", "\<\"18-03-06_RubidiumOnWalls\"\>", 
   ",", "\<\"18-03-18_100mTorrBGP\"\>", ",", "\<\"18-03-22_Ei=37eV\"\>", 
   ",", "\<\"18-03-23_pumpScan\"\>", 
   ",", "\<\"18-03-24_higherTemps350mTorr\"\>", 
   ",", "\<\"18-03-25_springBreakDataReview\"\>", 
   ",", "\<\"18-03-27_770mTorr\"\>", ",", "\<\"18-03-28_PumpPowerScan\"\>", 
   ",", "\<\"18-04-09_PumpLaserRazorProfile\"\>", ",", "\<\"18-04-18\"\>", 
   ",", "\<\"18-05-04\"\>", ",", "\<\"18-05-07\"\>", ",", "\<\"18-06-03\"\>", 
   ",", "\<\"2018-06-07\"\>", ",", "\<\"2018-06-15\"\>", 
   ",", "\<\"2018-06-19_CO2_Data\"\>", 
   ",", "\<\"2018-06-21_ProbeWalkData\"\>", 
   ",", "\<\"2018-06-25_RbProfiles\"\>", 
   ",", "\<\"2018-06-26_SpectrumAnalyzer\"\>", ",", "\<\"dataDump\"\>", 
   ",", "\<\"POL2018-03-18.dat\"\>", ",", "\<\"pumpQWP\"\>", 
   ",", "\<\"README.txt\"\>", ",", "\<\"reallyNiceData\"\>", 
   ",", "\<\"temp\"\>", ",", "\<\"test.png\"\>", 
   ",", "\<\"wavemeterOffsets\"\>"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7327196915907536`*^9, 3.7327225668243685`*^9, 3.7327228675096436`*^9, 
   3.732723194025215*^9, 3.73272732748336*^9, 3.7330584157318835`*^9, 
   3.7334091710564613`*^9, 3.733570434128659*^9, 3.733614740701775*^9, 
   3.7336573439731236`*^9, 3.733661575405802*^9, 3.733666547586644*^9, 
   3.7337461987941217`*^9, 3.7338249438232927`*^9, 3.7340918764361863`*^9, 
   3.7371586889936113`*^9, 3.737158741528144*^9, 3.737164258628336*^9, 
   3.737741698213138*^9, 3.7377418341538744`*^9, 3.737911890129649*^9, 
   3.7379122335483613`*^9, 3.7379123758072495`*^9, 3.7379124217163687`*^9, 
   3.7379125815544806`*^9, {3.7390192742094927`*^9, 
   3.7390192781159797`*^9}},ExpressionUUID->"0a9f46ec-b607-41c1-ae09-\
24fbe45b368d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
     "folder", ",", "\"\<2018-06-25_RbProfiles\>\"", ",", "\"\<data\>\""}], 
     "}"}], "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"polFileNames", "=", 
   RowBox[{"FileNames", "[", 
    RowBox[{"StringExpression", "[", 
     RowBox[{
     "\"\<POL\>\"", ",", "__", ",", "\"\<_\>\"", ",", "__", ",", 
      "DigitCharacter", ",", "\"\<.dat\>\""}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"excitationFileNames", "=", 
   RowBox[{"FileNames", "[", 
    RowBox[{"StringExpression", "[", 
     RowBox[{
     "\"\<EX\>\"", ",", "__", ",", "\"\<_\>\"", ",", "__", ",", 
      "DigitCharacter", ",", "\"\<.dat\>\""}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"scanFiles", "=", 
  RowBox[{"FileNames", "[", 
   RowBox[{"\"\<FDayScan\>\"", "~~", 
    RowBox[{"RegularExpression", "[", "\"\<.{25,25}\>\"", "]"}], "~~", 
    "\"\<Analysis.dat\>\""}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "scanFiles", "]"}]}], "Input",
 CellChangeTimes->{{3.715997051186823*^9, 3.715997071362425*^9}, {
   3.7159971122269754`*^9, 3.715997174834648*^9}, {3.7159973419783387`*^9, 
   3.715997401962781*^9}, {3.715998454947711*^9, 3.715998467161947*^9}, 
   3.7159987635787935`*^9, {3.715999010402203*^9, 3.7159990673856225`*^9}, {
   3.715999183050605*^9, 3.7159991868501663`*^9}, {3.7159993053960905`*^9, 
   3.7159993055712085`*^9}, {3.71600086687239*^9, 3.7160008670004773`*^9}, {
   3.716002939298865*^9, 3.7160029399383*^9}, {3.7177732838501806`*^9, 
   3.717773284053334*^9}, {3.7177734883855925`*^9, 3.717773534562234*^9}, {
   3.717773565645196*^9, 3.717773656572415*^9}, {3.717777783624771*^9, 
   3.7177778957180552`*^9}, {3.717778197176211*^9, 3.717778250191291*^9}, {
   3.7177783653756776`*^9, 3.7177784057760477`*^9}, {3.717778448033537*^9, 
   3.7177785168002024`*^9}, {3.7177785480002384`*^9, 
   3.7177786912241025`*^9}, {3.7177787294411116`*^9, 3.717778748009747*^9}, {
   3.717778800281515*^9, 3.7177788004086018`*^9}, {3.717778904502442*^9, 
   3.717778906001462*^9}, {3.7177789429636154`*^9, 3.717778943641135*^9}, {
   3.7177792380124097`*^9, 3.717779238722911*^9}, {3.7180337493614235`*^9, 
   3.718033770434352*^9}, {3.7180338105468073`*^9, 3.718033813257489*^9}, {
   3.718224688658126*^9, 3.718224696625489*^9}, {3.71822490024232*^9, 
   3.7182249989226894`*^9}, {3.718225048570269*^9, 3.718225091874405*^9}, {
   3.7183571427382803`*^9, 3.718357311441506*^9}, {3.718357347009649*^9, 
   3.718357351850658*^9}, {3.7183578195702944`*^9, 3.718357860195168*^9}, {
   3.718357920324218*^9, 3.718357967363239*^9}, {3.7183581814440804`*^9, 
   3.7183582639397583`*^9}, {3.7183587530922318`*^9, 
   3.7183587634124207`*^9}, {3.718358866564946*^9, 3.7183588766685343`*^9}, {
   3.718359138262288*^9, 3.718359140709233*^9}, {3.718359237589331*^9, 
   3.718359341333583*^9}, {3.7183594193733797`*^9, 3.7183594511491985`*^9}, {
   3.718359512166092*^9, 3.7183596202634225`*^9}, {3.718359660942733*^9, 
   3.7183596703348265`*^9}, {3.7183605008640304`*^9, 
   3.7183605256163654`*^9}, {3.7183605964950185`*^9, 
   3.7183606851912823`*^9}, {3.718360716431503*^9, 3.718360725079917*^9}, {
   3.7183608161601133`*^9, 3.7183608252081547`*^9}, {3.7183611243291483`*^9, 
   3.718361272665377*^9}, {3.718361306065169*^9, 3.718361397898409*^9}, {
   3.718361429970042*^9, 3.718361459753131*^9}, {3.7183618101064496`*^9, 
   3.718361814377358*^9}, {3.718362727772114*^9, 3.718362742787241*^9}, {
   3.7183632559818945`*^9, 3.718363256780793*^9}, {3.718363350948876*^9, 
   3.718363398108738*^9}, {3.7183637044864473`*^9, 3.7183637160294676`*^9}, {
   3.718364856513418*^9, 3.718364857072452*^9}, 3.718364912633376*^9, {
   3.7183651158571925`*^9, 3.718365117872814*^9}, {3.7183651704809422`*^9, 
   3.7183651882651415`*^9}, {3.718365240169391*^9, 3.7183652933211513`*^9}, {
   3.7183658449297247`*^9, 3.7183659101447906`*^9}, {3.7183714119046335`*^9, 
   3.7183714150546684`*^9}, {3.7183718680842576`*^9, 
   3.7183718686040015`*^9}, {3.7183719538284216`*^9, 3.7183720133085017`*^9}, 
   3.718536708468169*^9, {3.7185367873078737`*^9, 3.7185367907850227`*^9}, {
   3.718536848307209*^9, 3.7185368887850327`*^9}, {3.7185369357854404`*^9, 
   3.7185370757860527`*^9}, {3.719173061024761*^9, 3.7191730706958942`*^9}, {
   3.7192374345847445`*^9, 3.7192375113609424`*^9}, {3.7192376152973127`*^9, 
   3.7192376160648217`*^9}, {3.719237695882218*^9, 3.7192377008748665`*^9}, {
   3.7192377588256702`*^9, 3.719237819778061*^9}, {3.7192379041940765`*^9, 
   3.719237991241373*^9}, {3.719238159481947*^9, 3.719238271257752*^9}, {
   3.7192383118352976`*^9, 3.719238362066061*^9}, {3.719238449475089*^9, 
   3.7192384531865654`*^9}, {3.719238553803615*^9, 3.7192385577870083`*^9}, {
   3.7192386604920425`*^9, 3.7192387380751963`*^9}, {3.7227814854789753`*^9, 
   3.722781528537335*^9}, {3.7241263039901896`*^9, 3.724126333076976*^9}, {
   3.7241264812948*^9, 3.7241264880634036`*^9}, {3.7251569771853647`*^9, 
   3.7251569778616943`*^9}, {3.7251572641475763`*^9, 3.725157264636837*^9}, {
   3.725157440074272*^9, 3.725157440206785*^9}, {3.7253609196800203`*^9, 
   3.725360951378677*^9}, {3.725651202890244*^9, 3.72565124620273*^9}, {
   3.7258232682535524`*^9, 3.7258232898307433`*^9}, {3.725823322173271*^9, 
   3.7258233669981117`*^9}, {3.726342521668945*^9, 3.72634254265981*^9}, {
   3.7279769409144735`*^9, 3.727976941850141*^9}, 3.7281395508472433`*^9, {
   3.7304763391702137`*^9, 3.730476355874667*^9}, {3.731082264191852*^9, 
   3.7310822733486867`*^9}, 3.7310827272733507`*^9, {3.732476325906754*^9, 
   3.732476358904326*^9}, {3.7327228852231455`*^9, 3.732722889398269*^9}, {
   3.733409178744459*^9, 3.7334091818227835`*^9}, {3.7371586927125936`*^9, 
   3.7371586970878663`*^9}, 3.7371587484354672`*^9, {3.7377462106662455`*^9, 
   3.7377462120255823`*^9}, {3.737911893114215*^9, 3.737911894879978*^9}, {
   3.737912588945588*^9, 3.737912611446995*^9}, {3.7390192868196297`*^9, 
   3.7390192903354664`*^9}, {3.739019333134925*^9, 
   3.7390193427761335`*^9}},ExpressionUUID->"3c4903f5-9cda-4077-8e71-\
1f494913a4dc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"FDayScan2018-06-26_021432RotationAnalysis.dat\"\>", 
   ",", "\<\"FDayScan2018-06-26_024535RotationAnalysis.dat\"\>", 
   ",", "\<\"FDayScan2018-06-26_031641RotationAnalysis.dat\"\>", 
   ",", "\<\"FDayScan2018-06-26_091908RotationAnalysis.dat\"\>", 
   ",", "\<\"FDayScan2018-06-26_101015RotationAnalysis.dat\"\>", 
   ",", "\<\"FDayScan2018-06-26_121814RotationAnalysis.dat\"\>", 
   ",", "\<\"FDayScan2018-06-26_122725RotationAnalysis.dat\"\>", 
   ",", "\<\"FDayScan2018-06-26_123637RotationAnalysis.dat\"\>", 
   ",", "\<\"FDayScan2018-06-26_143010RotationAnalysis.dat\"\>", 
   ",", "\<\"FDayScan2018-06-26_143920RotationAnalysis.dat\"\>", 
   ",", "\<\"FDayScan2018-06-26_144831RotationAnalysis.dat\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.732722890714614*^9, 3.7327231972527895`*^9, 3.732727329162772*^9, 
   3.7330584183146315`*^9, {3.733409184447954*^9, 3.7334092008865213`*^9}, 
   3.7335704381945715`*^9, 3.733614774566679*^9, 3.733657347295404*^9, 
   3.7336615756579742`*^9, 3.733666548864725*^9, 3.733746202886998*^9, 
   3.7338249657133036`*^9, 3.7340918808492904`*^9, 3.7340926438835983`*^9, 
   3.7371586979785476`*^9, {3.737158742778223*^9, 3.7371587488729954`*^9}, 
   3.7371642595971327`*^9, 3.7377417012854*^9, {3.7377418223590965`*^9, 
   3.7377418353513317`*^9}, 3.7377419253552947`*^9, 3.7377462133758235`*^9, 
   3.7379118955362535`*^9, {3.737912224782189*^9, 3.73791223643917*^9}, 
   3.737912272300783*^9, 3.7379123786355524`*^9, {3.7379124124657907`*^9, 
   3.737912423075842*^9}, {3.7379125790699506`*^9, 3.73791261394713*^9}, {
   3.7390193343693757`*^9, 3.7390193431980333`*^9}, 3.7390438651126785`*^9, 
   3.7390439293816624`*^9},ExpressionUUID->"233a8c78-3394-4b52-92ec-\
47578b6d1406"],

Cell[BoxData["11"], "Output",
 CellChangeTimes->{
  3.732722890714614*^9, 3.7327231972527895`*^9, 3.732727329162772*^9, 
   3.7330584183146315`*^9, {3.733409184447954*^9, 3.7334092008865213`*^9}, 
   3.7335704381945715`*^9, 3.733614774566679*^9, 3.733657347295404*^9, 
   3.7336615756579742`*^9, 3.733666548864725*^9, 3.733746202886998*^9, 
   3.7338249657133036`*^9, 3.7340918808492904`*^9, 3.7340926438835983`*^9, 
   3.7371586979785476`*^9, {3.737158742778223*^9, 3.7371587488729954`*^9}, 
   3.7371642595971327`*^9, 3.7377417012854*^9, {3.7377418223590965`*^9, 
   3.7377418353513317`*^9}, 3.7377419253552947`*^9, 3.7377462133758235`*^9, 
   3.7379118955362535`*^9, {3.737912224782189*^9, 3.73791223643917*^9}, 
   3.737912272300783*^9, 3.7379123786355524`*^9, {3.7379124124657907`*^9, 
   3.737912423075842*^9}, {3.7379125790699506`*^9, 3.73791261394713*^9}, {
   3.7390193343693757`*^9, 3.7390193431980333`*^9}, 3.7390438651126785`*^9, 
   3.7390439293816624`*^9},ExpressionUUID->"bbe98571-2d22-4ce0-9e1f-\
0a423855eecc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["Q"], "Input",
 CellChangeTimes->{
  3.7403450751248097`*^9},ExpressionUUID->"4a4b5116-13d7-47e6-b83a-\
8114304a1f0a"],

Cell[BoxData["1.8000849703699007`*^-7"], "Output",
 CellChangeTimes->{
  3.7403450766453304`*^9},ExpressionUUID->"05f3c627-0788-4fa0-a108-\
b557b1f2f063"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Electron Polarization Functions", "Section",
 CellChangeTimes->{{3.7323693030624037`*^9, 
  3.73236930751869*^9}},ExpressionUUID->"dca3300d-6598-47cb-85f7-\
97292b1c450f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"colorBlindPallete", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"RGBColor", "[", 
      RowBox[{
       RowBox[{"230", "/", "255"}], ",", 
       RowBox[{"159", "/", "255"}], ",", "0"}], "]"}], ",", 
     RowBox[{"RGBColor", "[", 
      RowBox[{
       RowBox[{"86", "/", "255"}], ",", 
       RowBox[{"180", "/", "255"}], ",", 
       RowBox[{"233", "/", "255"}]}], "]"}], ",", 
     RowBox[{"RGBColor", "[", 
      RowBox[{
       RowBox[{"0", "/", "255"}], ",", 
       RowBox[{"158", "/", "255"}], ",", 
       RowBox[{"115", "/", "255"}]}], "]"}], ",", 
     RowBox[{"RGBColor", "[", 
      RowBox[{
       RowBox[{"240", "/", "255"}], ",", 
       RowBox[{"228", "/", "255"}], ",", 
       RowBox[{"66", "/", "255"}]}], "]"}], ",", 
     RowBox[{"RGBColor", "[", 
      RowBox[{
       RowBox[{"0", "/", "255"}], ",", 
       RowBox[{"114", "/", "255"}], ",", 
       RowBox[{"178", "/", "255"}]}], "]"}], ",", 
     RowBox[{"RGBColor", "[", 
      RowBox[{
       RowBox[{"213", "/", "255"}], ",", 
       RowBox[{"94", "/", "255"}], ",", 
       RowBox[{"0", "/", "255"}]}], "]"}], ",", 
     RowBox[{"RGBColor", "[", 
      RowBox[{
       RowBox[{"204", "/", "255"}], ",", 
       RowBox[{"121", "/", "255"}], ",", 
       RowBox[{"167", "/", "255"}]}], "]"}], ",", 
     RowBox[{"RGBColor", "[", 
      RowBox[{
       RowBox[{"0", "/", "255"}], ",", 
       RowBox[{"0", "/", "255"}], ",", 
       RowBox[{"0", "/", "255"}]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"Plot", ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"FontSize", "\[Rule]", "24"}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
    RowBox[{"LabelStyle", "\[Rule]", "27"}], ",", 
    RowBox[{"GridLines", "\[Rule]", "Automatic"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ListPlot", ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"FontSize", "\[Rule]", "24"}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
    RowBox[{"LabelStyle", "\[Rule]", "27"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"960", ",", "600"}], "}"}]}], ",", 
    RowBox[{"GridLines", "\[Rule]", "Automatic"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ListLogPlot", ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"FontSize", "\[Rule]", "24"}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
    RowBox[{"LabelStyle", "\[Rule]", "27"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"960", ",", "600"}], "}"}]}], ",", 
    RowBox[{"GridLines", "\[Rule]", "Automatic"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"BarChart", ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontSize", "\[Rule]", "18"}], ",", 
       RowBox[{"PointSize", "[", "Large", "]"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
    RowBox[{"GridLines", "\[Rule]", "Automatic"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stokesNames", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<p0\>\"", ",", "\"\<p1\>\"", ",", "\"\<p2\>\"", ",", "\"\<p3_mag\>\"",
      ",", "\"\<p3_c2\>\"", ",", "\"\<p3_s2\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stokesErrNames", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<p0err\>\"", ",", "\"\<p1err\>\"", ",", "\"\<p2err\>\"", ",", 
     "\"\<p3_magerr\>\"", ",", "\"\<p3_c2err\>\"", ",", "\"\<p3_s2err\>\""}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nA", "=", "1*^-9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mTorr", "=", "1*^-3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"alpha", "=", 
   RowBox[{"20.4", "*", 
    RowBox[{"\[Pi]", "/", "180"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beta", "=", 
   RowBox[{"68.7", "*", 
    RowBox[{"\[Pi]", "/", "180"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deltaAB", "=", 
   RowBox[{"alpha", "-", "beta"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"delta", "=", 
    RowBox[{"94.54", "*", 
     RowBox[{"\[Pi]", "/", "180"}]}]}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Munir", "'"}], "s", " ", "reported", " ", "1.66", " ", "plus", 
     " ", "or", " ", "minus", " ", ".01"}], "*)"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Physical", " ", "constants"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"c", "=", "2.99792458*^10"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"cm", "/", "s"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"re", "=", "2.8179*^-13"}], ";"}], " ", 
  RowBox[{"(*", " ", "cm", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cellLength", "=", "2.794"}], ";"}], 
  RowBox[{"(*", " ", "cm", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fge", "=", "0.34231"}], ";"}], " ", 
  RowBox[{"(*", " ", "dimensionless", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"k", "=", 
    RowBox[{"4", "/", "3"}]}], ";"}], " ", 
  RowBox[{"(*", " ", "dimensionless", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BdotL", ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"G", "*", "cm"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Mu]", "=", "9.2740*^-21"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"g", "*", 
    RowBox[{"cm", "^", "2"}], "*", 
    RowBox[{"s", "^", 
     RowBox[{"-", "2"}]}], "*", 
    RowBox[{"G", "^", 
     RowBox[{"-", "1"}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"h", "=", "6.6261*^-27"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"g", "*", 
    RowBox[{"cm", "^", "2"}], "*", 
    RowBox[{"s", "^", 
     RowBox[{"-", "1"}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Nu]0", "=", "377107.463*^9"}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"s", "^", 
    RowBox[{"-", "1"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]0", "=", 
    RowBox[{"c", "/", "\[Nu]0"}]}], ";"}], " ", 
  RowBox[{"(*", " ", "cm", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gHzToHz", "=", "1*^9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q", "=", 
   FractionBox[
    RowBox[{"re", " ", "fge", " ", "k", " ", "\[Mu]", " "}], "h"]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nDensC", "=", 
    RowBox[{"2", "*", 
     RowBox[{"h", "/", 
      RowBox[{"(", 
       RowBox[{"c", "*", "re", "*", "fge", "*", "k", "*", "\[Mu]"}], ")"}]}], 
     "*", 
     SuperscriptBox["10", "18"]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"cm", "^", "2"}], "*", "g", "*", 
    RowBox[{"s", "^", 
     RowBox[{"-", "1"}]}], "  ", "*", "  ", 
    RowBox[{"G", "^", 
     RowBox[{"-", "1"}]}], "*", 
    RowBox[{"cm", "^", 
     RowBox[{"-", "1"}]}], "  ", "*", "  ", 
    RowBox[{"cm", "^", 
     RowBox[{"-", "1"}]}], "*", "s", "  ", "*", "  ", 
    RowBox[{"cm", "^", 
     RowBox[{"-", "1"}]}], "  ", "*", "  ", 
    RowBox[{"g", "^", 
     RowBox[{"-", "1"}]}], "*", 
    RowBox[{"cm", "^", 
     RowBox[{"-", "2"}]}], "*", 
    RowBox[{"s", "^", "2"}], "*", "G"}], "  ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Conversion", " ", 
     RowBox[{"Factor", ".", " ", "is"}], " ", "in", " ", 
     RowBox[{"1", "/", 
      RowBox[{
       RowBox[{"(", "Hz", ")"}], "^", "2"}]}]}], ",", " ", 
    RowBox[{"so", " ", "we", " ", "need", " ", "*", 
     RowBox[{"10", "^", "18"}], " ", "to", " ", "convert", " ", "to", " ", 
     RowBox[{"1", "/", 
      RowBox[{
       RowBox[{"(", "GHz", ")"}], "^", "2"}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"alphaOld", "=", 
   RowBox[{"3.2", "*", 
    RowBox[{"\[Pi]", "/", "180"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"betaOld", "=", 
   RowBox[{
    RowBox[{"-", "6.95"}], "*", 
    RowBox[{"\[Pi]", "/", "180"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rev", "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", "\"\<ErrorBarPlots`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GenerateListOfFileNames", "[", 
     RowBox[{"prefix_", ",", "date_", ",", "runtimes_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"j", ",", "fileNames"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fileNames", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", 
          RowBox[{"Length", "[", "runtimes", "]"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"fileNames", ",", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"prefix", ",", "date", ",", "\"\<_\>\"", ",", 
             RowBox[{"ToString", "[", 
              RowBox[{"runtimes", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "]"}], ",", "\"\<.dat\>\""}], 
            "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "fileNames"}]}], "\[IndentingNewLine]", "]"}]}],
    ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "If", " ", "given", " ", "a", " ", "list", " ", "of", " ", "files"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetIndexOfFilenameFromTimestamp", "[", 
    RowBox[{"files_", ",", "timestamp_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "index"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "files", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", " ", 
           RowBox[{
            RowBox[{"files", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "timestamp"}], "]"}], ",", 
          RowBox[{"index", "=", "i"}]}], "]"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "index"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetFileHeaderInfo", "[", "dataFileName_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rawFile", ",", "data", ",", "association", ",", "k", ",", "rawImport", 
       ",", "removedNulls", ",", "joinedWithSpaces"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rawFile", "=", 
       RowBox[{"Import", "[", "dataFileName", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"data", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"association", "=", 
       RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"k", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringPart", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"rawFile", "[", 
             RowBox[{"[", "k", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "\[Equal]", 
         "\"\<#\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"rawFile", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "]"}], ">", " ", "2"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rawImport", "=", 
             RowBox[{"Take", "[", 
              RowBox[{
               RowBox[{"rawFile", "[", 
                RowBox[{"[", "k", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", 
                 RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"removedNulls", "=", 
             RowBox[{"DeleteCases", "[", 
              RowBox[{"rawImport", ",", "Null"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"joinedWithSpaces", "=", 
             RowBox[{"StringRiffle", "[", "removedNulls", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"association", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"association", ",", 
               RowBox[{
                RowBox[{"StringReplace", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"rawFile", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\"\<#\>\"", "\[Rule]", " ", "\"\<\>\""}], ",", 
                    RowBox[{"\"\<:\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], 
                 "]"}], "\[Rule]", "joinedWithSpaces"}]}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"association", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"association", ",", 
               RowBox[{
                RowBox[{"StringReplace", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"rawFile", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\"\<#\>\"", "\[Rule]", "\"\<\>\""}], ",", 
                    RowBox[{"\"\<:\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], 
                 "]"}], "\[Rule]", 
                RowBox[{
                 RowBox[{"rawFile", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"k", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "association"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetFileDataset", "[", "dataFileName_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rawFile", ",", "headerStrippedData", ",", "columnHeaderLineNumber", 
       ",", "lastColumnToImport", ",", "j", ",", "k", ",", "ass", ",", 
       "tabularData", ",", "ds", ",", "rbAbsorptionRef", ",", 
       "rbAbsorptionPro"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rawFile", "=", 
       RowBox[{"Import", "[", "dataFileName", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"k", "=", "1"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringPart", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"rawFile", "[", 
             RowBox[{"[", "k", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "\[Equal]", 
         "\"\<#\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"k", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"headerStrippedData", "=", 
       RowBox[{"Take", "[", 
        RowBox[{"rawFile", ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{"-", "1"}]}], "}"}], ",", "All"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tabularData", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "2"}], ",", 
        RowBox[{"j", "\[LessEqual]", 
         RowBox[{"Length", "[", "headerStrippedData", "]"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"headerStrippedData", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}], ">", "1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ass", "=", 
            RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"k", "=", "1"}], ",", 
             RowBox[{"k", "\[LessEqual]", 
              RowBox[{"Length", "[", 
               RowBox[{"headerStrippedData", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ass", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"ass", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"headerStrippedData", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "k", "]"}], "]"}], "\[Rule]", 
                  RowBox[{
                   RowBox[{"headerStrippedData", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                   RowBox[{"[", "k", "]"}], "]"}]}]}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"tabularData", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"tabularData", ",", "ass"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ds", " ", "=", 
       RowBox[{"Dataset", "[", "tabularData", "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ImportFile", "[", "dataFileName_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"GetFileHeaderInfo", "[", "dataFileName", "]"}], ",", 
    RowBox[{"GetFileDataset", "[", "dataFileName", "]"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"GetFileDataset", ",", "Listable"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"GetFileHeaderInfo", ",", "Listable"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"ImportFile", ",", "Listable"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FourierFit", "[", 
     RowBox[{"list_", ",", "rev_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "fit", ",", "function", ",", "dataPts", ",", "stepSize", ",", 
        "dataPtsPerRev", ",", "angles", ",", "data"}], 
       RowBox[{"(*", 
        RowBox[{",", "C0", ",", "C2", ",", "C4", ",", "S2", ",", "S4"}], 
        "*)"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"function", "[", "\[Theta]_", "]"}], "=", " ", 
        RowBox[{"C0", "+", 
         RowBox[{"C2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", 
            RowBox[{"(", 
             RowBox[{"\[Theta]", "+", "\[Theta]o"}], ")"}]}], "]"}]}], "+", 
         RowBox[{"C4", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"4", 
            RowBox[{"(", 
             RowBox[{"\[Theta]", "+", "\[Theta]o"}], ")"}]}], "]"}]}], "+", 
         RowBox[{"S2", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", 
            RowBox[{"(", 
             RowBox[{"\[Theta]", "+", "\[Theta]o"}], ")"}]}], "]"}]}], "+", 
         RowBox[{"S4", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"4", 
            RowBox[{"(", 
             RowBox[{"\[Theta]", "+", "\[Theta]o"}], ")"}]}], "]"}]}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"dataPts", "=", 
        RowBox[{"Length", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dataPtsPerRev", "=", 
        RowBox[{"dataPts", "/", "rev"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"angles", "=", 
        RowBox[{"Range", "[", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", "\[Pi]", "*", "rev"}], ")"}], "-", 
           RowBox[{"2", 
            RowBox[{"\[Pi]", "/", "dataPtsPerRev"}]}]}], ",", 
          RowBox[{"2", 
           RowBox[{"\[Pi]", "/", "dataPtsPerRev"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"data", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"list", ",", "angles"}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fit", "=", 
        RowBox[{"NonlinearModelFit", "[", 
         RowBox[{"data", ",", 
          RowBox[{"function", "[", "\[Theta]", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"C0", ",", "1000"}], "}"}], ",", "C2", ",", "C4", ",", 
            "S2", ",", "S4", ",", "\[Theta]o"}], "}"}], ",", "\[Theta]"}], 
         "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DFT", "[", 
    RowBox[{"list_", ",", 
     RowBox[{"rev_:", "1"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "numItems", ",", "i", ",", "k", ",", "j", ",", "reconstructionCos", ",",
        "reconstructionSin", ",", "returnCos", ",", "errorsCos", ",", 
       "returnSin", ",", "errorsSin", ",", "intensity"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"returnCos", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"errorsCos", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"returnSin", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"errorsSin", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reconstructionCos", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reconstructionSin", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"numItems", "=", 
       RowBox[{"Length", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "0"}], ",", 
        RowBox[{"j", "<", 
         RowBox[{"numItems", "/", "2"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"returnCos", ",", "0"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"returnSin", ",", "0"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<=", "numItems"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"intensity", "=", 
          RowBox[{"list", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", " ", "[", 
          RowBox[{
           RowBox[{"k", "=", "0"}], ",", 
           RowBox[{"k", "<", 
            RowBox[{"numItems", "/", "2"}]}], ",", 
           RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"k", "\[Equal]", "0"}], " ", "||", 
               RowBox[{"k", "\[Equal]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"numItems", "/", "2"}], "-", "1"}], ")"}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"returnCos", "[", 
                 RowBox[{"[", 
                  RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", 
                RowBox[{"N", "[", 
                 RowBox[{
                  RowBox[{"returnCos", "[", 
                   RowBox[{"[", 
                    RowBox[{"k", "+", "1"}], "]"}], "]"}], "+", 
                  RowBox[{
                   FractionBox["1", "numItems"], "*", "intensity", "*", 
                   RowBox[{"Cos", "[", 
                    RowBox[{
                    "2", "*", "\[Pi]", " ", "*", "k", " ", "*", "rev", "*", 
                    " ", 
                    FractionBox[
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "numItems"]}], "]"}]}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"returnSin", "[", 
                 RowBox[{"[", 
                  RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", 
                RowBox[{"N", "[", 
                 RowBox[{
                  RowBox[{"returnSin", "[", 
                   RowBox[{"[", 
                    RowBox[{"k", "+", "1"}], "]"}], "]"}], "+", 
                  RowBox[{
                   FractionBox["1", "numItems"], "*", "intensity", "*", 
                   RowBox[{"Sin", "[", 
                    RowBox[{
                    "2", "*", "\[Pi]", " ", "*", "k", " ", "*", "rev", "*", 
                    " ", 
                    FractionBox[
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "numItems"]}], "]"}]}]}], 
                 "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"returnCos", "[", 
                 RowBox[{"[", 
                  RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", 
                RowBox[{"N", "[", 
                 RowBox[{
                  RowBox[{"returnCos", "[", 
                   RowBox[{"[", 
                    RowBox[{"k", "+", "1"}], "]"}], "]"}], "+", 
                  RowBox[{
                   FractionBox["2", "numItems"], "*", "intensity", "*", 
                   RowBox[{"Cos", "[", 
                    RowBox[{
                    "2", "*", "\[Pi]", " ", "*", "k", "*", " ", "rev", " ", 
                    "*", 
                    FractionBox[
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "numItems"]}], "]"}]}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"returnSin", "[", 
                 RowBox[{"[", 
                  RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", 
                RowBox[{"N", "[", 
                 RowBox[{
                  RowBox[{"returnSin", "[", 
                   RowBox[{"[", 
                    RowBox[{"k", "+", "1"}], "]"}], "]"}], "+", 
                  RowBox[{
                   FractionBox["2", "numItems"], "*", "intensity", "*", 
                   RowBox[{"Sin", "[", 
                    RowBox[{
                    "2", "*", "\[Pi]", " ", "*", "k", "*", " ", "rev", " ", 
                    "*", 
                    FractionBox[
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "numItems"]}], "]"}]}]}], 
                 "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"(*", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "0"}], ",", 
          RowBox[{"j", "<", 
           RowBox[{"numItems", "/", "2"}]}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"errorsSin", ",", "0"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"errorsCos", ",", "0"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", "1"}], ",", 
             RowBox[{"i", "<=", "numItems"}], ",", 
             RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"intensity", "=", 
               RowBox[{"list", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"reconstructionCos", ",", "0"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"reconstructionSin", ",", "0"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"reconstructionCos", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "=", 
               RowBox[{"intensity", "/", 
                RowBox[{"Cos", "[", 
                 RowBox[{"2", "*", "\[Pi]", "*", "j", "*", "rev", "*", 
                  FractionBox[
                   RowBox[{"(", "i", ")"}], "numItems"]}], "]"}]}]}], " ", 
              ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"j", "\[Equal]", "0"}], ",", 
                RowBox[{
                 RowBox[{"reconstructionSin", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "=", "0"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"reconstructionSin", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "=", 
                  RowBox[{"intensity", "/", 
                   RowBox[{"Sin", "[", 
                    RowBox[{
                    "2", "*", "\[Pi]", "*", "1.0001", "*", "j", "*", "rev", 
                    "*", 
                    FractionBox[
                    RowBox[{"(", "i", ")"}], "numItems"]}], "]"}]}]}], 
                 ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", " ", "[", 
               RowBox[{
                RowBox[{"k", "=", "0"}], ",", 
                RowBox[{"k", "<", 
                 RowBox[{"numItems", "/", "2"}]}], ",", 
                RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"k", "\[NotEqual]", "j"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"reconstructionCos", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "-=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"returnCos", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", "*", "\[Pi]", "*", "k", "*", "rev", "*", 
                    FractionBox[
                    RowBox[{"(", "i", ")"}], "numItems"]}], "]"}]}], " ", "+", 
                    RowBox[{
                    RowBox[{"returnSin", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"2", "*", "\[Pi]", "*", "k", "*", "rev", "*", 
                    FractionBox[
                    RowBox[{"(", "i", ")"}], "numItems"]}], "]"}]}]}], " ", 
                    ")"}], "/", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", "*", "\[Pi]", "*", "j", "*", "rev", "*", 
                    FractionBox[
                    RowBox[{"(", "i", ")"}], "numItems"]}], "]"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "\[Equal]", "0"}], ",", 
                    RowBox[{
                    RowBox[{"reconstructionSin", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "=", "0"}], ",", 
                    RowBox[{
                    RowBox[{"reconstructionSin", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "-=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"returnCos", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", "*", "\[Pi]", "*", "k", "*", "rev", "*", 
                    FractionBox[
                    RowBox[{"(", "i", ")"}], "numItems"]}], "]"}]}], " ", "+", 
                    RowBox[{
                    RowBox[{"returnSin", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"2", "*", "\[Pi]", "*", "k", "*", "rev", "*", 
                    FractionBox[
                    RowBox[{"(", "1", ")"}], "numItems"]}], "]"}]}]}], " ", 
                    ")"}], "/", 
                    RowBox[{"Sin", "[", 
                    RowBox[{
                    "2", "*", "\[Pi]", "*", "1.0001", "*", "j", "*", "rev", 
                    "*", 
                    FractionBox[
                    RowBox[{"(", "i", ")"}], "numItems"]}], "]"}]}]}]}], 
                    "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"errorsSin", "[", 
                RowBox[{"[", 
                 RowBox[{"j", "+", "1"}], "]"}], "]"}], "+=", 
               RowBox[{"Power", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"reconstructionSin", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "-", 
                  RowBox[{"returnSin", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}]}], ",", "2"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"errorsCos", "[", 
                RowBox[{"[", 
                 RowBox[{"j", "+", "1"}], "]"}], "]"}], "+=", 
               RowBox[{"Power", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"reconstructionCos", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "-", 
                  RowBox[{"returnCos", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}]}], ",", "2"}], 
                "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"errorsSin", "[", 
             RowBox[{"[", 
              RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
            RowBox[{"Sqrt", "[", 
             RowBox[{
              RowBox[{"errorsSin", "[", 
               RowBox[{"[", 
                RowBox[{"j", "+", "1"}], "]"}], "]"}], "/", "numItems"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"errorsCos", "[", 
             RowBox[{"[", 
              RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
            RowBox[{"Sqrt", "[", 
             RowBox[{
              RowBox[{"errorsCos", "[", 
               RowBox[{"[", 
                RowBox[{"j", "+", "1"}], "]"}], "]"}], "/", "numItems"}], 
             "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
       "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"returnSin", ",", "errorsSin"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"returnCos", ",", "errorsCos"}], "}"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StokesParametersFromFourierCoefficients", "[", 
     RowBox[{"fc_", 
      RowBox[{"(*", 
       RowBox[{"Fourrier", " ", "Coefficients"}], "*)"}], ",", 
      RowBox[{"rev_:", "rev"}], ",", 
      RowBox[{"alpha_:", "alpha"}], ",", 
      RowBox[{"beta0_:", "beta"}], ",", 
      RowBox[{"delta_:", "delta"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "c0", ",", "c2", ",", "c4", ",", "s2", ",", "s4", ",", "stokes"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"stokes", "=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"c0", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"fc", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"c2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"fc", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"c4", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"fc", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"fc", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s4", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"fc", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"stokes", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{"c0", "-", 
         RowBox[{
          FractionBox[
           RowBox[{"1", "+", 
            RowBox[{"Cos", "[", "delta", "]"}]}], 
           RowBox[{"1", "-", 
            RowBox[{"Cos", "[", "delta", "]"}]}]], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c4", "*", 
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{"4", " ", "alpha"}], "+", 
               RowBox[{"4", " ", "beta0"}]}], "]"}]}], "+", 
            RowBox[{"s4", "*", 
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"4", " ", "alpha"}], "+", 
               RowBox[{"4", " ", "beta0"}]}], "]"}]}]}], ")"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"stokes", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "=", 
        RowBox[{
         FractionBox["2", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"Cos", "[", "delta", "]"}]}], ")"}]], "*", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c4", "*", 
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{"2", "alpha"}], " ", "+", " ", 
               RowBox[{"4", " ", "beta0"}]}], "]"}]}], "+", 
            RowBox[{"s4", "*", 
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"2", "alpha"}], " ", "+", " ", 
               RowBox[{"4", " ", "beta0"}]}], "]"}]}]}], ")"}], 
          RowBox[{"stokes", "[", 
           RowBox[{"[", "1", "]"}], "]"}]]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"stokes", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "=", 
        RowBox[{
         FractionBox["2", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"Cos", "[", "delta", "]"}]}], ")"}]], "*", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"s4", "*", 
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{"2", "alpha"}], " ", "+", " ", 
               RowBox[{"4", " ", "beta0"}]}], "]"}]}], "-", 
            RowBox[{"c4", "*", 
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"2", "alpha"}], " ", "+", " ", 
               RowBox[{"4", " ", "beta0"}]}], "]"}]}]}], ")"}], 
          RowBox[{"stokes", "[", 
           RowBox[{"[", "1", "]"}], "]"}]]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"stokes", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "=", 
        FractionBox[
         RowBox[{"Sqrt", "[", 
          RowBox[{
           SuperscriptBox["c2", "2"], "+", 
           SuperscriptBox["s2", "2"]}], "]"}], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Sin", "[", "delta", "]"}], "2"], 
          RowBox[{"stokes", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"stokes", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "=", 
        FractionBox["c2", 
         RowBox[{
          RowBox[{"Sin", "[", "delta", "]"}], 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"2", " ", "alpha"}], " ", "+", " ", 
            RowBox[{"2", " ", "beta0"}]}], "]"}], 
          RowBox[{"stokes", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"stokes", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "=", 
        FractionBox[
         RowBox[{"-", "s2"}], 
         RowBox[{
          RowBox[{"Sin", "[", "delta", "]"}], 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"2", " ", "alpha"}], " ", "+", " ", 
            RowBox[{"2", "beta0"}]}], "]"}], 
          RowBox[{"stokes", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]]}], ";", "\[IndentingNewLine]", 
       "stokes"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Someday", " ", "when", " ", 
     RowBox[{"I", "'"}], "m", " ", "bored"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "I", " ", "can", " ", "try", " ", "to", " ", "implement", " ", "the", 
       " ", "asoociation", " ", "version", " ", "of", " ", "the", " ", 
       "stokes", " ", 
       RowBox[{"vectors", ".", " ", "Today"}], " ", "is", " ", "not", " ", 
       "that", " ", "day", "\[IndentingNewLine]", 
       RowBox[{"StokesParametersFromFourierCoefficients", "[", 
        RowBox[{"fc_", 
         RowBox[{"(*", 
          RowBox[{"Fourrier", " ", "Coefficients"}], "*)"}], ",", 
         RowBox[{"rev_:", "rev"}], ",", 
         RowBox[{"alpha_:", "alpha"}], ",", 
         RowBox[{"beta0_:", "beta"}], ",", 
         RowBox[{"delta_:", "delta"}]}], "]"}]}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "c0", ",", "c2", ",", "c4", ",", "s2", ",", "s4", ",", "stokes"}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"stokes", "=", 
          RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"c0", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"fc", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"c2", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"fc", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"c4", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"fc", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"s2", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"fc", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"s4", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"fc", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"stokes", ",", 
           RowBox[{
            RowBox[{"stokesNames", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "->", 
            RowBox[{"c0", "-", 
             RowBox[{
              FractionBox[
               RowBox[{"1", "+", 
                RowBox[{"Cos", "[", "delta", "]"}]}], 
               RowBox[{"1", "-", 
                RowBox[{"Cos", "[", "delta", "]"}]}]], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"c4", "*", 
                 RowBox[{"Cos", "[", 
                  RowBox[{
                   RowBox[{"4", " ", "alpha"}], "+", 
                   RowBox[{"4", " ", "beta0"}]}], "]"}]}], "+", 
                RowBox[{"s4", "*", 
                 RowBox[{"Sin", "[", 
                  RowBox[{
                   RowBox[{"4", " ", "alpha"}], "+", 
                   RowBox[{"4", " ", "beta0"}]}], "]"}]}]}], ")"}]}]}]}]}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"stokes", ",", 
           RowBox[{
            RowBox[{"stokesNames", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "->", 
            RowBox[{
             FractionBox["2", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"Cos", "[", "delta", "]"}]}], ")"}]], "*", 
             FractionBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"c4", "*", 
                 RowBox[{"Cos", "[", 
                  RowBox[{
                   RowBox[{"2", "alpha"}], " ", "+", " ", 
                   RowBox[{"4", " ", "beta0"}]}], "]"}]}], "+", 
                RowBox[{"s4", "*", 
                 RowBox[{"Sin", "[", 
                  RowBox[{
                   RowBox[{"2", "alpha"}], " ", "+", " ", 
                   RowBox[{"4", " ", "beta0"}]}], "]"}]}]}], ")"}], 
              RowBox[{"stokes", "[", 
               RowBox[{"[", "1", "]"}], "]"}]]}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"stokes", ",", 
           RowBox[{
            RowBox[{"stokesNames", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "->", 
            RowBox[{
             FractionBox["2", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"Cos", "[", "delta", "]"}]}], ")"}]], "*", 
             FractionBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"s4", "*", 
                 RowBox[{"Cos", "[", 
                  RowBox[{
                   RowBox[{"2", "alpha"}], " ", "+", " ", 
                   RowBox[{"4", " ", "beta0"}]}], "]"}]}], "-", 
                RowBox[{"c4", "*", 
                 RowBox[{"Sin", "[", 
                  RowBox[{
                   RowBox[{"2", "alpha"}], " ", "+", " ", 
                   RowBox[{"4", " ", "beta0"}]}], "]"}]}]}], ")"}], 
              RowBox[{"stokes", "[", 
               RowBox[{"[", "1", "]"}], "]"}]]}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"stokes", ",", 
           RowBox[{
            RowBox[{"stokesNames", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "->", 
            FractionBox[
             RowBox[{"Sqrt", "[", 
              RowBox[{
               SuperscriptBox["c2", "2"], "+", 
               SuperscriptBox["s2", "2"]}], "]"}], 
             RowBox[{
              SuperscriptBox[
               RowBox[{"Sin", "[", "delta", "]"}], "2"], 
              RowBox[{"stokes", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"stokes", ",", 
           RowBox[{
            RowBox[{"stokesNames", "[", 
             RowBox[{"[", "5", "]"}], "]"}], "->", 
            FractionBox["c2", 
             RowBox[{
              RowBox[{"Sin", "[", "delta", "]"}], 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"2", " ", "alpha"}], " ", "+", " ", 
                RowBox[{"2", " ", "beta0"}]}], "]"}], 
              RowBox[{"stokes", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"stokes", ",", 
           RowBox[{
            RowBox[{"stokesNames", "[", 
             RowBox[{"[", "6", "]"}], "]"}], "->", 
            FractionBox[
             RowBox[{"-", "s2"}], 
             RowBox[{
              RowBox[{"Sin", "[", "delta", "]"}], 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"2", " ", "alpha"}], " ", "+", " ", 
                RowBox[{"2", "beta0"}]}], "]"}], 
              RowBox[{"stokes", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]]}]}], "]"}], ";", 
         "\[IndentingNewLine]", "stokes"}]}], "\[IndentingNewLine]", "]"}]}], 
     ";"}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StokesParametersFromRawFourierData", "[", 
     RowBox[{"intensityArray_", ",", 
      RowBox[{"rev_:", "rev"}], ",", 
      RowBox[{"alpha_:", "alpha"}], ",", 
      RowBox[{"beta0_:", "beta"}], ",", 
      RowBox[{"delta_:", "delta"}]}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"fc", 
        RowBox[{"(*", 
         RowBox[{"Fourrier", " ", "Coefficients"}], "*)"}], ",", "c0", ",", 
        "c2", ",", "c4", ",", "s2", ",", "s4", ",", "stokes"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fc", "=", 
        RowBox[{"DFT", "[", 
         RowBox[{"intensityArray", ",", "rev"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"StokesParametersFromFourierCoefficients", "[", 
        RowBox[{"fc", ",", "rev", ",", "alpha", ",", "beta0", ",", "delta"}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StokesParametersFromPolFile", "[", 
     RowBox[{
     "polFile_", ",", "alpha_", ",", "beta0_", ",", "delta_", ",", "rev_"}], 
     "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"intensityArray", ",", "f"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"intensityArray", "=", 
        RowBox[{"Normal", "[", 
         RowBox[{
          RowBox[{"polFile", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"All", ",", "\"\<COUNT\>\""}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"StokesParametersFromRawFourierData", "[", 
        RowBox[{
        "intensityArray", ",", "rev", ",", "alpha", ",", "beta0", ",", 
         "delta"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StokesParametersFromPolFileName", "[", 
     RowBox[{"polFileName_", ",", "alpha_", ",", "beta0_", ",", "delta_"}], 
     "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"intensityArray", ",", "f", ",", "rev"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"f", "=", 
        RowBox[{"ImportFile", "[", "polFileName", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"intensityArray", "=", 
        RowBox[{"Normal", "[", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"All", ",", "\"\<COUNT\>\""}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rev", "=", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<REV\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"StokesParametersFromPolFile", "[", 
        RowBox[{"f", ",", "alpha", ",", "beta0", ",", "delta", ",", "rev_"}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetLinearPolarizationFraction", "[", "fileName_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "data", ",", "angle", ",", "intensityArray", ",", "angleRAD", ",", "fc",
        ",", "intensity", ",", "linearPolarization", ",", 
       "linearPolarizationFraction"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"GetFileDataset", "[", "fileName", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"intensityArray", "=", 
       RowBox[{
        RowBox[{"Transpose", "[", "data", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fc", "=", 
       RowBox[{"DFT", "[", 
        RowBox[{"intensityArray", ",", "1"}], "]"}]}], " ", 
      RowBox[{"(*", 
       RowBox[{"fc", "=", 
        RowBox[{"fourier", " ", "coefficients"}]}], "*)"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"intensity", "=", 
       RowBox[{
        RowBox[{"fc", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"linearPolarization", "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{
           RowBox[{"fc", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{
           RowBox[{"fc", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], "2"]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"linearPolarizationFraction", "=", 
       RowBox[{"linearPolarization", "/", "intensity"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"GetLinearPolarizationFraction", ",", "Listable"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetAngle", "[", "fileName_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "data", ",", "intensityArray", ",", "angleRAD", ",", "fc", ",", 
       "intensity", ",", "linearPolarization", ",", 
       "linearPolarizationFraction"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"GetFileDataset", "[", "fileName", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"intensityArray", "=", 
       RowBox[{
        RowBox[{"Transpose", "[", "data", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fc", "=", 
       RowBox[{"DFT", "[", 
        RowBox[{"intensityArray", ",", "1"}], "]"}]}], " ", 
      RowBox[{"(*", 
       RowBox[{"fc", "=", 
        RowBox[{"fourier", " ", "coefficients"}]}], "*)"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{".5", "*", 
       RowBox[{"ArcTan", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"fc", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"fc", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"GetAngle", ",", "Listable"}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetAverageCountRateFromFileNames", "[", "fileNames_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "files", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"files", "=", 
        RowBox[{"ImportFile", "[", "fileNames", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"GetAverageCountRateFromFiles", "[", "files", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"See", " ", "Nate", " ", 
    RowBox[{"Clayburn", "'"}], "s", " ", "explanation", " ", "on", " ", 
    "Background", " ", "Subtraction", " ", 
    RowBox[{"p", ".", " ", "129"}], " ", 
    RowBox[{"eq", ".", " ", "93"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Returns", " ", "a", " ", "list", " ", "of", " ", "two", " ", 
    RowBox[{"items", ".", "\[IndentingNewLine]", "\t", "the"}], " ", "first", 
    " ", "item", " ", "is", " ", "a", " ", "list", " ", "of", " ", "the", " ",
     "intensity", " ", "reaching", " ", "the", " ", "PMT", " ", "at", " ", 
    "each", " ", "step", " ", "of", " ", "the", " ", 
    RowBox[{"polarimeter", ".", "\[IndentingNewLine]", "\t", "the"}], " ", 
    "second", " ", "item", " ", "is", " ", "the", " ", "standard", " ", 
    "deviation", " ", "of", " ", "these", " ", "counts"}], 
   "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetAverageCountRateFromFiles", "[", "files_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "i", ",", "sum", ",", "counts", ",", "dwell", ",", "current", ",", 
        "nCycles", ",", "errorSum", ",", " ", "error", ",", "nDataPts", ",", 
        "j"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nDataPts", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"Normal", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"files", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"All", ",", "\"\<COUNT\>\""}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sum", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"errorSum", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", " ", "nDataPts"}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"sum", "=", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"sum", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"errorSum", "=", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"errorSum", ",", "0"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "files", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"counts", "=", 
           RowBox[{"Normal", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"files", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"All", ",", "\"\<COUNT\>\""}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"current", "=", 
           RowBox[{"Normal", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"files", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"All", ",", "\"\<CURRENT\>\""}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"dwell", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"files", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<DWELL(s)\>\"", "]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"nCycles", "=", 
           RowBox[{"Length", "[", "files", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "\[LessEqual]", "nDataPts"}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"sum", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "+=", 
              RowBox[{
               RowBox[{
                RowBox[{"counts", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "/", "nCycles"}], "/", 
               "dwell"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"errorSum", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "+=", 
              RowBox[{
               RowBox[{"counts", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["nCycles", "2"], "*", 
                 SuperscriptBox["dwell", "2"]}], ")"}]}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", " ", "nDataPts"}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"errorSum", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "=", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"errorSum", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"sum", ",", "errorSum"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
    "GetCurrentNormalizedAverageCountRateFromFiles", "[", "files_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "t", ",", "scale", ",", "darkCountsRate", ",", "i", ",", "sum", ",", 
        "counts", ",", "dwell", ",", "current", ",", "nCycles", ",", 
        "errorSum", ",", " ", "error", ",", "nDataPts", ",", "j", ",", 
        "rev"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nDataPts", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"files", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<DATAPPR\>\"", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"rev", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"files", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<REV\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"scale", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"files", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<SCALE\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"darkCountsRate", "=", "10"}], ";", "\[IndentingNewLine]", 
       RowBox[{"sum", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"errorSum", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", " ", "nDataPts"}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"sum", "=", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"sum", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"errorSum", "=", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"errorSum", ",", "0"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "files", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"counts", "=", 
           RowBox[{"Normal", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"files", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"All", ",", "\"\<COUNT\>\""}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"current", "=", 
           RowBox[{"Normal", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"files", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"All", ",", "\"\<CURRENT\>\""}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"dwell", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"files", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<DWELL(s)\>\"", "]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"nCycles", "=", 
           RowBox[{
            RowBox[{"Length", "[", "files", "]"}], "*", "rev"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"t", "=", 
           RowBox[{"dwell", "*", "nCycles"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "\[LessEqual]", "nDataPts"}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"sum", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "+=", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"counts", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "-", 
                  RowBox[{"darkCountsRate", "*", "dwell"}]}], ")"}], "/", 
                "t"}], "/", 
               RowBox[{"Abs", "[", 
                RowBox[{
                 RowBox[{"current", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "*", 
                 RowBox[{
                  RowBox[{"10", "^", 
                   RowBox[{"(", 
                    RowBox[{"-", "scale"}], ")"}]}], "/", 
                  RowBox[{"(", "1*^-9", ")"}]}]}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"errorSum", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "+=", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"counts", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "-", 
                 RowBox[{"darkCountsRate", "*", "dwell"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["t", "2"], "*", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"current", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "*", 
                    RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"(", 
                    RowBox[{"-", "scale"}], ")"}]}], "/", 
                    RowBox[{"(", "1*^-9", ")"}]}]}], ")"}], "2"]}], ")"}]}]}],
              ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", " ", "nDataPts"}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"errorSum", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "=", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"errorSum", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"sum", ",", "errorSum"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
    "GetCurrentNormalizedAverageCountRateFromFileNames", "[", "fileNames_", 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "filesPass", ",", "darkCountsRate", ",", "i", ",", "sum", ",", 
        "counts", ",", "dwell", ",", "current", ",", "nCycles", ",", 
        "errorSum", ",", " ", "error", ",", "nDataPts", ",", "j"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"filesPass", "=", 
        RowBox[{"ImportFile", "[", "fileNames", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "GetCurrentNormalizedAverageCountRateFromFiles", "[", "filesPass", 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetCurrentNormalizedMolyCountRateFromFileNames", "[", 
     RowBox[{"fileNames_", ",", "darkCountsRate_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "files", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"files", "=", 
        RowBox[{"ImportFile", "[", "fileNames", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"GetCurrentNormalizedMolyCountRateFromFiles", "[", 
        RowBox[{"files", ",", "darkCountsRate"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetCurrentNormalizedMolyCountRateFromFiles", "[", 
     RowBox[{"files_", ",", "darkCountsRate_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "currentnA", ",", "i", ",", "sum", ",", "counts", ",", "dwell", ",", 
        "current", ",", "nCycles", ",", "errorSum", ",", " ", "error", ",", 
        "nDataPts", ",", "j", ",", "currentScale"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nDataPts", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"darkCountsRate", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sum", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"errorSum", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", " ", "nDataPts"}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"sum", "=", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"sum", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"errorSum", "=", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"errorSum", ",", "0"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "files", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"currentScale", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"files", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<SCALE\>\"", "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"counts", "=", 
           RowBox[{"Normal", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"files", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"All", ",", "\"\<COUNT\>\""}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"current", "=", 
           RowBox[{"Normal", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"files", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"All", ",", "\"\<CURRENT\>\""}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"currentnA", "=", 
           RowBox[{"current", "*", 
            RowBox[{
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"-", "currentScale"}], ")"}]}], "/", "nA"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"dwell", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"files", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<DWELL(s)\>\"", "]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"nCycles", "=", 
           RowBox[{"Length", "[", "files", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "\[LessEqual]", "nDataPts"}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"sum", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "+=", 
              FractionBox[
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{"counts", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "dwell"], "-", 
                 RowBox[{
                  RowBox[{"darkCountsRate", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], ")"}], 
               RowBox[{"nCycles", "*", 
                RowBox[{"Abs", "[", 
                 RowBox[{"currentnA", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}]}]]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"errorSum", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "+=", 
              RowBox[{
               RowBox[{
                RowBox[{"counts", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["nCycles", "2"], "*", 
                  SuperscriptBox["dwell", "2"], "*", 
                  SuperscriptBox[
                   RowBox[{"currentnA", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "2"]}], ")"}]}], "-", 
               RowBox[{
                RowBox[{
                 RowBox[{"darkCountsRate", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["nCycles", "2"], "*", 
                  SuperscriptBox[
                   RowBox[{"currentnA", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "2"]}], ")"}]}]}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", " ", "nDataPts"}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"errorSum", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "=", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"errorSum", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"sum", ",", "errorSum"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BackgroundRateCurrentNorm", "[", 
     RowBox[{"files_", ",", "darkCountsFiles_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "darkCountsRate", ",", "i", ",", "sum", ",", "counts", ",", "dwell", 
        ",", "current", ",", "nCycles", ",", "errorSum", ",", " ", "error", 
        ",", "nDataPts", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"darkCountsRate", "=", 
        RowBox[{
        "GetAverageCountRateFromFiles", "[", "darkCountsFiles", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nDataPts", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"darkCountsRate", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sum", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"errorSum", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", " ", "nDataPts"}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"sum", "=", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"sum", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"errorSum", "=", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"errorSum", ",", "0"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "files", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"counts", "=", 
           RowBox[{"Normal", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"files", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"All", ",", "\"\<COUNT\>\""}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"current", "=", 
           RowBox[{"Normal", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"files", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"All", ",", "\"\<CURRENT\>\""}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"dwell", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"files", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<DWELL(s)\>\"", "]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"nCycles", "=", 
           RowBox[{"Length", "[", "files", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "\[LessEqual]", "nDataPts"}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"sum", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "+=", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"counts", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "/", "nCycles"}], "/", 
                 "dwell"}], "/", 
                RowBox[{"Abs", "[", 
                 RowBox[{"current", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"darkCountsRate", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "/", "nCycles"}], "/", 
                RowBox[{"Abs", "[", 
                 RowBox[{"current", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}]}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"errorSum", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "+=", 
              RowBox[{
               RowBox[{
                RowBox[{"counts", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["nCycles", "2"], "*", 
                  SuperscriptBox["dwell", "2"], "*", 
                  SuperscriptBox[
                   RowBox[{"current", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "2"]}], ")"}]}], "-", 
               RowBox[{
                RowBox[{
                 RowBox[{"darkCountsRate", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["nCycles", "2"], "*", 
                  SuperscriptBox[
                   RowBox[{"current", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "2"]}], ")"}]}]}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", " ", "nDataPts"}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"errorSum", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "=", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"errorSum", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"sum", ",", "errorSum"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AverageSignalRateCurrentNorm", "[", 
     RowBox[{"files_", ",", "molyCountsRate_", ",", "darkCountsFiles_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "darkCountsRate", ",", "i", ",", "sum", ",", "counts", ",", "dwell", 
        ",", "current", ",", "nCycles", ",", "errorSum", ",", " ", "error", 
        ",", "nDataPts", ",", "rev", ",", "j"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"darkCountsRate", "=", 
        RowBox[{
        "GetAverageCountRateFromFiles", "[", "darkCountsFiles", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nDataPts", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"darkCountsRate", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sum", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"errorSum", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", " ", "nDataPts"}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"sum", "=", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"sum", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"errorSum", "=", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"errorSum", ",", "0"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "files", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"counts", "=", 
           RowBox[{"Normal", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"files", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"All", ",", "\"\<COUNT\>\""}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"current", "=", 
           RowBox[{"Normal", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"files", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"All", ",", "\"\<CURRENT\>\""}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"dwell", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"files", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<DWELL(s)\>\"", "]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"rev", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"files", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<REV\>\"", "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"nCycles", "=", 
           RowBox[{"Length", "[", "files", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "\[LessEqual]", "nDataPts"}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"sum", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "+=", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"counts", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "/", "nCycles"}], "/", 
                  "rev"}], "/", "dwell"}], "/", 
                RowBox[{"Abs", "[", 
                 RowBox[{"current", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"darkCountsRate", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "/", "rev"}], "/", 
                 "nCycles"}], "/", 
                RowBox[{"Abs", "[", 
                 RowBox[{"current", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"molyCountsRate", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "/", "rev"}], "/", 
                "nCycles"}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"errorSum", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "+=", 
              RowBox[{
               RowBox[{
                RowBox[{"counts", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["nCycles", "2"], "*", 
                  SuperscriptBox["dwell", "2"], "*", 
                  SuperscriptBox["rev", "2"], "*", 
                  SuperscriptBox[
                   RowBox[{"current", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "2"]}], ")"}]}], "-", 
               RowBox[{
                RowBox[{
                 RowBox[{"darkCountsRate", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["nCycles", "2"], "*", 
                  SuperscriptBox["rev", "2"], "*", 
                  SuperscriptBox[
                   RowBox[{"current", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "2"]}], ")"}]}], "-", 
               RowBox[{
                RowBox[{
                 RowBox[{"molyCountsRate", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["nCycles", "2"], "*", 
                  SuperscriptBox["rev", "2"]}], ")"}]}]}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", " ", "nDataPts"}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"errorSum", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "=", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"errorSum", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"sum", ",", "errorSum"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SignalRateCurrentNormFromFiles", "[", 
    RowBox[{"file_", ",", "molyCountFiles_", ",", "darkCountsFiles_"}], "]"}],
    ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "molyCountsRate", ",", "darkCountsRate", ",", "i", ",", "sum", ",", 
       "counts", ",", "dwell", ",", "current", ",", "nCycles", ",", 
       "errorSum", ",", " ", "error", ",", "nDataPts", ",", "j"}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"darkCountsRate", "=", 
       RowBox[{
       "AverageGetAverageCountRateFromFiles", "[", "darkCountsFiles", "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"molyCountsRate", "=", 
       RowBox[{"AverageBackgroundRateCurrentNorm", "[", 
        RowBox[{"molyCountFiles", ",", "darkCountsFiles"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SignalRateCurrentNormFromRates", "[", 
       RowBox[{"file", ",", "molyCountFiles", ",", "darkCountsFiles"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SignalRateCurrentNormFromRates", "::", "usage"}], " ", "=", 
  "\"\<SignalRateCurrentNormFromRates takes three arguments. First, the file \
you wish to background subtract, second, the fourier data for the current \
dependent background, third, the fourier data for the current independent \
background.\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SignalRateCurrentNormFromRates", "[", 
     RowBox[{"fileName_", ",", "molyCountsRate_", ",", "darkCountsRate_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "file", ",", "i", ",", "sum", ",", "counts", ",", "dwell", ",", 
        "current", ",", "nCycles", ",", "errorSum", ",", " ", "error", ",", 
        "nDataPts", ",", "j", ",", "mTorrHe"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"file", "=", 
        RowBox[{"ImportFile", "[", "fileName", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nDataPts", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"Normal", "[", 
          RowBox[{
           RowBox[{"file", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"All", ",", "\"\<COUNT\>\""}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sum", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"errorSum", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", " ", "nDataPts"}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"sum", "=", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"sum", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"errorSum", "=", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"errorSum", ",", "0"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"counts", "=", 
        RowBox[{"Normal", "[", 
         RowBox[{
          RowBox[{"file", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"All", ",", "\"\<COUNT\>\""}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"current", "=", 
        RowBox[{"Normal", "[", 
         RowBox[{
          RowBox[{"file", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"All", ",", "\"\<CURRENT\>\""}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dwell", "=", 
        RowBox[{
         RowBox[{"file", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<DWELL(s)\>\"", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"nCycles", "=", 
        RowBox[{
         RowBox[{"file", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<REV\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mTorrHe", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"file", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<CVGauge(He)(Torr)\>\"", 
          "]"}], "/", "mTorr"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", "nDataPts"}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"sum", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "+=", 
           FractionBox[
            RowBox[{
             FractionBox[
              RowBox[{"(", 
               RowBox[{
                FractionBox[
                 RowBox[{"counts", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "dwell"], "-", 
                RowBox[{
                 RowBox[{"darkCountsRate", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], ")"}], 
              RowBox[{"Abs", "[", 
               RowBox[{"current", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "]"}]], "-", 
             RowBox[{
              RowBox[{"molyCountsRate", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], 
            RowBox[{"nCycles", "*", "mTorrHe"}]]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"errorSum", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "+=", 
           RowBox[{
            RowBox[{
             RowBox[{"counts", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "/", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["nCycles", "2"], "*", 
               SuperscriptBox["dwell", "2"], "*", 
               SuperscriptBox[
                RowBox[{"current", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "2"], "*", 
               SuperscriptBox["mTorrHe", "2"]}], ")"}]}], "-", 
            RowBox[{
             SuperscriptBox[
              RowBox[{
               RowBox[{"darkCountsRate", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "2"], "/", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["nCycles", "2"], "*", 
               SuperscriptBox[
                RowBox[{"current", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "2"], "*", 
               SuperscriptBox["mTorrHe", "2"]}], ")"}]}], "-", 
            RowBox[{
             SuperscriptBox[
              RowBox[{
               RowBox[{"molyCountsRate", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "2"], "/", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["nCycles", "2"], "*", 
               SuperscriptBox["mTorrHe", "2"]}], ")"}]}]}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", " ", "nDataPts"}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"errorSum", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "=", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"errorSum", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"sum", ",", "errorSum"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CalculateOneFileBackgroundSubtractedStokes", "[", 
     RowBox[{
     "polFileName_", ",", "molyCountRate_", ",", "darkCountRate_", ",", 
      RowBox[{"alpha_:", "alpha"}], ",", 
      RowBox[{"beta_:", "beta"}], ",", 
      RowBox[{"delta_:", "delta"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"signal", ",", "stokes", ",", "file", ",", "rev"}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"file", "=", 
        RowBox[{"ImportFile", "[", "polFileName", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rev", "=", 
        RowBox[{
         RowBox[{"file", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<REV\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"signal", "=", 
        RowBox[{"SignalRateCurrentNormFromRates", "[", 
         RowBox[{"polFileName", ",", "molyCountRate", ",", "darkCountRate"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"StokesParametersFromRawFourierData", "[", 
        RowBox[{
         RowBox[{"signal", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "rev", ",", "alpha", ",", 
         "beta", ",", "delta"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CalculateOneFileStokes", "[", 
     RowBox[{"polFileName_", ",", 
      RowBox[{"alpha_:", "alpha"}], ",", 
      RowBox[{"beta_:", "beta"}], ",", 
      RowBox[{"delta_:", "delta"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"signal", ",", "stokes", ",", "file", ",", "rev"}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"file", "=", 
        RowBox[{"ImportFile", "[", "polFileName", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rev", "=", 
        RowBox[{
         RowBox[{"file", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<REV\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"signal", "=", 
        RowBox[{"GetCurrentNormalizedAverageCountRateFromFiles", "[", 
         RowBox[{"{", "file", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"StokesParametersFromRawFourierData", "[", 
        RowBox[{
         RowBox[{"signal", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "rev", ",", "alpha", ",", 
         "beta", ",", "delta"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CalculateOneFileCurrent", "[", "polFileName_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "signal", ",", "stokes", ",", "file", ",", "rev", ",", "currentScale", 
        ",", "currentValues", ",", "currentPlot", ",", "currentAvg", ",", 
        "currentStd"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"file", "=", 
        RowBox[{"ImportFile", "[", "polFileName", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rev", "=", 
        RowBox[{
         RowBox[{"file", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<REV\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"currentScale", "=", 
        RowBox[{
         RowBox[{"file", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<SCALE\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"currentValues", "=", 
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{
           RowBox[{"file", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"All", ",", "\"\<CURRENT\>\"", ",", "Abs"}], "]"}], "]"}], 
         "*", 
         RowBox[{
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "currentScale"}], ")"}]}], "/", "nA"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"currentAvg", "=", 
        RowBox[{"Mean", "[", "currentValues", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"currentStd", "=", 
        RowBox[{"StandardDeviation", "[", "currentValues", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"currentPlot", "=", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{"currentValues", "/", "currentAvg"}], ",", 
          RowBox[{
          "PlotLabel", "\[Rule]", 
           "\"\<Current, Normalized to Average Current\>\""}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Stepper Motor Position\>\"", ",", "\"\<Current (nA)\>\""}], 
            "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{".8", ",", "1.2"}], "}"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<currentPlot\>\"", "\[Rule]", "currentPlot"}], ",", 
         RowBox[{"\"\<currentAvg\>\"", "\[Rule]", "currentAvg"}], ",", 
         RowBox[{"\"\<currentStd\>\"", "\[Rule]", "currentStd"}]}], 
        "|>"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AverageStokes", "[", "stokesVectors_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "i", ",", "transposedValues", ",", "stokes", ",", "stokesStdDev"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"stokes", "=", 
        RowBox[{"stokesVectors", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"stokesStdDev", "=", "stokes"}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "Just", " ", "creating", " ", "another", " ", "object", " ", "with", 
         " ", "the", " ", "same", " ", "length", " ", "as", " ", "stokes"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"transposedValues", "=", 
        RowBox[{"Transpose", "[", "stokesVectors", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", 
           RowBox[{"stokesVectors", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"stokes", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"stokesNames", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "->", 
            RowBox[{"Mean", "[", 
             RowBox[{"transposedValues", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"stokesStdDev", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"stokesErrNames", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "->", 
            RowBox[{
             RowBox[{"StandardDeviation", "[", 
              RowBox[{"transposedValues", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], "/", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"Length", "[", "transposedValues", "]"}], "]"}]}]}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Association", "[", "stokes", "]"}], ",", 
         RowBox[{"Association", "[", "stokesStdDev", "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "CalculateAverageBackgroundSubtractedStokesFromFilesAndCountRates", "[", 
    RowBox[{
    "polFileNames_", ",", "molyCountRate_", ",", "darkCountRate_", ",", 
     RowBox[{"alpha_:", "alpha"}], ",", 
     RowBox[{"beta_:", "beta"}], ",", 
     RowBox[{"delta_:", "delta"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "signal", ",", "stokes", ",", "stokesStdDev", ",", "file", ",", "rev", 
       ",", "j", ",", "stokesValues", ",", "transposedValues"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"stokes", "=", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<p0\>\"", "->", "0"}], ",", 
         RowBox[{"\"\<p1\>\"", "->", "0"}], ",", 
         RowBox[{"\"\<p2\>\"", "->", "0"}], ",", 
         RowBox[{"\"\<p3_mag\>\"", "->", "0"}], ",", 
         RowBox[{"\"\<p3_c2\>\"", "->", "0"}], ",", 
         RowBox[{"\"\<p3_s2\>\"", "->", "0"}]}], "|>"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"stokesStdDev", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"stokesValues", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", 
         RowBox[{"Length", "[", "polFileNames", "]"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"stokes", "=", 
          RowBox[{"CalculateOneFileStokes", "[", 
           RowBox[{
            RowBox[{"polFileNames", "[", 
             RowBox[{"[", "j", "]"}], "]"}], ",", "molyCountRate", ",", 
            "darkCountRate", ",", "alpha", ",", "beta", ",", "delta"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"stokesValues", ",", "stokes"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"AverageStokes", "[", "stokesValues", "]"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AverageStokes", "[", "stokesValues", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CalculateElectronPolarization", "[", "stokes_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"stokes", "[", "\"\<p3_s2\>\"", "]"}], "*", 
       RowBox[{"(", 
        FractionBox["2.6409", 
         RowBox[{"1.0614", "+", 
          RowBox[{".9386", "*", 
           RowBox[{"stokes", "[", "\"\<p1\>\"", "]"}]}]}]], ")"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CalculateElectronPolarizationError", "[", 
     RowBox[{"stokes_", ",", "averageStokes_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "pe", ",", "peError", ",", "p1Coeff", ",", "p3Coeff", ",", "p1Const", 
        ",", "p1Values", ",", "p3Values"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pe", "=", 
        RowBox[{
        "CalculateElectronPolarization", "[", "averageStokes", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"p1Const", "=", "1.0614"}], ";", "\[IndentingNewLine]", 
       RowBox[{"p1Coeff", "=", ".9386"}], ";", "\[IndentingNewLine]", 
       RowBox[{"p3Coeff", "=", "2.6409"}], ";", "\[IndentingNewLine]", 
       RowBox[{"p1Values", "=", 
        RowBox[{
         RowBox[{"Transpose", "[", "stokes", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "We", " ", "take", " ", "the", " ", "second", " ", "item", " ", "in", 
         " ", "the", " ", "transpose", " ", "because", " ", "the", " ", 
         "first", " ", "item", " ", "is", " ", "p0"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"p3Values", "=", 
        RowBox[{
         RowBox[{"Transpose", "[", "stokes", "]"}], "[", 
         RowBox[{"[", "6", "]"}], "]"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{"The", " ", "sixth", " ", "item", " ", "is", " ", "p3_s2"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"peError", "=", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          SuperscriptBox["pe", "2"], "*", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox[
               RowBox[{"averageStokes", "[", "\"\<p3_s2err\>\"", "]"}], 
               RowBox[{"averageStokes", "[", "\"\<p3_s2\>\"", "]"}]], ")"}], 
             "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox[
               RowBox[{
                RowBox[{"averageStokes", "[", "\"\<p1err\>\"", "]"}], "*", 
                "p1Coeff"}], 
               RowBox[{"p1Const", "+", 
                RowBox[{"p1Coeff", "*", 
                 RowBox[{"averageStokes", "[", "\"\<p1\>\"", "]"}]}]}]], 
              ")"}], "2"], "-", 
            FractionBox[
             SuperscriptBox[
              RowBox[{"Covariance", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"p1Values", "*", "p1Coeff"}], "+", "p1Const"}], ",", 
                RowBox[{"p3Values", "*", "p3Coeff"}]}], "]"}], "2"], 
             RowBox[{"(", 
              RowBox[{"p3Coeff", "*", 
               RowBox[{"averageStokes", "[", "\"\<p3_s2\>\"", "]"}], "*", 
               RowBox[{"(", 
                RowBox[{"p1Const", "+", 
                 RowBox[{"p1Coeff", "*", 
                  RowBox[{"averageStokes", "[", "\"\<p1\>\"", "]"}]}]}], 
                ")"}]}], ")"}]]}], ")"}]}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CalculateAverageStokesFromFiles", "[", 
    RowBox[{"polFileNames_", ",", 
     RowBox[{"alpha_:", "alpha"}], ",", 
     RowBox[{"beta_:", "beta"}], ",", 
     RowBox[{"delta_:", "delta"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "signal", ",", "stokes", ",", "stokesStdDev", ",", "file", ",", "rev", 
       ",", "j", ",", "stokesValues", ",", "transposedValues", ",", 
       "singleRunInfo", ",", "allSingleRunInfo", ",", "current", ",", 
       "counts", ",", "countsPlot", ",", "combinedPlot", ",", "results", ",", 
       "averageStokes"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"stokes", "=", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<p0\>\"", "->", "0"}], ",", 
         RowBox[{"\"\<p1\>\"", "->", "0"}], ",", 
         RowBox[{"\"\<p2\>\"", "->", "0"}], ",", 
         RowBox[{"\"\<p3_mag\>\"", "->", "0"}], ",", 
         RowBox[{"\"\<p3_c2\>\"", "->", "0"}], ",", 
         RowBox[{"\"\<p3_s2\>\"", "->", "0"}]}], "|>"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"stokesStdDev", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"stokesValues", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"allSingleRunInfo", "=", 
       RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", 
         RowBox[{"Length", "[", "polFileNames", "]"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"stokes", "=", 
          RowBox[{"CalculateOneFileStokes", "[", 
           RowBox[{
            RowBox[{"polFileNames", "[", 
             RowBox[{"[", "j", "]"}], "]"}], ",", "alpha", ",", "beta", ",", 
            "delta"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"current", "=", 
          RowBox[{"CalculateOneFileCurrent", "[", 
           RowBox[{"polFileNames", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"counts", "=", 
          RowBox[{"GetIntensityArrayFromFileName", "[", 
           RowBox[{"polFileNames", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"countsPlot", "=", 
          RowBox[{"ListPlot", "[", "counts", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"stokesValues", ",", "stokes"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"singleRunInfo", "=", 
          RowBox[{"<|", 
           RowBox[{"\"\<stokes\>\"", "\[Rule]", "stokes"}], "|>"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"singleRunInfo", ",", "current"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"singleRunInfo", ",", 
           RowBox[{"\"\<counts\>\"", "\[Rule]", "countsPlot"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"allSingleRunInfo", ",", " ", 
           RowBox[{
            RowBox[{"polFileNames", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "\[Rule]", "singleRunInfo"}]}], 
          "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"combinedPlot", "=", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{
         "GetAverageCountRateFromFileNames", "[", "polFileNames", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"averageStokes", "=", 
       RowBox[{"AverageStokes", "[", "stokesValues", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"results", "=", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<P_e\>\"", "\[Rule]", 
          RowBox[{
          "CalculateElectronPolarization", "[", "averageStokes", "]"}]}], ",", 
         RowBox[{"\"\<P_eerr\>\"", "\[Rule]", 
          RowBox[{"CalculateElectronPolarizationError", "[", 
           RowBox[{"stokesValues", ",", "averageStokes"}], "]"}]}]}], 
        "|>"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"results", ",", "averageStokes"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"results", ",", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{
          "\"\<IndividualRunInfo\>\"", "\[Rule]", "allSingleRunInfo"}], ",", 
          RowBox[{"\"\<AllRunsPlot\>\"", "\[Rule]", "combinedPlot"}]}], 
         "|>"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CalculateAverageCurrentFromFiles", "[", "polFileNames_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "signal", ",", "stokes", ",", "stokesStdDev", ",", "file", ",", "rev", 
       ",", "j", ",", "stokesValues", ",", "transposedValues"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"stokes", "=", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<p0\>\"", "->", "0"}], ",", 
         RowBox[{"\"\<p1\>\"", "->", "0"}], ",", 
         RowBox[{"\"\<p2\>\"", "->", "0"}], ",", 
         RowBox[{"\"\<p3_mag\>\"", "->", "0"}], ",", 
         RowBox[{"\"\<p3_c2\>\"", "->", "0"}], ",", 
         RowBox[{"\"\<p3_s2\>\"", "->", "0"}]}], "|>"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"stokesStdDev", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"stokesValues", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", 
         RowBox[{"Length", "[", "polFileNames", "]"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"stokes", "=", 
          RowBox[{"CalculateOneFileCurrent", "[", 
           RowBox[{"polFileNames", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"stokesValues", ",", "stokes"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"AverageStokes", "[", "stokesValues", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NormalizeStokes", "[", "stokesVector_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"intensity", ",", "newVector", ",", "i"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newVector", "=", "stokesVector"}], ";", "\[IndentingNewLine]", 
       RowBox[{"intensity", "=", 
        RowBox[{"stokesVector", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "2"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "stokesVector", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"newVector", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"stokesVector", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/", "intensity"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "newVector"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UnNormalizeStokes", "[", "stokesVector_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"intensity", ",", "newVector", ",", "i"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newVector", "=", "stokesVector"}], ";", "\[IndentingNewLine]", 
       RowBox[{"intensity", "=", 
        RowBox[{"stokesVector", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "2"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "stokesVector", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"newVector", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"stokesVector", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "*", "intensity"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "newVector"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SubtractStokes", "[", 
     RowBox[{"addedStokes_", ",", "subtractedStokes_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"unNormAdd", ",", "unNormSub"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"unNormAdd", "=", 
        RowBox[{"UnNormalizeStokes", "[", "addedStokes", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"unNormSub", "=", 
        RowBox[{"UnNormalizeStokes", "[", "subtractedStokes", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NormalizeStokes", "[", 
        RowBox[{"unNormAdd", "-", "unNormSub"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetIntensityArrayFromFileName", "[", "fileName_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"f", ",", "intensityArray"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"f", "=", 
        RowBox[{"ImportFile", "[", "fileName", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"intensityArray", "=", 
        RowBox[{"Normal", "[", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"All", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<ANGLE\>\"", ",", "\"\<COUNT\>\""}], "}"}]}], "]"}], 
         "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PlotRawPolFromFileName", "[", "fileName_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"f", ",", "intensityArray"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f", "=", 
       RowBox[{"ImportFile", "[", "fileName", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"intensityArray", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"All", ",", "\"\<COUNT\>\""}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ListPlot", "[", "intensityArray", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"PlotRawPolFromFileName", ",", "Listable"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PlotListOfPolFileNames", "[", 
     RowBox[{"fileNames_", ",", 
      RowBox[{"plotRange_:", 
       RowBox[{"{", 
        RowBox[{"Automatic", ",", "Automatic"}], "}"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"intensityArrays", ",", "i"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"intensityArrays", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "fileNames", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"intensityArrays", ",", 
            RowBox[{"Legended", "[", 
             RowBox[{
              RowBox[{"GetIntensityArrayFromFileName", "[", 
               RowBox[{"fileNames", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
              RowBox[{"fileNames", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", 
        RowBox[{"intensityArrays", ",", 
         RowBox[{"PlotRange", "\[Rule]", "plotRange"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetStokesFromFileNames", "[", 
    RowBox[{"fileNames_", ",", 
     RowBox[{"alpha_:", "alpha"}], ",", 
     RowBox[{"beta_:", "beta"}], ",", 
     RowBox[{"delta_:", "delta"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "stokes", ",", "signal", ",", "stokesData"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"stokesData", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"signal", "=", 
       RowBox[{"ImportFile", "[", "fileNames", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "fileNames", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"stokes", "=", 
          RowBox[{"StokesParametersFromPolFile", "[", 
           RowBox[{
            RowBox[{"signal", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "alpha", ",", "beta", ",", 
            "delta", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"signal", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<REV\>\"", "]"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"stokesData", ",", "stokes"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "stokesData"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
    "GetAverageFourierCoefficientsFromFileNames", "[", "fileNames", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "fc", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"fc", "=", 
       RowBox[{
       "GetFourierCoefficientsFromFileNames", "[", "fileNames", "]"}]}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetFourierCoefficientsFromFileNames", "[", "fileNames_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "files", ",", "i", ",", "coefficientsList", ",", "intensityArray", ",",
         "revs"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"files", "=", 
        RowBox[{"ImportFile", "[", "fileNames", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"coefficientsList", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "files", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"revs", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"files", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<REV\>\"", "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"intensityArray", "=", 
           RowBox[{"Normal", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"files", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"All", ",", "\"\<COUNT\>\""}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"coefficientsList", ",", 
            RowBox[{"DFT", "[", 
             RowBox[{"intensityArray", ",", "revs"}], "]"}]}], "]"}], ";"}]}],
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "coefficientsList"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetAoutToEnergyModelFromExcitationFunctionTimeStamp", "[", 
     RowBox[{"excitationFileNames_", ",", "timeStamp_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "exFileIndex", ",", "exFile", ",", "aoutToElectronEnergyData", ",", 
        "x"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"exFileIndex", "=", 
        RowBox[{"GetIndexOfFilenameFromTimestamp", "[", 
         RowBox[{"excitationFileNames", ",", "timeStamp"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"exFile", "=", 
        RowBox[{"ImportFile", "[", 
         RowBox[{"excitationFileNames", "[", 
          RowBox[{"[", "exFileIndex", "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"aoutToElectronEnergyData", "=", 
        RowBox[{"Normal", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"exFile", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<Aout\>\"", ",", "\"\<SecondaryElectronEnergy\>\""}],
              "}"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "Values"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"LinearModelFit", "[", 
        RowBox[{"aoutToElectronEnergyData", ",", "x", ",", "x"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetListOfPropertiesFromHeadersOfListOfFileNames", "[", 
     RowBox[{"fileName_", ",", "property_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "f", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"f", "=", 
        RowBox[{"ImportFile", "[", "fileName", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Normal", "[", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", "property", "]"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{
    "GetListOfPropertiesFromHeadersOfListOfFileNames", ",", "Listable"}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OrganizeFilesByCategories", "[", 
     RowBox[{
     "fileNames_", ",", "startFile_", ",", "categories_", ",", "runs_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "allFiles", ",", "j", ",", "i", ",", "listOfNames", ",", "subsetFiles",
         ",", "firstFile", ",", "lastFile", ",", "files"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"allFiles", "=", 
        RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"subsetFiles", "=", 
        RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"files", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "<=", 
          RowBox[{"Length", "[", 
           RowBox[{"categories", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "=", "1"}], ",", 
            RowBox[{"i", "<=", 
             RowBox[{"Length", "[", 
              RowBox[{"categories", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"firstFile", "=", 
              RowBox[{
               RowBox[{"(", "startFile", ")"}], "+", 
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"j", "-", "1"}], ")"}], "*", 
                RowBox[{"Length", "[", 
                 RowBox[{"categories", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "*", "runs"}]}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"lastFile", "=", 
              RowBox[{
               RowBox[{"(", "startFile", ")"}], "+", 
               RowBox[{"j", "*", 
                RowBox[{"Length", "[", 
                 RowBox[{"categories", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "*", "runs"}], "-", 
               "1"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"listOfNames", "=", 
              RowBox[{"Take", "[", 
               RowBox[{"fileNames", ",", 
                RowBox[{"{", 
                 RowBox[{"firstFile", ",", "lastFile", ",", "3"}], 
                 RowBox[{"(*", 
                  RowBox[{"Length", "[", 
                   RowBox[{"categories", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "*)"}], "}"}]}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"files", ",", 
               RowBox[{"<|", 
                RowBox[{
                 RowBox[{"\"\<cat1\>\"", "\[Rule]", " ", 
                  RowBox[{
                   RowBox[{"categories", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], ",", 
                 RowBox[{"\"\<cat2\>\"", "\[Rule]", 
                  RowBox[{
                   RowBox[{"categories", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                 RowBox[{
                 "\"\<fileNames\>\"", "\[Rule]", " ", "listOfNames"}]}], 
                "|>"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "files"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetStokesFromDatasetLine", "[", "datasetLine_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"stokes", ",", "stokesErr", ",", "v"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"stokes", "=", 
       RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"stokesErr", "=", 
       RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"v", "=", "1"}], ",", 
        RowBox[{"v", "\[LessEqual]", 
         RowBox[{"Length", "[", "stokesNames", "]"}]}], ",", 
        RowBox[{"v", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"stokes", ",", 
           RowBox[{
            RowBox[{"stokesNames", "[", 
             RowBox[{"[", "v", "]"}], "]"}], "->", 
            RowBox[{
             RowBox[{"Normal", "[", 
              RowBox[{"datasetLine", "[", 
               RowBox[{"All", ",", 
                RowBox[{"stokesNames", "[", 
                 RowBox[{"[", "v", "]"}], "]"}]}], "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"stokesErr", ",", 
           RowBox[{
            RowBox[{"stokesErrNames", "[", 
             RowBox[{"[", "v", "]"}], "]"}], "->", 
            RowBox[{
             RowBox[{"Normal", "[", 
              RowBox[{"datasetLine", "[", 
               RowBox[{"All", ",", 
                RowBox[{"stokesErrNames", "[", 
                 RowBox[{"[", "v", "]"}], "]"}]}], "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"stokes", ",", "stokesErr"}], "}"}]}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7150122777567425`*^9, 3.7150122840119996`*^9}, {
   3.7150123261726923`*^9, 3.7150123303405285`*^9}, {3.7150124359734163`*^9, 
   3.715012479646136*^9}, {3.7150128069518833`*^9, 3.715012818751912*^9}, {
   3.7150129667449007`*^9, 3.7150129819452457`*^9}, {3.7150130364173155`*^9, 
   3.7150131715294724`*^9}, {3.7150133166513133`*^9, 
   3.7150133179692016`*^9}, {3.7150133480254803`*^9, 3.715013381257094*^9}, {
   3.715013414513726*^9, 3.715013414978044*^9}, {3.7150135356901937`*^9, 
   3.715013558972037*^9}, {3.7150136509316206`*^9, 3.7150136664751987`*^9}, {
   3.715013710956468*^9, 3.715013751796263*^9}, {3.7150138363427997`*^9, 
   3.715013845285886*^9}, {3.7150139033013687`*^9, 3.715013907556264*^9}, {
   3.7150146812816114`*^9, 3.7150146815527964`*^9}, {3.7150164533544197`*^9, 
   3.7150165176511755`*^9}, {3.7150165661391735`*^9, 3.715016634939995*^9}, {
   3.7150167998842473`*^9, 3.715016921549045*^9}, {3.7150169518296175`*^9, 
   3.715016979725424*^9}, {3.7150170467736287`*^9, 3.715017105548256*^9}, {
   3.7150948951139283`*^9, 3.715094911169752*^9}, {3.7150953668023195`*^9, 
   3.7150953669304056`*^9}, {3.71509547147389*^9, 3.7150954720903053`*^9}, {
   3.7182251437153063`*^9, 3.7182251496754575`*^9}, {3.718357112618618*^9, 
   3.718357131721839*^9}, {3.718358280651499*^9, 3.718358291571581*^9}, {
   3.7183587752690325`*^9, 3.7183588555331583`*^9}, {3.718536357841588*^9, 
   3.718536366223791*^9}, 3.7185374424102783`*^9, {3.718537487264779*^9, 
   3.7185375048093243`*^9}, {3.7186257944026575`*^9, 
   3.7186258398480296`*^9}, {3.7186260420988913`*^9, 
   3.7186260462573795`*^9}, {3.7186261747312527`*^9, 3.718626238675158*^9}, {
   3.7186262981771984`*^9, 3.7186263020087233`*^9}, {3.7186278687087107`*^9, 
   3.7186278869409957`*^9}, {3.71862988018147*^9, 3.7186299331641417`*^9}, {
   3.718629966259931*^9, 3.718630023020313*^9}, {3.7186301098601665`*^9, 
   3.718630121956868*^9}, {3.7186301534850197`*^9, 3.718630230116749*^9}, {
   3.718630275405334*^9, 3.7186303079177303`*^9}, {3.718630630682119*^9, 
   3.7186306604797077`*^9}, {3.7186364645717545`*^9, 3.718636503828915*^9}, {
   3.7186369941469374`*^9, 3.718636999178377*^9}, {3.718637181270069*^9, 
   3.71863722120669*^9}, {3.718637286656125*^9, 3.7186373487418346`*^9}, {
   3.718637434364954*^9, 3.718637436037042*^9}, {3.718638333077673*^9, 
   3.718638584590866*^9}, {3.71863862427777*^9, 3.7186386291094046`*^9}, {
   3.71863870442287*^9, 3.71863881646154*^9}, {3.7186389757345586`*^9, 
   3.7186390898551702`*^9}, {3.7186391549751325`*^9, 3.718639293623472*^9}, 
   3.7186404883858066`*^9, 3.718807283599803*^9, {3.7191687952426605`*^9, 
   3.7191688118469987`*^9}, {3.719169330880847*^9, 3.719169333246519*^9}, {
   3.719170978878663*^9, 3.7191709811972003`*^9}, {3.7191729754777555`*^9, 
   3.7191729786428833`*^9}, {3.7196569306100197`*^9, 
   3.7196569392326803`*^9}, {3.7196572119282494`*^9, 
   3.7196572614849744`*^9}, {3.719657310984816*^9, 3.719657501219633*^9}, {
   3.719658535931945*^9, 3.719658567669435*^9}, {3.71965861104198*^9, 
   3.719658627514229*^9}, {3.719658702207617*^9, 3.719658799854063*^9}, {
   3.7196588327302527`*^9, 3.719658851107474*^9}, {3.7196610864587636`*^9, 
   3.7196611054034476`*^9}, {3.7196612437227564`*^9, 
   3.7196612673185477`*^9}, {3.7196614702365026`*^9, 3.719661470392771*^9}, {
   3.719661538263246*^9, 3.7196615606819563`*^9}, {3.7196618404470344`*^9, 
   3.719661841704336*^9}, {3.7196789731842527`*^9, 3.719678973512398*^9}, {
   3.7196793636437483`*^9, 3.7196793881766105`*^9}, {3.7196794399548683`*^9, 
   3.7196795993682504`*^9}, 3.7196799412181425`*^9, {3.71968023671253*^9, 
   3.7196802495057297`*^9}, {3.719680321044595*^9, 3.719680328750995*^9}, {
   3.7196804173552775`*^9, 3.719680490007141*^9}, {3.7196805200927167`*^9, 
   3.7196805555805473`*^9}, {3.724130705254901*^9, 3.7241307146366367`*^9}, {
   3.7241372564314623`*^9, 3.7241372756174006`*^9}, {3.7241381200124474`*^9, 
   3.724138425009313*^9}, {3.7241385096518908`*^9, 3.724138552419983*^9}, {
   3.725156692096414*^9, 3.725156721320167*^9}, {3.725159952383012*^9, 
   3.725159988483403*^9}, {3.725361270093484*^9, 3.7253612771723337`*^9}, {
   3.725361363764244*^9, 3.7253614655214157`*^9}, {3.725361505754155*^9, 
   3.725361506289722*^9}, {3.725361567131859*^9, 3.7253615732602158`*^9}, {
   3.725361643589486*^9, 3.725361654609209*^9}, {3.725369678054991*^9, 
   3.72536968084339*^9}, {3.725373175650379*^9, 3.725373193421525*^9}, {
   3.725373498119879*^9, 3.725373504135483*^9}, {3.7253735425872726`*^9, 
   3.725373578307466*^9}, {3.7253736927301598`*^9, 3.7253737052914333`*^9}, {
   3.725376994575294*^9, 3.725376997207756*^9}, {3.7253770297724237`*^9, 
   3.725377066082608*^9}, {3.725377099093182*^9, 3.72537710687241*^9}, {
   3.725377171602428*^9, 3.7253772512706747`*^9}, {3.725377377184339*^9, 
   3.725377409370453*^9}, {3.7256251652411504`*^9, 3.725625205568283*^9}, {
   3.7256252679379168`*^9, 3.7256253697225947`*^9}, {3.7256254652986746`*^9, 
   3.7256254785785613`*^9}, {3.725625844980381*^9, 3.725625913606907*^9}, {
   3.7256259497507286`*^9, 3.725625950398236*^9}, {3.7256259817089944`*^9, 
   3.725626067046221*^9}, {3.725626129622053*^9, 3.7256262146059203`*^9}, {
   3.72562705154838*^9, 3.72562705453741*^9}, {3.725627190763912*^9, 
   3.7256272018184195`*^9}, {3.725627234348508*^9, 3.725627250515486*^9}, {
   3.725627402888579*^9, 3.725627462874071*^9}, {3.7256275384813685`*^9, 
   3.725627555075847*^9}, {3.725627640656625*^9, 3.725627720497345*^9}, {
   3.725628164261633*^9, 3.7256281792290783`*^9}, {3.7256282716709747`*^9, 
   3.725628281954458*^9}, {3.7256286265938253`*^9, 3.725628632137954*^9}, {
   3.7256286725563016`*^9, 3.7256286743813114`*^9}, {3.725628760035572*^9, 
   3.7256287921460037`*^9}, {3.725628822674121*^9, 3.725628838850105*^9}, 
   3.725628899829816*^9, {3.7256291156997876`*^9, 3.725629293713046*^9}, {
   3.7256534541614637`*^9, 3.7256534831451454`*^9}, {3.72565353032218*^9, 
   3.725653596394046*^9}, {3.7257109887492657`*^9, 3.725711196993899*^9}, {
   3.7257140714859676`*^9, 3.7257140717258635`*^9}, {3.725717151594884*^9, 
   3.7257172317713795`*^9}, {3.7257173764473825`*^9, 
   3.7257175396648684`*^9}, {3.7257175820917087`*^9, 
   3.7257175937052307`*^9}, {3.725717696040263*^9, 3.7257177279194756`*^9}, {
   3.7257178257631865`*^9, 3.7257178587527947`*^9}, {3.7257179924131985`*^9, 
   3.7257180274453225`*^9}, {3.725718067723214*^9, 3.725718156657661*^9}, {
   3.7257191784623833`*^9, 3.725719327703453*^9}, {3.725719386963732*^9, 
   3.725719414542586*^9}, {3.725719446962509*^9, 3.7257194938065825`*^9}, {
   3.725719556985587*^9, 3.7257195826474543`*^9}, {3.725721222913952*^9, 
   3.725721242126998*^9}, {3.7257213470249147`*^9, 3.7257214179935255`*^9}, {
   3.725721541506644*^9, 3.725721573184244*^9}, {3.725721717036337*^9, 
   3.7257217171847057`*^9}, {3.7257217533393946`*^9, 
   3.7257217540971484`*^9}, {3.725721988979336*^9, 3.725721995970769*^9}, {
   3.7257220286609793`*^9, 3.7257220416124573`*^9}, {3.725722209295404*^9, 
   3.725722258205493*^9}, {3.7257224084087915`*^9, 3.7257224438933535`*^9}, {
   3.725722526557171*^9, 3.725722575285695*^9}, 3.7257226127660513`*^9, {
   3.7257265283385525`*^9, 3.7257266161690826`*^9}, {3.725726657021805*^9, 
   3.725726674731352*^9}, {3.725726759965147*^9, 3.7257267638428216`*^9}, {
   3.7257268223662567`*^9, 3.7257268329598136`*^9}, {3.7257270049792385`*^9, 
   3.725727134495313*^9}, {3.725727759614582*^9, 3.72572781168793*^9}, {
   3.7257284281936626`*^9, 3.725728452632845*^9}, 3.7257285556833563`*^9, {
   3.725729234306243*^9, 3.7257292344813476`*^9}, {3.7257294242080917`*^9, 
   3.7257294245753746`*^9}, {3.7257296875582137`*^9, 
   3.7257297222772284`*^9}, {3.725730360788712*^9, 3.725730469717002*^9}, {
   3.7257340807293367`*^9, 3.725734083536483*^9}, {3.7257346865086255`*^9, 
   3.725734686740314*^9}, {3.725762666521338*^9, 3.72576266706021*^9}, {
   3.725762913156508*^9, 3.725762918314403*^9}, {3.725763112138493*^9, 
   3.725763150476066*^9}, {3.725763217356783*^9, 3.725763218727353*^9}, {
   3.725763434592802*^9, 3.725763435492338*^9}, {3.7257640284964533`*^9, 
   3.725764060536249*^9}, {3.725764194367964*^9, 3.72576442299879*^9}, {
   3.725764510840143*^9, 3.7257645620459843`*^9}, {3.725764942636063*^9, 
   3.725765010443756*^9}, {3.725765066611475*^9, 3.725765075427355*^9}, 
   3.725765126244788*^9, {3.725765763277134*^9, 3.725765831229218*^9}, {
   3.72576586831892*^9, 3.725765877344068*^9}, {3.725765915520934*^9, 
   3.7257659157182417`*^9}, {3.7258031745049324`*^9, 3.725803278553584*^9}, {
   3.7258034122573833`*^9, 3.7258034299153647`*^9}, {3.7259744143014827`*^9, 
   3.7259745357589564`*^9}, {3.7259809693432035`*^9, 3.725980994615141*^9}, {
   3.7259810704882226`*^9, 3.7259811145679626`*^9}, {3.7259814803929977`*^9, 
   3.7259814939598646`*^9}, {3.725981550987812*^9, 3.7259815530522237`*^9}, {
   3.7259815954364395`*^9, 3.7259816304324822`*^9}, {3.7259816753828783`*^9, 
   3.7259818058417687`*^9}, 3.725981886192144*^9, {3.725981918105219*^9, 
   3.725981934382265*^9}, {3.726316867110964*^9, 3.726316922175006*^9}, {
   3.726316960993117*^9, 3.726316963380725*^9}, {3.726343523601181*^9, 
   3.7263437280347214`*^9}, {3.726343940624771*^9, 3.7263439578110747`*^9}, {
   3.7263455273297377`*^9, 3.726345561001912*^9}, {3.7263456562440677`*^9, 
   3.72634581996395*^9}, {3.7264037973680367`*^9, 3.7264038944089317`*^9}, {
   3.726577111566964*^9, 3.7265771516462793`*^9}, {3.726577263786563*^9, 
   3.726577301478941*^9}, {3.7265773474356527`*^9, 3.7265773881415906`*^9}, {
   3.7265775451149254`*^9, 3.726577547792158*^9}, {3.7265776687541747`*^9, 
   3.726577670392644*^9}, {3.726577763865817*^9, 3.7265777643613853`*^9}, {
   3.7265997824115515`*^9, 3.726599997845849*^9}, 3.7266017447625885`*^9, {
   3.726602074155616*^9, 3.726602155851307*^9}, {3.7266023175858507`*^9, 
   3.7266025001040025`*^9}, {3.726614915265176*^9, 3.726614938695759*^9}, {
   3.7266212407424555`*^9, 3.7266212424095345`*^9}, {3.726622643323842*^9, 
   3.7266227251671915`*^9}, {3.7266228762160873`*^9, 
   3.7266229468771906`*^9}, {3.7266230326897397`*^9, 3.726623055897396*^9}, 
   3.726623163746276*^9, {3.726623360412195*^9, 3.7266233777077055`*^9}, {
   3.7266241380598555`*^9, 3.7266241684342895`*^9}, {3.7266243046719265`*^9, 
   3.726624305319645*^9}, {3.7266735211691113`*^9, 3.726673562847148*^9}, {
   3.7266757991479406`*^9, 3.7266758006208916`*^9}, {3.726683842601447*^9, 
   3.7266838508082*^9}, {3.7266838970760164`*^9, 3.726683922165495*^9}, {
   3.7266839648202705`*^9, 3.7266841790255375`*^9}, {3.726685954043635*^9, 
   3.7266859550744886`*^9}, {3.7268327196640964`*^9, 3.726832726727*^9}, {
   3.728042390758366*^9, 3.728042424088662*^9}, {3.728042647874691*^9, 
   3.728042790039465*^9}, {3.728042826932293*^9, 3.728042840136204*^9}, {
   3.728042891967393*^9, 3.7280429045931396`*^9}, {3.728043429134473*^9, 
   3.7280434363746047`*^9}, {3.728043471730895*^9, 3.7280434719281435`*^9}, {
   3.7280437401867757`*^9, 3.7280438633287516`*^9}, {3.7280440612352734`*^9, 
   3.7280442033350954`*^9}, {3.7280442511361685`*^9, 3.728044254638239*^9}, {
   3.728044337285161*^9, 3.728044340940213*^9}, {3.7280443994062986`*^9, 
   3.728044420907921*^9}, {3.7280524334908504`*^9, 3.7280524569141173`*^9}, {
   3.728052598828785*^9, 3.7280527243675003`*^9}, {3.728052857474166*^9, 
   3.7280528578335648`*^9}, {3.728089004864294*^9, 3.728089009239246*^9}, {
   3.7284813733587894`*^9, 3.728481374015078*^9}, {3.7288267189110966`*^9, 
   3.728826726704595*^9}, {3.729094062479512*^9, 3.729094138041443*^9}, {
   3.7290945506646624`*^9, 3.729094575729553*^9}, {3.729094661601413*^9, 
   3.7290946650859966`*^9}, {3.7290948372283344`*^9, 3.72909483758773*^9}, {
   3.7304765333253403`*^9, 3.730476533836692*^9}, {3.7304765651191416`*^9, 
   3.7304765690048056`*^9}, {3.730476719104724*^9, 3.730476721052059*^9}, {
   3.730546646942898*^9, 3.73054665215544*^9}, {3.730546686235592*^9, 
   3.7305468118689375`*^9}, {3.7305468518370905`*^9, 3.730546991582023*^9}, {
   3.730547705265544*^9, 3.730547732114784*^9}, {3.730552067995635*^9, 
   3.7305520698328834`*^9}, {3.7305521045995007`*^9, 3.730552105432068*^9}, {
   3.730552224969273*^9, 3.7305522710926056`*^9}, {3.7305523049218063`*^9, 
   3.7305523086893663`*^9}, {3.7305530828124313`*^9, 
   3.7305531088142605`*^9}, {3.7305534537348375`*^9, 
   3.7305534714108453`*^9}, {3.730553539348998*^9, 3.7305535488044224`*^9}, {
   3.7305612877497053`*^9, 3.7305612880719233`*^9}, {3.7307237989367065`*^9, 
   3.730723817688446*^9}, {3.7307289572048025`*^9, 3.7307290139933805`*^9}, 
   3.7308327260945687`*^9, {3.7308338511353154`*^9, 3.730833879215234*^9}, {
   3.7308339354222116`*^9, 3.7308339837068577`*^9}, {3.7310715285602503`*^9, 
   3.731071544391387*^9}, {3.731071650207123*^9, 3.7310716518232446`*^9}, {
   3.7310720633889046`*^9, 3.731072222758563*^9}, {3.7310722564534616`*^9, 
   3.7310722740179324`*^9}, 3.731072951541869*^9, {3.731073009745221*^9, 
   3.7310730189216366`*^9}, {3.731073131545953*^9, 3.731073132814689*^9}, {
   3.731073176738169*^9, 3.731073185516845*^9}, {3.731073715109143*^9, 
   3.7310737318565087`*^9}, {3.7310738249515033`*^9, 
   3.7310738258299475`*^9}, {3.7310762244430685`*^9, 
   3.7310762247127676`*^9}, {3.73107718034634*^9, 3.7310772313652306`*^9}, {
   3.7310773166050596`*^9, 3.7310774572859364`*^9}, {3.731077524258972*^9, 
   3.7310776067173743`*^9}, {3.7310776853630323`*^9, 3.7310777038954673`*^9}, 
   3.731077846660815*^9, {3.7310779551528187`*^9, 3.7310779882176433`*^9}, {
   3.7310780415182476`*^9, 3.731078058175564*^9}, {3.731078231889806*^9, 
   3.731078266892044*^9}, {3.731078361601231*^9, 3.731078447700491*^9}, {
   3.7310785659736843`*^9, 3.731078650307205*^9}, {3.73107889901062*^9, 
   3.731078989250769*^9}, {3.731079073974941*^9, 3.731079076803247*^9}, {
   3.7310793008175817`*^9, 3.7310793747285624`*^9}, {3.731079454843064*^9, 
   3.7310794554212265`*^9}, {3.7310798993192363`*^9, 3.731079942228232*^9}, {
   3.7310800466411657`*^9, 3.7310802467171526`*^9}, {3.7310803220818286`*^9, 
   3.731080412900716*^9}, {3.731080445965494*^9, 3.7310805362993994`*^9}, {
   3.731080782518281*^9, 3.731080794690935*^9}, {3.731080910432717*^9, 
   3.7310809509040565`*^9}, {3.731147823274612*^9, 3.7311478355879*^9}, 
   3.7323752184443293`*^9, {3.7324545966031694`*^9, 3.7324546565248766`*^9}, {
   3.7324547028433423`*^9, 3.7324548719332113`*^9}, {3.73245491039534*^9, 
   3.732454928539666*^9}, {3.7324550060343113`*^9, 3.732455197850619*^9}, {
   3.7324552316946106`*^9, 3.732455362303338*^9}, {3.732455418756688*^9, 
   3.73245546390536*^9}, 3.732457860040015*^9, {3.732458454088107*^9, 
   3.7324586883042183`*^9}, {3.732458802097522*^9, 3.732458906146207*^9}, {
   3.732458944678384*^9, 3.7324592730444546`*^9}, {3.7324593350405703`*^9, 
   3.73245936683547*^9}, {3.732459734820998*^9, 3.7324598980678988`*^9}, {
   3.732460187268363*^9, 3.7324602053526487`*^9}, 3.732460368378934*^9, {
   3.732460920928938*^9, 3.732460921473308*^9}, {3.7324611639920607`*^9, 
   3.732461181077667*^9}, {3.7324618740490685`*^9, 3.7324619754489546`*^9}, {
   3.732462052251129*^9, 3.732462052921584*^9}, {3.7324621478740892`*^9, 
   3.7324621569272385`*^9}, {3.7324642424820676`*^9, 
   3.7324642566757097`*^9}, {3.7324645485300493`*^9, 
   3.7324645966267233`*^9}, {3.732532253272005*^9, 3.732532263816168*^9}, {
   3.732711602010563*^9, 3.7327116051324887`*^9}, {3.732711646587335*^9, 
   3.7327116936429405`*^9}, {3.732711861470998*^9, 3.732711869295396*^9}, {
   3.7327180211945243`*^9, 3.732718126695858*^9}, {3.732718274745291*^9, 
   3.7327183001844325`*^9}, 3.732718361432844*^9, {3.7327184498691683`*^9, 
   3.7327184499620967`*^9}, {3.7327187644016747`*^9, 
   3.7327187687002125`*^9}, {3.732718853451194*^9, 3.732718860235863*^9}, {
   3.732720563030653*^9, 3.7327205802911563`*^9}, {3.7327207753985825`*^9, 
   3.732720860227005*^9}, 3.7327209886608267`*^9, {3.7327225597852077`*^9, 
   3.7327225617690525`*^9}, {3.732723124735416*^9, 3.7327231713441887`*^9}, {
   3.7327233926064515`*^9, 3.732723427279981*^9}, {3.7327234724312353`*^9, 
   3.7327235474077225`*^9}, {3.73272444547423*^9, 3.732724487140868*^9}, {
   3.7327246091547747`*^9, 3.732724624210519*^9}, {3.7327246826139555`*^9, 
   3.732724683349551*^9}, {3.7327247657511306`*^9, 3.732724772068982*^9}, 
   3.7327273212840443`*^9, {3.732727354898823*^9, 3.7327273569950943`*^9}, {
   3.733758544285136*^9, 3.733758547733514*^9}, {3.7337585881788054`*^9, 
   3.733758591925579*^9}, 3.7398022376549854`*^9, {3.7398958142074776`*^9, 
   3.7398958143835974`*^9}, {3.7398977333055983`*^9, 3.739897735721247*^9}, {
   3.739900166585142*^9, 3.7399001687956495`*^9}, {3.73990037826652*^9, 
   3.7399004461388116`*^9}, 3.7399005903611784`*^9, {3.739901046271044*^9, 
   3.7399010808777733`*^9}, {3.7399011142413187`*^9, 3.739901117309391*^9}, {
   3.7399012425304365`*^9, 3.739901247073535*^9}, {3.7399012819223037`*^9, 
   3.7399013072185574`*^9}, {3.740226321920274*^9, 3.7402263261791615`*^9}, {
   3.7402290389530687`*^9, 
   3.7402290717932215`*^9}},ExpressionUUID->"8dcca340-e825-4b53-8121-\
13aa353b7974"],

Cell[BoxData["\<\"SignalRateCurrentNormFromRates takes three arguments. \
First, the file you wish to background subtract, second, the fourier data for \
the current dependent background, third, the fourier data for the current \
independent background.\"\>"], "Output",
 CellChangeTimes->{
  3.731080545971894*^9, 3.73108095362298*^9, 3.731145806931587*^9, 
   3.731146908113328*^9, 3.7311478424477153`*^9, 3.732364697455039*^9, 
   3.732374821937138*^9, 3.732375229312771*^9, 3.7323786315643463`*^9, 
   3.7323851612753677`*^9, 3.732453989892725*^9, 3.7324598991906624`*^9, 
   3.7324611826517367`*^9, 3.7324619789863567`*^9, 3.7324620549149375`*^9, 
   3.7324621579509344`*^9, 3.732464266678505*^9, 3.7324645984159374`*^9, 
   3.7324762975340843`*^9, 3.7325314748255997`*^9, {3.7325322646397314`*^9, 
   3.732532289757059*^9}, 3.7325676337445855`*^9, 3.732628536113787*^9, 
   3.732705843702716*^9, 3.732711696074404*^9, 3.7327118705478773`*^9, 
   3.7327180226390104`*^9, 3.732718157137906*^9, 3.732718451313324*^9, 
   3.7327188617121353`*^9, 3.7327208883189664`*^9, 3.732722566568695*^9, 
   3.732723190444523*^9, 3.732723429093953*^9, {3.732723512326614*^9, 
   3.7327235484235315`*^9}, 3.7327246250204887`*^9, 3.7327247196943946`*^9, 
   3.7327247730192437`*^9, 3.7327273229539857`*^9, 3.7327273576262827`*^9, 
   3.7330584154229746`*^9, 3.73340917050955*^9, 3.733570433451762*^9, 
   3.733614740330405*^9, 3.7336573433066645`*^9, 3.73374619816133*^9, {
   3.73375854901735*^9, 3.7337585923259573`*^9}, 3.733824943402834*^9, 
   3.7340918759099226`*^9, 3.7371586885873365`*^9, 3.737741697721793*^9, 
   3.739019273693836*^9, 3.739802238358158*^9, 3.7398763189028234`*^9, 
   3.739897737596525*^9, 3.739901313692973*^9, 3.739959994252371*^9, 
   3.7402217922989607`*^9, 
   3.740229073677446*^9},ExpressionUUID->"343d4036-b006-434c-a7c2-\
466e9cda3367"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Rubidium Polarization Functions", "Section",
 CellChangeTimes->{{3.732369283149192*^9, 
  3.732369287540785*^9}},ExpressionUUID->"28b19adf-29c5-49ee-9241-\
1cb5f0e4f388"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProcessRbPolarizationFileSequence", "[", 
     RowBox[{"scanFileNames_List", ",", "baselineAngle_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "i", ",", "index", ",", "noPumpFile", ",", "piPumpFile", ",", 
        "sPlusPumpFile", ",", "sMinusPumpFile", ",", "header", ",", " ", 
        "datasetRaw", ",", "datasetZeroLineRemoved", ",", "dataset", ",", 
        "detAndAngle", ",", "a1", ",", "a2", ",", "maxmin", ",", "nlmFit", 
        ",", "replacements", ",", "\[Delta]", ",", "\[Theta]0", ",", "plot", 
        ",", "errors", ",", "fitRangeMin", ",", "fitRangeMax", ",", "n", ",", 
        "nErr", ",", "finalResult", ",", "modelA4", ",", "modelA2", ",", 
        "model", ",", "startPoints", ",", "modelString", ",", "Cpar", ",", 
        "frequencyCutoff", ",", "files", ",", "headers", ",", "rawDatasets", 
        ",", "datasetsCleaned", ",", "datasets", ",", "detAndAngles", ",", 
        "fileNames", ",", "none", ",", "sPlus", ",", "sMinus", ",", 
        "polDataBoth", ",", "detunings", ",", "x", ",", "lm", ",", "polPlot", 
        ",", "dataLine", ",", "slope", ",", "pol", ",", "\[Sigma]Slope", ",", 
        "\[Sigma]Density", ",", "\[Sigma]p", ",", "results", ",", 
        "polDataSPlus", ",", "polDataSMinus", ",", "polData", ",", 
        "polDataLabels", ",", "stringHead", ",", "j", ",", "numberOfFiles"}], 
       "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"numberOfFiles", "=", 
        RowBox[{"Length", "[", "scanFileNames", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"frequencyCutoff", "=", 
        RowBox[{"{", 
         RowBox[{"10", ",", "40"}], "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Cpar", "=", 
        FractionBox[
         RowBox[{"4", "*", "gHzToHz"}], 
         RowBox[{"re", "*", "c", "*", "fge", "*", "cellLength"}]]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"numberOfFiles", "\[Equal]", "4"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"fileNames", "=", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<no\>\"", "->", 
              RowBox[{"scanFileNames", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"\"\<pi\>\"", "->", 
              RowBox[{"scanFileNames", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"\"\<s+\>\"", "->", 
              RowBox[{"scanFileNames", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], ",", 
             RowBox[{"\"\<s-\>\"", "->", 
              RowBox[{"scanFileNames", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}]}], "|>"}]}], ";"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"numberOfFiles", "\[Equal]", "3"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"fileNames", "=", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<no\>\"", "->", 
                RowBox[{"scanFileNames", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", 
               RowBox[{"\"\<s+\>\"", "->", 
                RowBox[{"scanFileNames", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{"\"\<s-\>\"", "->", 
                RowBox[{"scanFileNames", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}]}], "|>"}]}], ";"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"numberOfFiles", "\[Equal]", "2"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"fileNames", "=", 
               RowBox[{"<|", 
                RowBox[{
                 RowBox[{"\"\<no\>\"", "->", 
                  RowBox[{"scanFileNames", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                 RowBox[{"\"\<s+\>\"", "->", 
                  RowBox[{"scanFileNames", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}]}], "|>"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"files", "=", 
        RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"headers", "=", 
        RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rawDatasets", "=", 
        RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"datasetsCleaned", "=", 
        RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"datasets", "=", 
        RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"detAndAngles", "=", 
        RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "fileNames", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"files", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Keys", "[", "fileNames", "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
             RowBox[{"ImportFile", "[", 
              RowBox[{"fileNames", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"headers", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Keys", "[", "files", "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "->", 
             RowBox[{
              RowBox[{"files", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"rawDatasets", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Keys", "[", "files", "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "->", 
             RowBox[{
              RowBox[{"files", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"datasetsCleaned", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Keys", "[", "files", "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
             RowBox[{"CleanDataset", "[", 
              RowBox[{
               RowBox[{"rawDatasets", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<Wavelength\>\"", 
               ",", "\"\<Aout\>\""}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"datasets", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Keys", "[", "files", "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "->", 
             RowBox[{
              RowBox[{
               RowBox[{"datasetsCleaned", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"All", ",", 
                RowBox[{
                 RowBox[{"<|", 
                  RowBox[{"#", ",", 
                   RowBox[{"\"\<DETUNING\>\"", "\[Rule]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"c", "/", "100"}], "/", 
                    RowBox[{"(", "#Wavelength", ")"}]}], "-", 
                    RowBox[{"\[Nu]0", "*", "1*^-9"}]}]}]}], "|>"}], "&"}]}], 
               "]"}], "[", 
              RowBox[{"Select", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", "#DETUNING", "]"}], ">", 
                 RowBox[{"frequencyCutoff", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "&"}], "]"}], "]"}]}]}], 
           " ", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"c", " ", "is", " ", "in", " ", 
            RowBox[{"cm", "/", "s"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"detAndAngles", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Keys", "[", "files", "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
             RowBox[{"Normal", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"datasets", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"All", ",", 
                 RowBox[{
                  RowBox[{"<|", 
                   RowBox[{
                    RowBox[{"\"\<DET\>\"", "\[Rule]", "#DETUNING"}], ",", 
                    RowBox[{"\"\<ANG\>\"", "\[Rule]", 
                    RowBox[{"#angle", "*", 
                    RowBox[{"\[Pi]", "/", "180"}]}]}]}], "|>"}], "&"}]}], 
                "]"}], "[", 
               RowBox[{"All", ",", "Values"}], "]"}], "]"}]}]}], "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"$Assumptions", "=", 
        RowBox[{"a1", ">", "0"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"$Assumptions", "=", 
        RowBox[{"a2", ">", "0"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"none", "=", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"detAndAngles", "[", "\"\<no\>\"", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sPlus", "=", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"detAndAngles", "[", "\"\<s+\>\"", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", 
          RowBox[{"Length", "[", "sPlus", "]"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"sPlus", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "<", "0"}], ",", 
            RowBox[{
             RowBox[{"sPlus", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "=", 
             RowBox[{
              RowBox[{"sPlus", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "+", "\[Pi]"}]}]}], "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"detunings", "=", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"detAndAngles", "[", "\"\<s+\>\"", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"numberOfFiles", "\[Equal]", "2"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"polDataBoth", "=", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "/", "detunings"}], ",", 
              RowBox[{"(", 
               RowBox[{"sPlus", "-", "none"}], ")"}]}], "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"polData", "=", 
           RowBox[{"{", "polDataBoth", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"polDataLabels", "=", 
           RowBox[{"{", "\"\<\>\"", "}"}]}], ";"}], "\[IndentingNewLine]", 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"sMinus", "=", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"detAndAngles", "[", "\"\<s-\>\"", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"polDataBoth", "=", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "/", "detunings"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"sPlus", "-", "sMinus"}], ")"}], "/", "2"}]}], "}"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"polDataSPlus", "=", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "/", "detunings"}], ",", 
              RowBox[{"(", 
               RowBox[{"sPlus", "-", "none"}], ")"}]}], "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"polDataSMinus", "=", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "/", "detunings"}], ",", 
              RowBox[{"(", 
               RowBox[{"sMinus", "-", "none"}], ")"}]}], "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"polData", "=", 
           RowBox[{"{", 
            RowBox[{
            "polDataBoth", ",", "polDataSPlus", ",", "polDataSMinus"}], 
            "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"polDataLabels", "=", 
           RowBox[{"{", 
            RowBox[{"\"\<\>\"", ",", "\"\<s+\>\"", ",", "\"\<s-\>\""}], 
            "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"results", "=", 
        RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", 
          RowBox[{"Length", "[", "polData", "]"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"lm", "=", 
           RowBox[{"LinearModelFit", "[", 
            RowBox[{
             RowBox[{"polData", "[", 
              RowBox[{"[", "j", "]"}], "]"}], ",", "x", ",", "x"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"polPlot", "=", 
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{"lm", "[", "x", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"-", ".15"}], ",", ".15"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"slope", "=", 
           RowBox[{
            RowBox[{"lm", "[", "\"\<BestFitParameters\>\"", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"dataLine", "=", 
           RowBox[{"ProcessFaradayScanFileFromFileName", "[", 
            RowBox[{
             RowBox[{"fileNames", "[", "\"\<no\>\"", "]"}], ",", 
             "baselineAngle"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"n", "=", 
           RowBox[{
            RowBox[{"dataLine", "[", "\"\<n_rb\>\"", "]"}], "*", "1*^12"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"pol", "=", 
           RowBox[{
            RowBox[{"-", "Cpar"}], "*", 
            RowBox[{"slope", "/", "n"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"\[Sigma]Slope", "=", 
           RowBox[{
            RowBox[{"lm", "[", "\"\<ParameterErrors\>\"", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"\[Sigma]Density", "=", 
           RowBox[{
            RowBox[{"dataLine", "[", "\"\<n_rberr\>\"", "]"}], "*", 
            "1*^12"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"\[Sigma]p", "=", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"pol", "^", "2"}], "*", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 FractionBox["\[Sigma]Slope", "slope"], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 FractionBox["\[Sigma]Density", "n"], ")"}], "2"]}], ")"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"plot", "=", 
           RowBox[{"Show", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ListPlot", "[", 
                RowBox[{"polData", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "]"}], ",", "polPlot"}], 
              "}"}], ",", 
             RowBox[{"AxesOrigin", "\[Rule]", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
             RowBox[{"AxesLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<1/Detuning\\n(\!\(\*SuperscriptBox[\(GHz\), \
\(-1\)]\))\>\"", ",", 
                "\"\<\!\(\*FractionBox[\(\*SubscriptBox[\(\[Theta]\), \(\(S\)\
\(+\)\)] - \*SubscriptBox[\(\[Theta]\), \(\(S\)\(-\)\)]\), \(2\)]\)\>\""}], 
               "}"}]}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"stringHead", "=", "\"\<p_rb\>\""}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"results", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"results", ",", "dataLine"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"results", ",", 
            RowBox[{"<|", 
             RowBox[{"\"\<time\>\"", "\[Rule]", 
              RowBox[{"ExtractTimeInfoFromFileNameString", "[", 
               RowBox[{
                RowBox[{"headers", "[", "\"\<no\>\"", "]"}], "[", 
                "\"\<File\>\"", "]"}], "]"}]}], "|>"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"results", ",", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{"stringHead", ",", 
                 RowBox[{"polDataLabels", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "\[Rule]", "pol"}],
               ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{"stringHead", ",", 
                 RowBox[{"polDataLabels", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", "\"\<err\>\""}], "]"}],
                "\[Rule]", "\[Sigma]p"}]}], "|>"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"results", ",", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<n_rb\>\"", "\[Rule]", 
               RowBox[{"n", "/", "1*^12"}]}], ",", 
              RowBox[{"\"\<n_rberr\>\"", "\[Rule]", 
               RowBox[{"\[Sigma]Density", "/", "1*^12"}]}]}], "|>"}]}], "]"}],
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"results", ",", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{"stringHead", ",", 
                 RowBox[{"polDataLabels", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", "\"\<errSlope\>\""}], 
                "]"}], "\[Rule]", 
               RowBox[{"\[Sigma]Slope", "/", "slope"}]}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{"stringHead", ",", 
                 RowBox[{"polDataLabels", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", "\"\<errDens\>\""}], 
                "]"}], "\[Rule]", 
               RowBox[{"\[Sigma]Density", "/", "n"}]}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{"stringHead", ",", 
                 RowBox[{"polDataLabels", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", "\"\<Slope\>\""}], 
                "]"}], "\[Rule]", "slope"}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{"stringHead", ",", 
                 RowBox[{"polDataLabels", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", "\"\<Slopeerr\>\""}], 
                "]"}], "\[Rule]", "\[Sigma]Slope"}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{"stringHead", ",", 
                 RowBox[{"polDataLabels", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", "\"\<plot\>\""}], 
                "]"}], "\[Rule]", "plot"}]}], "|>"}]}], "\[IndentingNewLine]",
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"results", ",", 
         RowBox[{"headers", "[", "\"\<no\>\"", "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OrganizeFscanFilesByCategories", "[", 
     RowBox[{
     "fileNames_", ",", "startFile_", ",", "categories_", ",", "runs_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "allFiles", ",", "j", ",", "i", ",", "listOfNames", ",", "subsetFiles",
         ",", "firstFile", ",", "lastFile", ",", "files"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"allFiles", "=", 
        RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"subsetFiles", "=", 
        RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"files", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "<=", 
          RowBox[{"Length", "[", 
           RowBox[{"categories", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "=", "1"}], ",", 
            RowBox[{"i", "<=", 
             RowBox[{"Length", "[", 
              RowBox[{"categories", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"firstFile", "=", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"startFile", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"i", "-", "1"}], ")"}], "*", "runs"}]}], ")"}], 
               "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"j", "-", "1"}], ")"}], "*", 
                RowBox[{"Length", "[", 
                 RowBox[{"categories", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "*", "runs"}]}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"files", ",", 
               RowBox[{"<|", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Keys", "[", "categories", "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", " ", 
                  RowBox[{
                   RowBox[{"categories", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Keys", "[", "categories", "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "\[Rule]", 
                  RowBox[{
                   RowBox[{"categories", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                 RowBox[{"\"\<fileNames\>\"", "\[Rule]", 
                  RowBox[{"fileNames", "[", 
                   RowBox[{"[", "firstFile", "]"}], "]"}]}]}], "|>"}]}], 
              "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "files"}]}],
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "coefficients", " ", "for", " ", "the", " ", "polynomial", " ",
     "describing", " ", "the", " ", "magnetic", " ", "field", " ", "of", " ", 
    "magnet", " ", 
    RowBox[{"1", " ", "[", 
     RowBox[{
      RowBox[{"(", "c", ")"}], "oefficient", " ", "of", " ", "magent", " ", 
      RowBox[{"(", "1", ")"}]}], "]"}], "  ", "based", " ", "on", " ", "the", 
    " ", 
    RowBox[{"current", ".", "\[IndentingNewLine]", "Assumes"}], " ", "x", " ",
     "is", " ", "measured", " ", "in", " ", "cm"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c1x2", "=", ".085"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c1x1", "=", 
   RowBox[{"-", "1.907"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c1x0", "=", "17.24"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c2x2", "=", "0.153"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c2x1", "=", "1.866"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"c2x0", "=", "15.594"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "coefficients", " ", "for", " ", "the", " ", "linear", " ", 
    "relationship", " ", "between", " ", "the", " ", "current", " ", "and", 
    " ", "the", " ", "voltage", " ", "of", " ", "the", " ", "magnets"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c1v2iSlope", "=", ".0504"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c1v2iInt", "=", 
   RowBox[{"-", ".0113"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c2v2iSlope", "=", ".0488"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"c2v2iInt", "=", 
    RowBox[{"-", ".0069"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Calculate", " ", "the", " ", "current", " ", "in", " ", "each", " ", "of",
     " ", "the", " ", "magnets", " ", "based", " ", "on", " ", "the", " ", 
    "voltage"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"i1", "[", "voltage_", "]"}], ":=", 
   RowBox[{
    RowBox[{"voltage", "*", "c1v2iSlope"}], "+", "c1v2iInt"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"i2", "[", "voltage_", "]"}], ":=", 
    RowBox[{
     RowBox[{"voltage", "*", "c2v2iSlope"}], "+", "c2v2iInt"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CalculateIntegratedMagneticField", "[", 
     RowBox[{"voltageMagnet1_", ",", "voltageMagnet2_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "x", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Integrates", " ", "the", " ", "value", " ", "of", " ", "the", " ", 
        "magnetic", " ", "field", " ", "over", " ", "the", " ", "length", " ",
         "of", " ", "the", " ", 
        RowBox[{"cell", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{"getBEq", "[", 
         RowBox[{
          RowBox[{"i1", "[", "voltageMagnet1", "]"}], ",", 
          RowBox[{"i2", "[", "voltageMagnet2", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"cellPos", ",", "0", ",", "cellLength"}], "}"}]}], "]"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"/", "100"}], "/", "10000"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
         "Divide", " ", "by", " ", "100", " ", "to", " ", "convert", " ", 
          "to", " ", "Gauss", "*", "meters"}], ",", " ", 
         RowBox[{
         "Divide", " ", "by", " ", "10000", " ", "to", " ", "convert", " ", 
          "to", " ", "Tesla", "*", "meters"}]}]}]}], "*)"}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getBEq", "[", 
     RowBox[{"i1_", ",", "i2_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", "c1x2", " ", ")"}], "i1"}], " ", "+", 
        RowBox[{
         RowBox[{"(", "c2x2", ")"}], "i2"}]}], ")"}], " ", 
      SuperscriptBox["cellPos", "2"]}], " ", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", "c1x1", " ", ")"}], "i1"}], " ", "+", 
        RowBox[{
         RowBox[{"(", "c2x1", ")"}], "i2"}]}], ")"}], " ", "cellPos"}], " ", 
     "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", "c1x0", " ", ")"}], "i1"}], " ", "+", 
       RowBox[{
        RowBox[{"(", "c2x0", ")"}], "i2"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
    "ExtractTimeInfoFromFileNameString", "[", "fileNameString_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "lastChars", ",", "date", ",", "year", ",", "month", ",", "day", ",", 
        "hour", ",", "min", ",", "sec", ",", "do"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"lastChars", "=", 
        RowBox[{"StringTake", "[", 
         RowBox[{"fileNameString", ",", 
          RowBox[{"-", "21"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"date", "=", 
        RowBox[{"StringTake", "[", 
         RowBox[{"lastChars", ",", "17"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"year", "=", 
        RowBox[{"StringTake", "[", 
         RowBox[{"date", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "4"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"month", "=", 
        RowBox[{"StringTake", "[", 
         RowBox[{"date", ",", 
          RowBox[{"{", 
           RowBox[{"6", ",", "7"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"day", "=", 
        RowBox[{"StringTake", "[", 
         RowBox[{"date", ",", 
          RowBox[{"{", 
           RowBox[{"9", ",", "10"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"hour", "=", 
        RowBox[{"StringTake", "[", 
         RowBox[{"date", ",", 
          RowBox[{"{", 
           RowBox[{"12", ",", "13"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"min", "=", 
        RowBox[{"StringTake", "[", 
         RowBox[{"date", ",", 
          RowBox[{"{", 
           RowBox[{"14", ",", "15"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sec", "=", 
        RowBox[{"StringTake", "[", 
         RowBox[{"date", ",", 
          RowBox[{"{", 
           RowBox[{"16", ",", "17"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"do", "=", 
        RowBox[{"DateObject", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Interpreter", "[", "\"\<Number\>\"", "]"}], "[", "year", 
            "]"}], ",", 
           RowBox[{
            RowBox[{"Interpreter", "[", "\"\<Number\>\"", "]"}], "[", "month",
             "]"}], ",", 
           RowBox[{
            RowBox[{"Interpreter", "[", "\"\<Number\>\"", "]"}], "[", "day", 
            "]"}], ",", 
           RowBox[{
            RowBox[{"Interpreter", "[", "\"\<Number\>\"", "]"}], "[", "hour", 
            "]"}], ",", 
           RowBox[{
            RowBox[{"Interpreter", "[", "\"\<Number\>\"", "]"}], "[", "min", 
            "]"}], ",", 
           RowBox[{
            RowBox[{"Interpreter", "[", "\"\<Number\>\"", "]"}], "[", "sec", 
            "]"}]}], "}"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ApproximateFrequency", "[", 
     RowBox[{
     "data_", ",", "columnMissing_", ",", "columnReference_", ",", 
      "missingEntry_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "j", ",", "adjacentSpots", ",", "referenceSpacing", ",", 
        "validEntries", ",", "fit"}], "}"}], 
      RowBox[{"(*", 
       RowBox[{
       "These", " ", "are", " ", "your", " ", "local", " ", "variables", " ", 
        "that", " ", 
        RowBox[{"aren", "'"}], "t", " ", "stored", " ", "beyond", " ", "the", 
        " ", "scope", " ", "of", " ", "the", " ", 
        RowBox[{"module", "."}]}], "*)"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Selects", " ", "the", " ", "data", " ", "that", " ", "is", " ", 
        "certainly", " ", "an", " ", "appropriate", " ", "measure", " ", "of",
         " ", "wavelength"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"adjacentSpots", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"validEntries", "=", 
        RowBox[{
         RowBox[{"data", "[", 
          RowBox[{"All", ",", 
           RowBox[{"{", 
            RowBox[{"columnReference", ",", "columnMissing"}], "}"}]}], "]"}],
          "[", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"#Wavelength", ">", "793"}], "&"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "The", " ", "\"\<reference column\>\"", " ", "is", " ", "the", " ", 
          "column", " ", "that", " ", "is", " ", "monotonically", " ", 
          "increasing"}], ",", " ", 
         RowBox[{
         "we", " ", "need", " ", "to", " ", "know", " ", "what", " ", "the", 
          " ", "size", " ", "of", " ", "spaces", " ", "between", " ", "these",
           " ", "values", " ", "is"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"referenceSpacing", "=", "2"}], ";", "\[IndentingNewLine]", 
       RowBox[{"j", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "This", " ", "\"\<While\>\"", " ", "loop", " ", "accumulates", " ", 
          "adjacent", " ", "data", " ", "points", " ", "used", " ", "to", " ",
           "approximate", " ", "the", " ", "missing", " ", "frequency"}], ",",
          " ", 
         RowBox[{
         "we", " ", "only", " ", "want", " ", "the", " ", "closest", " ", 
          RowBox[{"datapoints", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "adjacentSpots", "]"}], "<", "3"}], ",", 
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"j", "*", "referenceSpacing"}], "]"}], "<", "117"}]}], 
          "]"}], 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "We", " ", "want", " ", "a", " ", "few", " ", "data", " ", 
            "points", " ", "to", " ", "approximate", " ", "where", " ", "our",
             " ", "point", " ", "lies"}], ",", " ", 
           RowBox[{
           "keep", " ", "going", " ", "until", " ", "we", " ", "have", " ", 
            "at", " ", "least", " ", "3"}]}], "*)"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"adjacentSpots", "=", 
           RowBox[{"validEntries", "[", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{
                 RowBox[{"#", "[", "columnReference", "]"}], "-", 
                 "missingEntry"}], "]"}], "\[LessEqual]", 
               RowBox[{"referenceSpacing", "*", "j"}]}], "&"}], "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"j", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fit", "=", 
        RowBox[{"LinearModelFit", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"adjacentSpots", "[", "Values", "]"}], "]"}], ",", "x", 
          ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fit", "[", "missingEntry", "]"}]}]}], " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Last", " ", "line", " ", "is", " ", "the", " ", "\"\<return\>\"", " ",
         "statement"}], ",", " ", 
       RowBox[{
        RowBox[{
        "all", " ", "other", " ", "lines", " ", "need", " ", "a", " ", 
         "semi"}], "-", "colon"}]}], "*)"}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "is", " ", "called", " ", "on", " ", "a", " ", "dataset", " ",
     "to", " ", "fill", " ", "in", " ", "all", " ", "of", " ", "the", " ", 
    "missing", " ", "frequency", " ", 
    RowBox[{"gaps", "."}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FillInMissedFrequencies", "[", 
     RowBox[{"rawdata_", ",", "columnMissing_", ",", "columnReference_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "referenceSpacing", ",", "missingEntries", ",", "validEntries", ",", 
        "adjacentSpots", ",", "estimatedFrequency", ",", "linearModel", ",", 
        "dataCopy", ",", "dataReturn", ",", "position", ",", "approxValue", 
        ",", "data2", ",", "k"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dataCopy", "=", 
        RowBox[{"Dataset", "[", "rawdata", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dataReturn", "=", 
        RowBox[{"Normal", "[", "dataCopy", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"missingEntries", "=", 
        RowBox[{"dataCopy", "[", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", "columnMissing", "]"}], "<", "793"}], "&"}], 
          "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"missingEntries", "=", 
        RowBox[{"Normal", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"missingEntries", "[", 
            RowBox[{"All", ",", 
             RowBox[{"{", "columnReference", "}"}]}], "]"}], "[", "Values", 
           "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"k", "=", "1"}], ",", 
         RowBox[{"k", "<=", 
          RowBox[{"Length", "[", "missingEntries", "]"}]}], ",", 
         RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"approxValue", "=", 
           RowBox[{"ApproximateFrequency", "[", 
            RowBox[{
            "dataCopy", ",", "columnMissing", ",", "columnReference", ",", 
             RowBox[{"missingEntries", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Find", " ", "the", " ", "index", " ", "of", " ", "the", " ", 
            "missing", " ", "value", " ", "in", " ", "the", " ", "list"}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"position", "=", 
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"dataCopy", ",", 
              RowBox[{"missingEntries", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Use", " ", "the", " ", "index", " ", "to", " ", "insert", " ", 
            "the", " ", "approximate", " ", "value", " ", "in", " ", "the", 
            " ", "data"}], "  ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"dataReturn", "[", 
            RowBox[{"[", 
             RowBox[{"position", ",", "columnMissing"}], "]"}], "]"}], "=", 
           "approxValue"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "dataReturn"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CleanDataset", "[", 
    RowBox[{"dataset_", ",", "missingColumn_", ",", "referenceColumn_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", ",", "d2", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d", "=", 
       RowBox[{"FillInMissedFrequencies", "[", 
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"dataset", "[", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"referenceColumn", ",", "missingColumn"}], "}"}]}], 
           "]"}], "]"}], ",", "missingColumn", ",", "referenceColumn"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d2", "=", 
       RowBox[{"Normal", "[", "dataset", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "d2", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{
          RowBox[{"d2", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"\"\<Wavelength\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"d", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<Wavelength\>\"", 
            "]"}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Dataset", "[", "d2", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7310823275240283`*^9, 3.7310823582641582`*^9}, {
   3.7310829720084667`*^9, 3.731082995978743*^9}, {3.7310835616403112`*^9, 
   3.7310836068306847`*^9}, {3.7310836612404156`*^9, 
   3.7310836627873898`*^9}, {3.731083814218954*^9, 3.7310838172504005`*^9}, {
   3.7310882846043243`*^9, 3.7310883159657097`*^9}, {3.731147210851451*^9, 
   3.731147218570695*^9}, {3.7311472515728073`*^9, 3.731147266026865*^9}, {
   3.731147311264127*^9, 3.731147311842289*^9}, {3.7311474106154037`*^9, 
   3.731147416803299*^9}, {3.7311475491789474`*^9, 3.7311475567888093`*^9}, {
   3.7311475944318438`*^9, 3.7311476141049776`*^9}, {3.7311477318468866`*^9, 
   3.7311477565828447`*^9}, {3.731147857464301*^9, 3.7311478592144117`*^9}, {
   3.7311480506008615`*^9, 3.7311480508977556`*^9}, {3.73114813428279*^9, 
   3.731148134610931*^9}, {3.731148167144263*^9, 3.7311481700194473`*^9}, {
   3.7311482216165*^9, 3.7311482247885766`*^9}, {3.731148304653062*^9, 
   3.731148305028086*^9}, {3.731148969765151*^9, 3.7311489770781493`*^9}, {
   3.7311490438102765`*^9, 3.731149046247932*^9}, {3.732365079778699*^9, 
   3.732365104965073*^9}, {3.7323779792545757`*^9, 3.7323779795296392`*^9}, {
   3.732460578493428*^9, 3.7324606031980925`*^9}, {3.732460855489483*^9, 
   3.7324608610072317`*^9}, {3.7324609455516653`*^9, 3.7324609661586637`*^9}, 
   3.7334097358650427`*^9, {3.7334102336629753`*^9, 3.7334102479295244`*^9}, {
   3.733410283139342*^9, 3.7334102863583007`*^9}, {3.7334103267671747`*^9, 
   3.7334103322987823`*^9}, {3.733410415007275*^9, 3.73341043489919*^9}, {
   3.733410479214567*^9, 3.733410489387102*^9}, {3.7334105383121524`*^9, 
   3.7334105437656317`*^9}, {3.733410590096763*^9, 3.7334105992223587`*^9}, {
   3.733418647641194*^9, 3.733418660485779*^9}, {3.733418794213207*^9, 
   3.7334187945257263`*^9}, {3.733570706526499*^9, 3.733570815455063*^9}, {
   3.7335708492118816`*^9, 3.733570895665653*^9}, 3.733615047358242*^9, {
   3.733615617039822*^9, 3.733615617772805*^9}, {3.733615713060335*^9, 
   3.733615762113673*^9}, 3.733615796644326*^9, {3.733615898220787*^9, 
   3.733615906626625*^9}, {3.733615955174157*^9, 3.7336159678157797`*^9}, {
   3.7336159986574097`*^9, 3.733616007953849*^9}, {3.733616080898119*^9, 
   3.733616081201364*^9}, {3.733616310576796*^9, 3.733616311035224*^9}, {
   3.733618558205306*^9, 3.733618618300644*^9}, {3.733618655036277*^9, 
   3.7336186806230183`*^9}, {3.733618767485647*^9, 3.73361877465172*^9}, {
   3.733618892363029*^9, 3.7336189359767933`*^9}, {3.733618974304122*^9, 
   3.7336189783854523`*^9}, {3.733619162436542*^9, 3.733619204519621*^9}, {
   3.733619247401596*^9, 3.733619247898457*^9}, {3.7336196954284487`*^9, 
   3.733619702677042*^9}, 3.733619764405149*^9, {3.733619853729857*^9, 
   3.733619877497184*^9}, {3.733619961056018*^9, 3.7336200124137697`*^9}, {
   3.733620071726095*^9, 3.73362025675483*^9}, {3.7336585615350165`*^9, 
   3.733658793842774*^9}, {3.7336588242272882`*^9, 3.7336588269803295`*^9}, 
   3.733659310456359*^9, {3.7336593685503235`*^9, 3.7336594279105864`*^9}, {
   3.7336594594647837`*^9, 3.7336595342964387`*^9}, {3.7336596663404646`*^9, 
   3.733659684326425*^9}, {3.733659784997636*^9, 3.7336597926762085`*^9}, {
   3.7336598436069775`*^9, 3.733659863095318*^9}, {3.73365995434402*^9, 
   3.7336599549823008`*^9}, {3.73366055754768*^9, 3.733660557818819*^9}, {
   3.7336606112461205`*^9, 3.733660612301577*^9}, {3.7338270883035316`*^9, 
   3.7338270889104385`*^9}, {3.7340925219124193`*^9, 3.734092539466321*^9}, {
   3.7340926161537895`*^9, 3.7340926252580347`*^9}, {3.7341014213239903`*^9, 
   3.7341014230584993`*^9}, {3.734101635087863*^9, 3.734101712421011*^9}, {
   3.7341018701340437`*^9, 3.7341018715560017`*^9}, {3.7341019110114174`*^9, 
   3.734101916417984*^9}, {3.739026425240021*^9, 3.739026429255889*^9}, {
   3.7399004757359986`*^9, 
   3.7399004903439617`*^9}},ExpressionUUID->"81f57f58-14cc-49ad-9ae8-\
edf2787a670a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Rubidium Number Density Functions", "Section",
 CellChangeTimes->{{3.7341013966661463`*^9, 
  3.734101403041576*^9}},ExpressionUUID->"ba54492e-d9cf-4ba6-886b-\
5339943d2580"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProcessFaradayScanFileFromFileName", "[", 
     RowBox[{"fileName_", ",", "baselineAngle_", ",", 
      RowBox[{"singleCutoff_:", " ", "12"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "cutoffs", ",", "i", ",", "index", ",", "file", ",", "header", ",", 
        " ", "datasetRaw", ",", "datasetZeroLineRemoved", ",", "dataset", ",",
         "datasetNeg", ",", "datasetPos", ",", "detAndAngle", ",", "a1", ",", 
        "a2", ",", "maxmin", ",", "nlmFit", ",", "replacements", ",", 
        "\[Delta]", ",", "\[Theta]0", ",", "plot", ",", "errors", ",", 
        "fitRangeMin", ",", "fitRangeMax", ",", "n", ",", "nErr", ",", 
        "finalResult", ",", "modelA4", ",", "modelA2", ",", "model", ",", 
        "startPoints", ",", "modelString", ",", "results", ",", "n1pt", ",", 
        "det", ",", "angle", ",", "alldata"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"file", "=", 
        RowBox[{"ImportFile", "[", "fileName", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"header", "=", 
        RowBox[{"file", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"datasetRaw", "=", 
        RowBox[{"file", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"datasetZeroLineRemoved", "=", 
        RowBox[{"datasetRaw", "[", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"#Wavelength", ">", "793"}], "&"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dataset", "=", 
        RowBox[{"datasetZeroLineRemoved", "[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"<|", 
            RowBox[{"#", ",", 
             RowBox[{"\"\<DETUNING\>\"", "\[Rule]", 
              RowBox[{
               RowBox[{
                RowBox[{"c", "/", "100"}], "/", 
                RowBox[{"(", "#Wavelength", ")"}]}], "-", 
               RowBox[{"\[Nu]0", "*", "1*^-9"}]}]}]}], "|>"}], "&"}]}], 
         "]"}]}], " ", ";", 
       RowBox[{"(*", " ", 
        RowBox[{"c", " ", "is", " ", "in", " ", 
         RowBox[{"cm", "/", "s"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"detAndAngle", "=", 
        RowBox[{"dataset", "[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<DET\>\"", "\[Rule]", "#DETUNING"}], ",", 
             RowBox[{"\"\<ANG\>\"", "\[Rule]", 
              RowBox[{"#angle", "*", 
               RowBox[{"\[Pi]", "/", "180"}]}]}]}], "|>"}], "&"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"$Assumptions", "=", 
        RowBox[{"a1", ">", "0"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"$Assumptions", "=", 
        RowBox[{"a2", ">", "0"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"singleCutoff", "=", "12"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"cutoffs", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "singleCutoff"}], ",", "singleCutoff"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"alldata", "=", 
        RowBox[{"Normal", "[", 
         RowBox[{"detAndAngle", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "Values"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"datasetNeg", "=", 
        RowBox[{"Normal", "[", 
         RowBox[{
          RowBox[{"detAndAngle", "[", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"#DET", "<", 
              RowBox[{"cutoffs", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "&"}], "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "Values"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"datasetPos", "=", 
        RowBox[{"Normal", "[", 
         RowBox[{
          RowBox[{"detAndAngle", "[", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"#DET", ">", 
              RowBox[{"cutoffs", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "&"}], "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "Values"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dataset", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"datasetPos", ",", "datasetNeg"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"det", "=", 
        RowBox[{
         RowBox[{"Transpose", "[", "dataset", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"angle", "=", 
        RowBox[{
         RowBox[{"Transpose", "[", "dataset", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Takes", " ", "the", " ", "Maximum", " ", "and", " ", "minimum", " ", 
         "from", " ", "the", " ", "2", "nd", " ", "column", " ", "of", " ", 
         "the", " ", "dataset"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"maxmin", "=", 
        RowBox[{"MinMax", "[", "angle", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"modelA4", "=", 
        RowBox[{
         FractionBox["a1", 
          SuperscriptBox[
           RowBox[{"(", "\[Delta]", ")"}], "2"]], "+", 
         FractionBox["a2", 
          SuperscriptBox[
           RowBox[{"(", "\[Delta]", ")"}], "4"]], "+", "\[Theta]0"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"modelA2", "=", 
        RowBox[{
         FractionBox["a1", 
          SuperscriptBox[
           RowBox[{"(", "\[Delta]", ")"}], "2"]], "+", "\[Theta]0"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"model", "=", 
          RowBox[{"{", 
           RowBox[{"modelA4", ",", 
            RowBox[{"a1", ">", "0"}], ",", 
            RowBox[{"a2", ">", "0"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"startPoints", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a1", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"a2", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]0", ",", "0"}], "}"}]}], "}"}]}], ";"}], 
        "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"model", "=", 
        RowBox[{"{", 
         RowBox[{"modelA2", ",", 
          RowBox[{"a1", ">", "0"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "modelString", "=", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(A\), \(1\)], SuperscriptBox[\((\
\[Delta])\), \(2\)]]\)+\!\(\*FractionBox[SubscriptBox[\(A\), \(2\)], \
SuperscriptBox[\((\[Delta])\), \(4\)]]\)+\!\(\*SubscriptBox[\(\[Theta]\), \(o\
\)]\)\>\""}], ";", "\[IndentingNewLine]", 
       RowBox[{"startPoints", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a1", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]0", ",", "0"}], "}"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"nlmFit", " ", "=", 
        RowBox[{"NonlinearModelFit", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "dataset", "]"}], ",", "model", ",", 
          "startPoints", ",", "\[Delta]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"replacements", "=", 
        RowBox[{"nlmFit", "[", "\"\<BestFitParameters\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fitRangeMin", "=", 
        RowBox[{"-", "40"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fitRangeMax", "=", "40"}], ";", "\[IndentingNewLine]", 
       RowBox[{"plot", "=", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"Legended", "[", 
           RowBox[{
            RowBox[{"Evaluate", "[", 
             RowBox[{"model", 
              RowBox[{"(*", 
               RowBox[{"/.", 
                RowBox[{"(", 
                 RowBox[{"\[Theta]0", "\[Rule]", "baselineAngle"}], ")"}]}], 
               "*)"}], "/.", "replacements"}], "]"}], ",", "modelString"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Delta]", ",", "fitRangeMin", ",", "fitRangeMax"}], 
           "}"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Automatic", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"maxmin", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "-", ".02"}], ",", 
               RowBox[{
                RowBox[{"maxmin", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "+", ".02"}]}], "}"}]}], 
            "}"}]}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"colorBlindPallete", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"errors", "=", 
        RowBox[{"nlmFit", "[", "\"\<ParameterErrors\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"a1", "/.", "replacements"}], ")"}], "*", " ", 
         RowBox[{"nDensC", "/", 
          RowBox[{"CalculateIntegratedMagneticField", "[", 
           RowBox[{
            RowBox[{"header", "[", "\"\<magnet1Voltage(V)\>\"", "]"}], ",", 
            RowBox[{"header", "[", "\"\<magnet2Voltage(V)\>\"", "]"}]}], 
           "]"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"n1pt", "=", 
        RowBox[{"NumberDensityFromOneMeasurement", "[", 
         RowBox[{
          RowBox[{"angle", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], ",", "baselineAngle", ",", 
          RowBox[{"det", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], ",", 
          RowBox[{"header", "[", "\"\<magnet1Voltage(V)\>\"", "]"}], ",", 
          RowBox[{"header", "[", "\"\<magnet2Voltage(V)\>\"", "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"errors", "=", 
        RowBox[{"nlmFit", "[", "\"\<ParameterErrors\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nErr", "=", 
        RowBox[{
         RowBox[{"errors", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "*", 
         RowBox[{"nDensC", "/", 
          RowBox[{"CalculateIntegratedMagneticField", "[", 
           RowBox[{
            RowBox[{"header", "[", "\"\<magnet1Voltage(V)\>\"", "]"}], ",", 
            RowBox[{"header", "[", "\"\<magnet2Voltage(V)\>\"", "]"}]}], 
           "]"}]}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"finalResult", "=", 
        RowBox[{"Show", "[", 
         RowBox[{"plot", ",", 
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Legended", "[", 
               RowBox[{
                RowBox[{"Normal", "[", "dataset", "]"}], ",", 
                "\"\<Fitted Data Points\>\""}], "]"}], ",", 
              RowBox[{"Legended", "[", 
               RowBox[{
                RowBox[{"Normal", "[", "alldata", "]"}], ",", 
                "\"\<All Data Points\>\""}], "]"}]}], "}"}], ",", 
            RowBox[{"PlotMarkers", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Graphics", "[", 
                  RowBox[{"Disk", "[", "]"}], "]"}], ",", ".05"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Graphics", "[", 
                  RowBox[{"Circle", "[", "]"}], "]"}], ",", ".05"}], "}"}]}], 
              "}"}]}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"colorBlindPallete", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
            RowBox[{"BaseStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"FontSize", "\[Rule]", "24"}], ",", 
               RowBox[{"PointSize", "[", "Large", "]"}]}], "}"}]}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
            RowBox[{"GridLines", "\[Rule]", "Automatic"}]}], "]"}], 
          RowBox[{"(*", 
           RowBox[{",", 
            RowBox[{"Epilog", "\[Rule]", 
             RowBox[{"Inset", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"n", ",", "14"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"20", ",", ".025"}], "}"}]}], "]"}]}]}], "*)"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Detuning\\n(GHz)\>\"", ",", 
             "\"\<Plane of Polarization (rad)\>\""}], "}"}]}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"results", "=", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<n_rb\>\"", "\[Rule]", 
           RowBox[{"n", "/", "1*^12"}]}], ",", 
          RowBox[{"\"\<n_rberr\>\"", "\[Rule]", 
           RowBox[{"nErr", "/", "1*^12"}]}], ",", 
          RowBox[{"\"\<n1pt\>\"", "\[Rule]", 
           RowBox[{"n1pt", "/", "1*^12"}]}], ",", 
          RowBox[{
          "\"\<measuredTheta_0\>\"", "\[Rule]", " ", "baselineAngle"}], ",", 
          RowBox[{
           RowBox[{"\"\<calcTheta_0\>\"", "\[Rule]", "\[Theta]0"}], "/.", 
           "replacements"}], ",", 
          RowBox[{"\"\<n_rbplot\>\"", "\[Rule]", " ", "finalResult"}], ",", 
          RowBox[{"\"\<n_rbdataset\>\"", "\[Rule]", "dataset"}], ",", 
          RowBox[{"\"\<time\>\"", "\[Rule]", 
           RowBox[{"ExtractTimeInfoFromFileNameString", "[", 
            RowBox[{"header", "[", "\"\<File\>\"", "]"}], "]"}]}]}], "|>"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"results", ",", "header"}], "]"}]}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CalculateNumberDensity", "[", 
     RowBox[{"fitParameter_", ",", "integratedMagneticField_"}], "]"}], ":=", 
    RowBox[{"nDensC", "*", 
     FractionBox["fitParameter", "integratedMagneticField"]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "detuning", " ", "should", " ", "be", " ", "input", " ", "as", 
    " ", "GHz", "\[IndentingNewLine]", "The", " ", "angle", " ", "should", 
    " ", "be", " ", "input", " ", "as", " ", "radians"}], 
   "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
    "CalculateA2FittingParameter", "[", "faradayRotationOrderedPairs_", "]"}],
     ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "startPoints", ",", "nlmFit", ",", "fitParam", ",", "a0", ",", "a2", 
        ",", "a4"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"startPoints", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a2", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a4", ",", "1"}], "}"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"$Assumptions", "=", 
        RowBox[{"a2", ">", "0"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"$Assumptions", "=", 
        RowBox[{"a4", ">", "0"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nlmFit", " ", "=", 
        RowBox[{"NonlinearModelFit", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "faradayRotationOrderedPairs", "]"}], ",", 
          RowBox[{"a0", "+", 
           FractionBox[
            RowBox[{"a2", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Delta]", "*", "1*^9"}], "+", "\[Nu]0"}], ")"}], 
              "2"]}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"\[Delta]", "*", "1*^9"}], ")"}], "2"]], "+", 
           FractionBox[
            RowBox[{"a4", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Delta]", "*", "1*^9"}], "+", "\[Nu]0"}], ")"}], 
              "2"]}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"\[Delta]", "*", "1*^9"}], ")"}], "4"]]}], ",", 
          "startPoints", ",", "\[Delta]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fitParam", "=", 
        RowBox[{"nlmFit", "[", "\"\<BestFitParameters\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"a2", "/.", "fitParam"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NumberDensityFromOneMeasurement", "[", 
    RowBox[{
    "rotatedAngle_", ",", "baselineAngle_", ",", "detuning_", ",", 
     "voltage1_", ",", "voltage2_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Angle", " ", "should", " ", "be", " ", "input", " ", "in", " ", 
     "radians"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"rotatedAngle", "-", "baselineAngle"}], ")"}], "*", "2", "*", 
      "h", "*", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"detuning", "*", "gHzToHz"}], ")"}], "2"]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"\[Mu]", "*", "re", "*", "fge", "*", "c", "*", "k", "*", 
      RowBox[{"CalculateIntegratedMagneticField", "[", 
       RowBox[{"voltage1", ",", "voltage2"}], "]"}]}], " ", ")"}]}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7341015755058756`*^9, 3.7341015829438763`*^9}, {
   3.734102285550049*^9, 3.734102290816038*^9}, {3.7341023281153154`*^9, 
   3.7341023308342586`*^9}, {3.7341027552816563`*^9, 
   3.7341027556165185`*^9}, {3.7341040175072494`*^9, 
   3.7341040796198654`*^9}, {3.734105358908472*^9, 3.734105370096698*^9}, {
   3.734105802484187*^9, 3.7341058321892176`*^9}, {3.7341058653788967`*^9, 
   3.7341058700510716`*^9}, {3.7341059174447727`*^9, 
   3.7341059225232058`*^9}, {3.7341059677605157`*^9, 3.734105971526399*^9}, {
   3.7341064910105658`*^9, 3.734106494995199*^9}, {3.73410657548482*^9, 
   3.734106608674452*^9}, {3.734108706502904*^9, 3.734108764350387*^9}, {
   3.7341087980088243`*^9, 3.734108844152464*^9}, {3.7341088950151386`*^9, 
   3.7341089004373474`*^9}, {3.7341089422525573`*^9, 
   3.7341089424400725`*^9}, {3.7371588571922703`*^9, 
   3.7371588580204406`*^9}, {3.737159043892692*^9, 3.7371590452677755`*^9}, {
   3.7371590917394285`*^9, 3.73715909434897*^9}, {3.737159214751746*^9, 
   3.737159215939316*^9}, {3.7377420534151587`*^9, 3.7377420565644565`*^9}, {
   3.737742226693736*^9, 3.737742227862152*^9}, {3.737742266492179*^9, 
   3.737742281670021*^9}, {3.7377423383911967`*^9, 3.7377423393178806`*^9}, {
   3.7377424234954*^9, 3.7377424546143847`*^9}, {3.737742502040307*^9, 
   3.7377425031101637`*^9}, {3.7377425619121056`*^9, 3.737742562246727*^9}, {
   3.73774260795951*^9, 3.7377426332383432`*^9}, {3.7377443766949987`*^9, 
   3.7377444398784657`*^9}, {3.737744501000247*^9, 3.7377445021031656`*^9}, {
   3.737744555799115*^9, 3.7377445733993063`*^9}, {3.737744640632331*^9, 
   3.7377446437834144`*^9}, {3.737744703805752*^9, 3.7377447063272476`*^9}, {
   3.737744752088914*^9, 3.737744755143086*^9}, {3.737745502113989*^9, 
   3.737745510364283*^9}, {3.737745556127555*^9, 3.7377455897412915`*^9}, 
   3.7377456369560833`*^9, {3.7377456893882074`*^9, 3.7377457062839184`*^9}, {
   3.737745742381807*^9, 3.737745745406161*^9}, {3.7377457899341784`*^9, 
   3.7377457953891015`*^9}, {3.737746312224172*^9, 3.7377463597910852`*^9}, {
   3.739019624028721*^9, 3.739019656030856*^9}, {3.7390196898143587`*^9, 
   3.7390197130815353`*^9}, 3.7390197478963585`*^9, 3.7399005195058517`*^9, {
   3.7433372843240604`*^9, 
   3.7433372869545393`*^9}},ExpressionUUID->"ba38586e-2232-4d9c-b041-\
fcf42d7bcf4d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Excitation Function Functions", "Section",
 CellChangeTimes->{{3.73236931437856*^9, 
  3.732369320126596*^9}},ExpressionUUID->"eb5f1899-b825-43da-9ba0-\
ef66f79c9eb9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"StackedExFnPlot", "[", "fileName_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"fd", " ", 
       RowBox[{"(*", "fileDataset", "*)"}], ",", "\[IndentingNewLine]", "fh", 
       RowBox[{"(*", "fileHeaderInfo", "*)"}], ",", "\[IndentingNewLine]", 
       "scale", 
       RowBox[{"(*", 
        RowBox[{
        "the", " ", "magnitude", " ", "of", " ", "the", " ", "faraday", " ", 
         "cup", " ", "current"}], " ", "*)"}], ",", "\[IndentingNewLine]", 
       "temp", 
       RowBox[{"(*", 
        RowBox[{
        "The", " ", "temperature", " ", "of", " ", "the", " ", "reservoir", 
         " ", 
         RowBox[{"(", 
          RowBox[{"mislabeled", " ", "as", " ", "the", " ", "target"}], 
          ")"}]}], "*)"}], ",", "\[IndentingNewLine]", "pN2", 
       RowBox[{"(*", 
        RowBox[{
        "The", " ", "pressure", " ", "on", " ", "the", " ", "collision", " ", 
         "cell", " ", "convectron", " ", "gauge"}], "*)"}], ",", 
       "\[IndentingNewLine]", "data1", ",", "data2", ",", 
       "\[IndentingNewLine]", "totHe", ",", "counts", ",", "curr", ",", 
       "\[IndentingNewLine]", "paddingx", ",", "paddingy", ",", "padding", 
       ",", " ", "options", ",", " ", "spacing", ",", "\[IndentingNewLine]", 
       "countsAndCurrent"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fd", "=", 
       RowBox[{"GetFileDataset", "[", "fileName", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fh", "=", 
       RowBox[{"GetFileHeaderInfo", "[", "fileName", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"scale", "=", 
       RowBox[{"fh", "[", "\"\<MagnitudeOfCurrent(*10^-X)\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"temp", "=", 
       RowBox[{"fh", "[", "\"\<CellTemp(Targ)\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pN2", "=", 
       RowBox[{"fh", "[", "\"\<CVGauge(N2)(Torr)\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"data1", "=", 
       RowBox[{"fd", "[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<TotalHeOffset\>\"", ",", "\"\<CountRate\>\""}], 
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"totHe", ",", "counts"}], "}"}], "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"Normal", "[", 
         RowBox[{"data1", "[", "Values", "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"data1", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"totHe", "*", 
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}]}], ",", "counts"}], "}"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"data2", "=", 
       RowBox[{"fd", "[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<TotalHeOffset\>\"", ",", "\"\<Current\>\""}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"totHe", ",", "curr"}], "}"}], "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"Normal", "[", 
         RowBox[{"data2", "[", "Values", "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"data2", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"totHe", "*", 
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}]}], ",", 
          RowBox[{"curr", "*", 
           RowBox[{
            RowBox[{"10", "^", 
             RowBox[{"-", "scale"}]}], "/", "nA"}]}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"paddingx", "=", "120"}], ";", "\[IndentingNewLine]", 
      RowBox[{"paddingy", "=", "100"}], ";", "\[IndentingNewLine]", 
      RowBox[{"padding", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"paddingx", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"paddingy", ",", "30"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"options", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ImagePadding", "\[Rule]", "padding"}], ",", 
         RowBox[{"Frame", "\[Rule]", "True"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"spacing", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "150"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"GraphicsGrid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Show", "[", 
            RowBox[{
             RowBox[{"ListLogPlot", "[", 
              RowBox[{"data1", ",", 
               RowBox[{"FrameTicks", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"None", ",", "Automatic"}], "}"}]}], ",", "options", 
               ",", 
               RowBox[{"FrameLabel", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"None", ",", "\"\<Count Rate (Hz)\>\""}], "}"}]}], 
               ",", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Automatic", ",", 
                  RowBox[{"{", 
                   RowBox[{"50", ",", "5500"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"GridLines", "\[Rule]", "Automatic"}]}], "]"}], ",", 
             RowBox[{"Graphics", "[", 
              RowBox[{
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"\"\<temp=\>\"", "<>", 
                  RowBox[{"ToString", "[", "temp", "]"}], "<>", 
                  "\"\<  BGP=\>\"", "<>", 
                  RowBox[{"ToString", "[", "pN2", "]"}], "<>", 
                  "\"\<\\nbias=\>\"", "<>", 
                  RowBox[{"ToString", "[", 
                   RowBox[{
                    RowBox[{"fd", "[", 
                    RowBox[{"All", ",", "\"\<bias\>\""}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", 
                  "\"\< N2Off=\>\"", "<>", 
                  RowBox[{"ToString", "[", 
                   RowBox[{
                    RowBox[{"fd", "[", 
                    RowBox[{"All", ",", "\"\<N2Offset\>\""}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"Center", ",", "Top"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "2"}], "}"}]}], "]"}], ",", 
               RowBox[{"BaseStyle", "\[Rule]", "15"}]}], "]"}]}], "]"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"ListPlot", "[", 
            RowBox[{"data2", ",", "options", ",", 
             RowBox[{"FrameLabel", "\[Rule]", " ", 
              RowBox[{"{", 
               RowBox[{"\"\<He Potential\>\"", ",", "\"\<Current (nA)\>\""}], 
               "}"}]}]}], "]"}], "}"}]}], "}"}], ",", 
        RowBox[{"Spacings", "\[Rule]", "spacing"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GaussianAnalyzer", "[", 
    RowBox[{"fileName_", ",", "dependentVariableString_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "fitInfo", ",", " ", "bothPlot", ",", " ", "derivativePlot", ",", 
       "entry", ",", "ps", ",", "header", ",", "data", ",", "energy", ",", 
       "energyDiff", ",", "depVar", ",", "depVarDiff", ",", 
       "energyOneRemoved", ",", "depVarDer", ",", "plotTitle", ",", 
       "plotData", ",", "plotData2", ",", "fit", ",", "model", ",", "pe", ",",
        "errors", ",", "gaussModel", ",", "m", ",", "\[Sigma]", ",", "x", ",",
        "ampl", ",", "maxDerPos", ",", "energyOfPeak", ",", "dataLabel1", ",",
        "dataLabel2", ",", "x1", ",", "y1", ",", "offset", ",", " ", "new23", 
       ",", "plot", ",", "derPlot", ",", "index"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"entry", "=", 
       RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"header", "=", 
       RowBox[{"GetFileHeaderInfo", "[", "fileName", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"data", "=", 
       RowBox[{"GetFileDataset", "[", "fileName", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"energy", "=", 
       RowBox[{"Reverse", "[", 
        RowBox[{"Normal", "[", 
         RowBox[{"data", "[", 
          RowBox[{"All", ",", "\"\<SecondaryElectronEnergy\>\""}], "]"}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"depVar", "=", 
       RowBox[{"Reverse", "[", 
        RowBox[{"Normal", "[", 
         RowBox[{"data", "[", 
          RowBox[{"All", ",", "dependentVariableString"}], "]"}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"depVarDiff", "=", 
       RowBox[{"Differences", "[", "depVar", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"energyDiff", "=", 
       RowBox[{"Differences", "[", "energy", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"energyOneRemoved", "=", 
       RowBox[{"Take", "[", 
        RowBox[{"energy", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"depVarDer", "=", 
       RowBox[{"depVarDiff", "/", "energyDiff"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"plot", "=", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"energy", ",", "depVar"}], "}"}], "]"}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{
          "dependentVariableString", "<>", "\"\< vs. Energy: \>\"", "<>", 
           "fileName"}]}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<'Slow' Electron Energy (eV)\>\"", ",", 
            "dependentVariableString"}], "}"}]}], ",", 
         RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"derPlot", "=", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"energyOneRemoved", ",", "depVarDer"}], "}"}], "]"}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{
          "dependentVariableString", "<>", 
           "\"\< Derivative\\nvs. Energy: \>\"", "<>", "fileName"}]}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<'Slow' Electron Energy (eV)\>\"", ",", "\"\<Derivative\>\""}],
            "}"}]}], ",", 
         RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"plotTitle", "=", "\"\<Gaussian Analysis\>\""}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"plotData", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"energy", ",", "depVar"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"plotData2", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"energyOneRemoved", ",", "depVarDer"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"yAxisTitle", "=", "\"\<d(Counts)/d(Energy)\>\""}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"xAxisTitle", "=", "\"\<Electron Energy (eV)\>\""}], ";"}], 
       "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"dataLabel1", "=", "\"\<Data\>\""}], ";", "\[IndentingNewLine]", 
      RowBox[{"dataLabel2", "=", "\"\<Derivative\>\""}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ps", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", " ", 
         RowBox[{"PlotLabel", "\[Rule]", "plotTitle"}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\""}], "}"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"plotData", "=", "plotData2"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gaussModel", "[", "x_", "]"}], "=", 
       RowBox[{"ampl", " ", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"PDF", "[", 
          RowBox[{
           RowBox[{"NormalDistribution", "[", 
            RowBox[{"m", ",", "\[Sigma]"}], "]"}], ",", "x"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Find", " ", "the", " ", "position", " ", "of", " ", "the", " ", 
        "peak", " ", "of", " ", "the", " ", "derivative", " ", "data"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"maxDerPos", "=", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"depVarDer", ",", 
          RowBox[{"Max", "[", "depVarDer", "]"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"energyOfPeak", "=", 
       RowBox[{
        RowBox[{"energyOneRemoved", "[", 
         RowBox[{"[", "maxDerPos", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"fit", "=", 
       RowBox[{"NonlinearModelFit", "[", 
        RowBox[{"plotData", ",", 
         RowBox[{"gaussModel", "[", "x", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ampl", ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "energyOfPeak"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Sigma]", ",", ".9"}], "}"}]}], "}"}], ",", "x"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"model", "=", 
       RowBox[{"Normal", "[", "fit", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pe", "=", 
       RowBox[{"fit", "[", "\"\<BestFitParameters\>\"", "]"}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"Parameter", " ", "Estimates"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"errors", "=", 
       RowBox[{"fit", "[", "\"\<ParameterErrors\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"new23", "=", 
       RowBox[{
        RowBox[{"m", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", "*", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"2", 
              RowBox[{"Log", "[", "10", "]"}]}], "]"}], "\[Sigma]"}], ")"}], 
          "/", "2"}]}], "/.", "pe"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"offset", "=", 
       RowBox[{"23", "-", "new23"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"x1", "=", 
       RowBox[{"energyOfPeak", "-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", "\[Sigma]"}], "/.", "pe"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"y1", "=", 
       RowBox[{
        RowBox[{".25", "*", 
         RowBox[{"(", "ampl", ")"}]}], "/.", "pe"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fitInfo", "=", 
       RowBox[{"StringForm", "[", 
        RowBox[{
        "\"\<\[Mu]=``\[PlusMinus] ``\\n\[Sigma]=``\[PlusMinus]``\>\"", ",", 
         RowBox[{"NumberForm", "[", 
          RowBox[{
           RowBox[{"m", "/.", "pe"}], ",", "3"}], "]"}], ",", 
         RowBox[{"NumberForm", "[", 
          RowBox[{
           RowBox[{"errors", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}], ",", 
         RowBox[{"NumberForm", "[", 
          RowBox[{
           RowBox[{"\[Sigma]", "/.", "pe"}], ",", "3"}], "]"}], ",", 
         RowBox[{"NumberForm", "[", 
          RowBox[{
           RowBox[{"errors", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", "1"}], "]"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"Show", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"gaussModel", "[", "x", "]"}], "/.", "pe"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"energyOfPeak", "-", "5"}], ",", 
                RowBox[{"energyOfPeak", "+", "5"}]}], "}"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
              RowBox[{"PlotLabel", "\[Rule]", 
               RowBox[{
               "\"\<Gaussian Fit To Derivative\\nof \>\"", "<>", 
                "dependentVariableString", "<>", "\"\< Analysis: \>\"", "<>", 
                " ", "timeString"}]}], ",", 
              RowBox[{"Frame", "\[Rule]", "True"}], ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                "\"\<'Slow' Electron Energy (eV)\>\"", ",", 
                 "\"\<Derivative\>\""}], "}"}]}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Graphics", "[", 
             RowBox[{
              RowBox[{"Text", "[", 
               RowBox[{"fitInfo", ",", 
                RowBox[{"{", 
                 RowBox[{"x1", ",", "y1"}], "}"}]}], "]"}], ",", 
              RowBox[{"BaseStyle", "\[Rule]", "15"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ListPlot", "[", 
             RowBox[{"plotData", ",", 
              RowBox[{"PlotLabel", "\[Rule]", "\"\<PLOT2\>\""}]}], "]"}]}], 
           "}"}], "]"}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"bothPlot", "=", 
       RowBox[{"ListPlot", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Legended", "[", 
           RowBox[{"plotData", ",", "dataLabel2"}], "]"}], ",", 
          RowBox[{"Legended", "[", 
           RowBox[{"plotData2", ",", "dataLabel1"}], "]"}]}], "}"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"derivativePlot", "=", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"Legended", "[", 
          RowBox[{"plotData2", ",", "dataLabel2"}], "]"}], ",", "ps"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"entry", ",", "header"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"entry", ",", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{
           RowBox[{"dependentVariableString", "<>", "\"\<plot\>\""}], 
           "\[Rule]", "plot"}], ",", 
          RowBox[{"\"\<N2Offset\>\"", "\[Rule]", " ", 
           RowBox[{"data", "[", 
            RowBox[{"1", ",", "\"\<N2Offset\>\""}], "]"}]}], ",", 
          RowBox[{"\"\<filBias\>\"", "\[Rule]", " ", 
           RowBox[{"data", "[", 
            RowBox[{"1", ",", "\"\<bias\>\""}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"dependentVariableString", "<>", "\"\<onsetEnergy\>\""}], 
            "\[Rule]", " ", "m"}], "/.", "pe"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"dependentVariableString", "<>", "\"\<onsetWidth\>\""}], 
            "\[Rule]", "  ", "\[Sigma]"}], "/.", "pe"}], ",", 
          RowBox[{
           RowBox[{
           "dependentVariableString", "<>", "\"\<lowEnergySignal\>\""}], 
           "\[Rule]", " ", 
           RowBox[{"depVar", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
           "dependentVariableString", "<>", "\"\<highEnergySignal\>\""}], 
           "\[Rule]", " ", 
           RowBox[{"depVar", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}]}], "|>"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "entry"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetFileNameFromTimeString", "[", 
    RowBox[{"files_", ",", "timeString_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"index", ",", "fileName"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"index", "=", 
       RowBox[{"GetIndexOfFilenameFromTimestamp", "[", 
        RowBox[{"files", ",", "timeString"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fileName", "=", 
       RowBox[{"files", "[", 
        RowBox[{"[", "index", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExcitationFunctionProcessor", "[", "fileName_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "file", ",", "ps", ",", "header", ",", "data", ",", "energy", ",", 
       "energyDiff", ",", "current", ",", "currentDiff", ",", 
       "energyOneRemoved", ",", "currentDer", ",", "plotTitle", ",", 
       "plotData", ",", "plotData2", ",", "fit", ",", "model", ",", "pe", ",",
        "errors", ",", "gaussModel", ",", "m", ",", "\[Sigma]", ",", "x", ",",
        "ampl", ",", "maxDerPos", ",", "energyOfPeak", ",", "x1", ",", "y1", 
       ",", "return", " ", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"return", "=", 
       RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"return", ",", 
        RowBox[{"GaussianAnalyzer", "[", 
         RowBox[{"fileName", ",", "\"\<CountRate\>\""}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"return", ",", 
        RowBox[{"GaussianAnalyzer", "[", 
         RowBox[{"fileName", ",", "\"\<Current\>\""}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"return", ",", 
        RowBox[{"\"\<stackedPlot\>\"", "\[Rule]", 
         RowBox[{"StackedExFnPlot", "[", "fileName", "]"}]}]}], " ", "]"}], 
      ";", "\[IndentingNewLine]", "return"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.732373158720867*^9, 3.732373159298614*^9}, 
   3.7323748159255667`*^9, 3.7323772919894333`*^9, {3.7325333203439264`*^9, 
   3.7325334229846535`*^9}, {3.7325334530680914`*^9, 
   3.7325334923157525`*^9}, {3.732533548044611*^9, 
   3.7325336619459887`*^9}},ExpressionUUID->"5c12a4bf-58aa-4df4-93bd-\
9d5fa0a247bd"]
}, Closed]],

Cell[CellGroupData[{

Cell["Comparing Functional Form Models", "Section",
 CellChangeTimes->{{3.739875121153797*^9, 3.7398751360489697`*^9}, {
  3.739875480692021*^9, 
  3.7398754819398785`*^9}},ExpressionUUID->"e0b67700-322a-4b80-8d38-\
0df53e9d9d5d"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "We", " ", "have", " ", "a", " ", "couple", " ", "functional", " ", 
    "models", " ", "that", " ", "are", " ", "very", " ", "similar", " ", "in",
     " ", "form"}], ",", " ", 
   RowBox[{
   "and", " ", "I", " ", "just", " ", "want", " ", "to", " ", "be", " ", 
    "sure", " ", "that", " ", "they", " ", "give", " ", "equivalent", " ", 
    "results", " ", "with", " ", "the", " ", "same", " ", 
    RowBox[{
    "dataset", ".", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
     RowBox[{"-", "Wu"}]}], " ", "is", " ", "from", " ", "the", " ", "1986", 
    " ", "paper", " ", "from", " ", "the", " ", "author", " ", "with", " ", 
    "the", " ", "same", " ", 
    RowBox[{"name", ".", "\[IndentingNewLine]", " ", 
     RowBox[{"-", "Litaker"}]}], " ", "comes", " ", "from", " ", "his", " ", 
    "thesis"}], ",", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"it", "'"}], "s", " ", "esentially", " ", "a", " ", "re"}], "-", 
    RowBox[{"derivation", " ", "of", " ", 
     RowBox[{"Wu", ".", " ", "\[IndentingNewLine]", 
      RowBox[{"-", "Ahrendsen"}]}], " ", "comes", " ", "from", " ", "my", " ",
      "own", " ", "derivation", " ", "of", " ", "Wu"}]}], ",", " ", 
   RowBox[{
   "containing", " ", "another", " ", "frequency", " ", "term", " ", "that", 
    " ", "I", " ", "believe", " ", "Litaker", " ", "should", " ", "be", " ", 
    "including", " ", "to", " ", "be", " ", "equivalent", " ", "to", " ", 
    RowBox[{"Wu", ".", " ", "I"}], " ", "obtained", " ", "my", " ", "formula",
     " ", "by", " ", "converting", " ", 
    RowBox[{"Wu", "'"}], "s", " ", "to", " ", "use", " ", "frequency", " ", 
    "instead", " ", "of", " ", 
    RowBox[{"wavelength", "."}]}]}], "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.739875483912217*^9, 3.7398756251574383`*^9}, {
  3.739895534127448*^9, 3.739895569694706*^9}, {3.7399799051449947`*^9, 
  3.739979905809757*^9}},ExpressionUUID->"1ab52b34-9409-402b-9592-\
ed24d770ab06"]
}, Closed]],

Cell[CellGroupData[{

Cell["Functions for converting different ways of measuring", "Section",
 CellChangeTimes->{{3.7402291104034147`*^9, 
  3.7402291292036333`*^9}},ExpressionUUID->"4a9c2b7c-c554-433c-955d-\
4dbe98ce5998"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Functions", " ", "for", " ", "converting", " ", "ways", " ", "of", " ", 
    "measuring", " ", "laser", " ", "color"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Delta]2\[Nu]", "[", "\[Delta]_", "]"}], ":=", 
     RowBox[{"\[Delta]", "+", 
      RowBox[{"\[Nu]0", "*", "1*^-9"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Nu]2\[Lambda]", "[", "\[Nu]_", "]"}], ":=", 
     RowBox[{"c", "*", 
      RowBox[{".01", "/", "\[Nu]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Lambda]2\[CapitalDelta]\[Lambda]", "[", "\[Lambda]_", "]"}], ":=", 
     RowBox[{"\[Lambda]", "-", 
      RowBox[{"(", 
       RowBox[{"\[Lambda]0", "*", "1*^7"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Delta]2\[CapitalDelta]\[Lambda]", "[", "\[Delta]_", "]"}], ":=", 
     RowBox[{"\[Lambda]2\[CapitalDelta]\[Lambda]", "[", 
      RowBox[{"\[Nu]2\[Lambda]", "[", 
       RowBox[{"\[Delta]2\[Nu]", "[", "\[Delta]", "]"}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Functions", " ", "for", " ", "converting", " ", "ways", " ", "of", " ", 
     "measuring", " ", "amount", " ", "of", " ", "rotation"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"deg2rad", "[", "deg_", "]"}], ":=", 
     RowBox[{
      RowBox[{"deg", "/", "180"}], "*", "\[Pi]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"rad2deg", "[", "rad_", "]"}], ":=", 
     RowBox[{
      RowBox[{"rad", "/", "\[Pi]"}], "*", "180"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "convert\[Delta]dataset2\[CapitalDelta]\[Lambda]", "[", "dataset_", 
      "]"}], ":=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Delta]2\[CapitalDelta]\[Lambda]", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", "dataset", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Transpose", "[", "dataset", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"convertGHzDataset2Hz", "[", "dataset_", "]"}], ":=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1*^9", "*", 
         RowBox[{
          RowBox[{"Transpose", "[", "dataset", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"Transpose", "[", "dataset", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"convert\[Degree]dataset2rad", "[", "dataset_", "]"}], ":=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Transpose", "[", "dataset", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"deg2rad", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", "dataset", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7398965454152975`*^9, 3.739896642789712*^9}, {
   3.7398966880055513`*^9, 3.7398968375425434`*^9}, {3.739896916823618*^9, 
   3.739896978119424*^9}, {3.739897525307044*^9, 3.7398975261546173`*^9}, {
   3.7398976319955006`*^9, 3.7398976539955053`*^9}, 3.739897753932668*^9, 
   3.7399005235416045`*^9, {3.7399007082625933`*^9, 3.7399007315184555`*^9}, {
   3.739963373416293*^9, 3.739963422302396*^9}, {3.739963541979244*^9, 
   3.739963546144548*^9}, {3.739979556731432*^9, 3.739979686089251*^9}, {
   3.739979766394905*^9, 3.739979824161675*^9}, {3.739979899273892*^9, 
   3.739979968449223*^9}, {3.7402396183748837`*^9, 3.740239722518895*^9}, 
   3.740239760472788*^9},ExpressionUUID->"468ef7dc-f8d6-444b-9b42-\
c27cd689cf01"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Models for fitting the data", "Section",
 CellChangeTimes->{{3.7402290984033527`*^9, 3.7402291026755185`*^9}, {
  3.7402291446760745`*^9, 
  3.7402291454920187`*^9}},ExpressionUUID->"92adc8ad-0473-48bb-9717-\
446e7d0ca705"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Note", " ", "that", " ", "Q", " ", "is", " ", "a", " ", "constant", " ", 
    "that", " ", "consists", " ", "of", " ", "variables", " ", "that", " ", 
    "are", " ", "always", " ", "the", " ", "same", " ", "between", " ", 
    RowBox[{"equations", ".", " ", "\[IndentingNewLine]", "It"}], " ", "does",
     " ", "not", " ", "include", " ", "factors", " ", "of", " ", "c"}], ",", 
   " ", 
   RowBox[{"2", "\[Pi]"}], ",", " ", 
   RowBox[{
    RowBox[{"\[Nu]", " ", "or", " ", "\[Lambda]", "  ", "Q"}], "=", 
    RowBox[{
     FractionBox[
      RowBox[{
       SubscriptBox["r", "e"], 
       SubscriptBox["f", "ge"], "\[Kappa]", " ", 
       SubscriptBox["\[Mu]", "B"]}], "h"], " ", "which", " ", "has", " ", 
     "dimensions", " ", 
     RowBox[{"of", " ", "[", " ", 
      RowBox[{
       SuperscriptBox["L", "1"], " ", 
       SuperscriptBox["T", 
        RowBox[{"-", "1"}]], " ", 
       SuperscriptBox["G", 
        RowBox[{"-", "1"}]]}], " ", "]"}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.7402291472239943`*^9, 3.74022926248536*^9}, {
  3.740310178894104*^9, 3.740310196442148*^9}, {3.740310245570427*^9, 
  3.740310262774722*^9}},ExpressionUUID->"73c0b67e-c523-4a63-9be5-\
8965a9b1b540"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"wu", "=", 
   RowBox[{"a0", "+", 
    FractionBox["a2", 
     SuperscriptBox["\[CapitalDelta]\[Lambda]", "2"]], "+", 
    FractionBox["a4", 
     SuperscriptBox["\[CapitalDelta]\[Lambda]", "4"]]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nDensCWu", "=", 
   FractionBox[
    RowBox[{"4", " ", "\[Pi]", " ", "c", " "}], 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", "\[Lambda]0", ")"}], "4"], " ", "Q"}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WuA2Conv", "[", 
     RowBox[{"a2_", ",", "BdotL_"}], "]"}], ":=", 
    RowBox[{
     FractionBox["nDensCWu", "BdotL"], "*", "a2"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"litaker", "=", 
   RowBox[{"a0", "+", 
    FractionBox[
     RowBox[{"a2", 
      RowBox[{"(", 
       RowBox[{"\[Delta]", "+", "\[Nu]0"}], ")"}]}], 
     SuperscriptBox["\[Delta]", "2"]], "+", 
    FractionBox[
     RowBox[{"a4", 
      RowBox[{"(", 
       RowBox[{"\[Delta]", "+", "\[Nu]0"}], ")"}]}], 
     SuperscriptBox["\[Delta]", "4"]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nDensCLitaker", "=", 
   FractionBox[
    RowBox[{"4", " ", "\[Pi]", " ", "\[Nu]0"}], 
    RowBox[{"c", " ", "Q"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LitakerA2Conv", "[", 
     RowBox[{"a2_", ",", "BdotL_"}], "]"}], ":=", 
    RowBox[{
     FractionBox["nDensCLitaker", "BdotL"], "*", "a2"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ahrendsen", "=", 
   RowBox[{"a0", "+", 
    FractionBox[
     RowBox[{"a2", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"\[Delta]", "+", "\[Nu]0"}], ")"}], "2"]}], 
     SuperscriptBox["\[Delta]", "2"]], "+", 
    FractionBox[
     RowBox[{"a4", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"\[Delta]", "+", "\[Nu]0"}], ")"}], "2"]}], 
     SuperscriptBox["\[Delta]", "4"]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nDensCAhrendsen", "=", 
   FractionBox[
    RowBox[{"4", " ", "\[Pi]", " ", 
     SuperscriptBox["\[Nu]0", "2"]}], 
    RowBox[{"c", "  ", "Q"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AhrendsenA2Conv", "[", 
    RowBox[{"a2_", ",", "BdotL_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["nDensCAhrendsen", "BdotL"], "*", "a2"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7398751400366764`*^9, 3.7398753990283213`*^9}, {
   3.7398754558931065`*^9, 3.739875475109213*^9}, {3.7398758493339176`*^9, 
   3.739875908726062*^9}, {3.739875951430188*^9, 3.739876018422881*^9}, {
   3.739876066039358*^9, 3.7398762837208276`*^9}, {3.739894924625317*^9, 
   3.7398949498043327`*^9}, {3.7398950070530157`*^9, 3.739895075389192*^9}, {
   3.7398953476792808`*^9, 3.739895411437767*^9}, 3.739895530975298*^9, {
   3.7398955750233407`*^9, 3.7398955918097897`*^9}, {3.7398956360649753`*^9, 
   3.739895704848889*^9}, {3.739896162947775*^9, 3.7398961673957806`*^9}, 
   3.739896234211929*^9, {3.7398965393651705`*^9, 3.7398965407891426`*^9}, {
   3.7398981047506657`*^9, 3.739898104943797*^9}, {3.739900528485976*^9, 
   3.7399005522691975`*^9}, 3.739900716544242*^9, {3.7399023437207994`*^9, 
   3.7399023615118203`*^9}, {3.739960125123829*^9, 3.7399601394107647`*^9}, {
   3.7402217730973225`*^9, 3.740221817129146*^9}, {3.740226016522984*^9, 
   3.7402260538907757`*^9}, {3.7402292739899654`*^9, 3.740229283269698*^9}, {
   3.7402387245561647`*^9, 3.740238734646079*^9}, {3.740238767414236*^9, 
   3.7402387700065756`*^9}, {3.7402388253668194`*^9, 3.7402388438935804`*^9}, 
   3.7402391314628506`*^9, {3.740239162022995*^9, 3.74023917880685*^9}, {
   3.7403106402824984`*^9, 3.74031065059562*^9}, {3.740310690129429*^9, 
   3.740310695020384*^9}, {3.740310856062373*^9, 3.7403108580156283`*^9}, {
   3.7403116225382447`*^9, 3.7403116412426176`*^9}, {3.74031469985935*^9, 
   3.740314709797514*^9}, {3.7403272400539837`*^9, 3.740327244569911*^9}, {
   3.7403273002142467`*^9, 3.740327302261258*^9}, {3.740327344592209*^9, 
   3.7403273503582172`*^9}},ExpressionUUID->"5a79e7ec-0d1c-4ea4-81ce-\
7d69cf977774"],

Cell[CellGroupData[{

Cell[BoxData[{"nDensCWu", "\[IndentingNewLine]", "nDensCLitaker", "\
\[IndentingNewLine]", "nDensCAhrendsen"}], "Input",
 CellChangeTimes->{{3.7398763314073515`*^9, 3.73987633213785*^9}, 
   3.7398949295666566`*^9, {3.7398950268764114`*^9, 3.739895030203659*^9}, {
   3.739895709840293*^9, 3.7398957126562138`*^9}, 
   3.7398958453457146`*^9},ExpressionUUID->"eb13a117-d23a-45b2-b1f0-\
0122c6959d09"],

Cell[BoxData["8.339411226870451`*^33"], "Output",
 CellChangeTimes->{
  3.7398958690118575`*^9, 3.739898116480672*^9, 3.7399006134879527`*^9, 
   3.7399007766462364`*^9, 3.739901327027067*^9, 3.7399023675438967`*^9, 
   3.739960003754217*^9, {3.7402218122567787`*^9, 3.740221820235624*^9}, 
   3.7402260233295546`*^9, {3.740239150207205*^9, 3.740239182353136*^9}, 
   3.740310106654909*^9, 3.74031046342807*^9, 3.7403106531895285`*^9, 
   3.7403106972861567`*^9, 3.7403116285855227`*^9, 3.740314712844591*^9, 
   3.740314840207633*^9, {3.7403272475076075`*^9, 3.740327273009308*^9}, 
   3.740327308652311*^9},ExpressionUUID->"5f7fe9cb-03b9-4ea6-a7dd-\
c5e47781f5a3"],

Cell[BoxData["8.781349903798894`*^11"], "Output",
 CellChangeTimes->{
  3.7398958690118575`*^9, 3.739898116480672*^9, 3.7399006134879527`*^9, 
   3.7399007766462364`*^9, 3.739901327027067*^9, 3.7399023675438967`*^9, 
   3.739960003754217*^9, {3.7402218122567787`*^9, 3.740221820235624*^9}, 
   3.7402260233295546`*^9, {3.740239150207205*^9, 3.740239182353136*^9}, 
   3.740310106654909*^9, 3.74031046342807*^9, 3.7403106531895285`*^9, 
   3.7403106972861567`*^9, 3.7403116285855227`*^9, 3.740314712844591*^9, 
   3.740314840207633*^9, {3.7403272475076075`*^9, 3.740327273009308*^9}, 
   3.740327308652311*^9},ExpressionUUID->"4a9d7e33-c6c4-4294-8114-\
30dc1c27e8ca"],

Cell[BoxData["3.311512583936895`*^26"], "Output",
 CellChangeTimes->{
  3.7398958690118575`*^9, 3.739898116480672*^9, 3.7399006134879527`*^9, 
   3.7399007766462364`*^9, 3.739901327027067*^9, 3.7399023675438967`*^9, 
   3.739960003754217*^9, {3.7402218122567787`*^9, 3.740221820235624*^9}, 
   3.7402260233295546`*^9, {3.740239150207205*^9, 3.740239182353136*^9}, 
   3.740310106654909*^9, 3.74031046342807*^9, 3.7403106531895285`*^9, 
   3.7403106972861567`*^9, 3.7403116285855227`*^9, 3.740314712844591*^9, 
   3.740314840207633*^9, {3.7403272475076075`*^9, 3.740327273009308*^9}, 
   3.740327308652311*^9},ExpressionUUID->"b69c7854-917a-461d-b991-\
2921e691af16"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dataset", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "3"}], ",", ".51"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4"}], ",", ".28"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4.5"}], ",", ".22"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "5"}], ",", ".18"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "10"}], ",", ".05"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "15"}], ",", ".02"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "20"}], ",", ".01"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "40"}], ",", ".00"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"datasetRadians", "=", 
  RowBox[{"convert\[Degree]dataset2rad", "[", 
   RowBox[{"convertGHzDataset2Hz", "[", "dataset", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.739895951155882*^9, 3.7398960464678907`*^9}, {
  3.7398961153306026`*^9, 3.7398961195864773`*^9}, {3.739896351122927*^9, 
  3.7398964162121744`*^9}, {3.739897905549801*^9, 3.73989797722969*^9}, {
  3.739898019598588*^9, 3.7398980908461823`*^9}, {3.739899985561674*^9, 
  3.739899986265154*^9}, {3.739960160588563*^9, 3.739960166480394*^9}, {
  3.739963452950488*^9, 3.7399634908043633`*^9}, {3.739963522324231*^9, 
  3.739963522939262*^9}, {3.739963564043161*^9, 3.7399636338885107`*^9}, {
  3.7399797014754343`*^9, 3.739979714420669*^9}, {3.73997984093294*^9, 
  3.739979854915758*^9}, {3.7402505178448687`*^9, 
  3.7402505524052916`*^9}},ExpressionUUID->"fba5a893-bb26-47b1-807a-\
d2ff8f894efe"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3000000000"}], ",", "0.008901179185171082`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4000000000"}], ",", "0.004886921905584123`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4.5`*^9"}], ",", "0.003839724354387525`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5000000000"}], ",", "0.0031415926535897933`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "10000000000"}], ",", "0.0008726646259971648`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "15000000000"}], ",", "0.00034906585039886593`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "20000000000"}], ",", "0.00017453292519943296`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "40000000000"}], ",", "0.`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.739963468920662*^9, 3.7399635652553473`*^9}, {
   3.739963614565531*^9, 3.739963634310199*^9}, 3.739979714708106*^9, 
   3.739979855550715*^9, 3.7402218273393483`*^9, 3.7402391865899744`*^9, 
   3.740239745984067*^9, 3.7402505549203424`*^9, 3.740310472459866*^9, 
   3.7403106555802965`*^9, 3.7403107028802814`*^9, 3.740314715297903*^9, 
   3.7403148416608562`*^9, 3.7403272755094757`*^9, 
   3.7403273108087053`*^9},ExpressionUUID->"ad231292-27f4-4287-9301-\
ac73076f5348"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"model", "=", "ahrendsen"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"startPoints", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a4", ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"nlmFit", " ", "=", 
  RowBox[{"NonlinearModelFit", "[", 
   RowBox[{
    RowBox[{"Normal", "[", "datasetRadians", "]"}], ",", "model", ",", 
    "startPoints", ",", "\[Delta]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"fitParam", "=", 
  RowBox[{
  "nlmFit", "[", "\"\<BestFitParameters\>\"", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AhrendsenA2Conv", "[", 
   RowBox[{
    RowBox[{"a2", "/.", "fitParam"}], ",", "300"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"model", "=", "litaker"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"startPoints", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a4", ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"nlmFit", " ", "=", 
  RowBox[{"NonlinearModelFit", "[", 
   RowBox[{
    RowBox[{"Normal", "[", "datasetRadians", "]"}], ",", "model", ",", 
    "startPoints", ",", "\[Delta]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"fitParam", "=", 
  RowBox[{
  "nlmFit", "[", "\"\<BestFitParameters\>\"", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"LitakerA2Conv", "[", 
  RowBox[{
   RowBox[{"a2", "/.", "fitParam"}], ",", "300"}], "]"}]}], "Input",
 CellChangeTimes->{{3.739895951155882*^9, 3.7398960464678907`*^9}, {
  3.7398961153306026`*^9, 3.7398961195864773`*^9}, {3.739896351122927*^9, 
  3.7398964162121744`*^9}, {3.739897905549801*^9, 3.73989797722969*^9}, {
  3.739898019598588*^9, 3.7398980908461823`*^9}, {3.739899985561674*^9, 
  3.739899986265154*^9}, {3.739960160588563*^9, 3.739960166480394*^9}, {
  3.739963452950488*^9, 3.73996345923318*^9}, {3.739963651511644*^9, 
  3.73996365235964*^9}, {3.7402392838150864`*^9, 3.7402392911101108`*^9}, {
  3.740239321510379*^9, 
  3.740239322517882*^9}},ExpressionUUID->"f60718be-7448-4de1-869e-\
f05bcd5ecc25"],

Cell[BoxData[
 TagBox[
  RowBox[{"FittedModel", "[", 
   TagBox[
    PanelBox[
     TagBox[
      RowBox[{"7.160712958218618`*^-6", "+", 
       FractionBox[
        RowBox[{"213246.8442689778`", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"3.77107463`*^14", "+", "\[Delta]"}], ")"}], "2"]}], 
        SuperscriptBox["\[Delta]", "4"]], "+", 
       FractionBox[
        RowBox[{"5.386049452413662`*^-13", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"3.77107463`*^14", "+", "\[Delta]"}], ")"}], "2"]}], 
        SuperscriptBox["\[Delta]", "2"]]}],
      Short[#, 2]& ],
     FrameMargins->5],
    Editable -> False], "]"}],
  InterpretTemplate[
  FittedModel[{
    "Nonlinear", {$CellContext`a0 -> 7.160712958218618*^-6, $CellContext`a2 -> 
      5.386049452413662*^-13, $CellContext`a4 -> 
      213246.8442689778}, {{$CellContext`\[Delta]}, $CellContext`a0 + \
($CellContext`a4 $CellContext`\[Delta]^(-4)) (
         3.77107463*^14 + $CellContext`\[Delta])^2 + ($CellContext`a2 \
$CellContext`\[Delta]^(-2)) (3.77107463*^14 + $CellContext`\[Delta])^2}}, {
    1}, {{-3000000000, 0.008901179185171082}, {-4000000000, 
      0.004886921905584123}, {-4.5*^9, 
     0.003839724354387525}, {-5000000000, 
      0.0031415926535897933`}, {-10000000000, 
      0.0008726646259971648}, {-15000000000, 
      0.00034906585039886593`}, {-20000000000, 
      0.00017453292519943296`}, {-40000000000, 0.}}, 
    Function[Null, 
     Internal`LocalizedBlock[{$CellContext`a0, $CellContext`a2, \
$CellContext`a4, $CellContext`\[Delta]}, #], {HoldAll}]]& ],
  Editable->False,
  SelectWithContents->True,
  Selectable->True]], "Output",
 CellChangeTimes->{{3.7398963669075933`*^9, 3.739896416692502*^9}, {
   3.7398979080174847`*^9, 3.73989793651392*^9}, {3.7398979678252754`*^9, 
   3.7398979783694677`*^9}, {3.7398980212557487`*^9, 
   3.7398980336962028`*^9}, {3.739898091682757*^9, 3.7398981180347257`*^9}, {
   3.739899982143343*^9, 3.7398999868265376`*^9}, 3.739901433834916*^9, 
   3.7399023765219765`*^9, {3.739960144524405*^9, 3.739960168352355*^9}, 
   3.7399636528632174`*^9, 3.740221830628405*^9, 3.74023918943988*^9, 
   3.7402393240120263`*^9, 3.740250561201004*^9, 3.740250706413241*^9, 
   3.740310482554227*^9, 3.740310657611668*^9, 3.7403107040991116`*^9, 
   3.7403147162666965`*^9, 3.7403148425202875`*^9, {3.740327249398359*^9, 
   3.7403272772595916`*^9}, 
   3.7403273118400235`*^9},ExpressionUUID->"ef5361ce-b71b-4709-a8c2-\
5c5f6f134e87"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"a0", "\[Rule]", "7.160712958218618`*^-6"}], ",", 
   RowBox[{"a2", "\[Rule]", "5.386049452413662`*^-13"}], ",", 
   RowBox[{"a4", "\[Rule]", "213246.8442689778`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7398963669075933`*^9, 3.739896416692502*^9}, {
   3.7398979080174847`*^9, 3.73989793651392*^9}, {3.7398979678252754`*^9, 
   3.7398979783694677`*^9}, {3.7398980212557487`*^9, 
   3.7398980336962028`*^9}, {3.739898091682757*^9, 3.7398981180347257`*^9}, {
   3.739899982143343*^9, 3.7398999868265376`*^9}, 3.739901433834916*^9, 
   3.7399023765219765`*^9, {3.739960144524405*^9, 3.739960168352355*^9}, 
   3.7399636528632174`*^9, 3.740221830628405*^9, 3.74023918943988*^9, 
   3.7402393240120263`*^9, 3.740250561201004*^9, 3.740250706413241*^9, 
   3.740310482554227*^9, 3.740310657611668*^9, 3.7403107040991116`*^9, 
   3.7403147162666965`*^9, 3.7403148425202875`*^9, {3.740327249398359*^9, 
   3.7403272772595916`*^9}, 
   3.7403273118400235`*^9},ExpressionUUID->"5f9ace2c-13c9-494b-9f77-\
d5f8707c99e5"],

Cell[BoxData["5.945323513124755`*^11"], "Output",
 CellChangeTimes->{{3.7398963669075933`*^9, 3.739896416692502*^9}, {
   3.7398979080174847`*^9, 3.73989793651392*^9}, {3.7398979678252754`*^9, 
   3.7398979783694677`*^9}, {3.7398980212557487`*^9, 
   3.7398980336962028`*^9}, {3.739898091682757*^9, 3.7398981180347257`*^9}, {
   3.739899982143343*^9, 3.7398999868265376`*^9}, 3.739901433834916*^9, 
   3.7399023765219765`*^9, {3.739960144524405*^9, 3.739960168352355*^9}, 
   3.7399636528632174`*^9, 3.740221830628405*^9, 3.74023918943988*^9, 
   3.7402393240120263`*^9, 3.740250561201004*^9, 3.740250706413241*^9, 
   3.740310482554227*^9, 3.740310657611668*^9, 3.7403107040991116`*^9, 
   3.7403147162666965`*^9, 3.7403148425202875`*^9, {3.740327249398359*^9, 
   3.7403272772595916`*^9}, 
   3.7403273118400235`*^9},ExpressionUUID->"e34fd16e-9ccd-4dc3-8364-\
d4cbf646541c"],

Cell[BoxData[
 TagBox[
  RowBox[{"FittedModel", "[", 
   TagBox[
    PanelBox[
     TagBox[
      RowBox[{"7.1525291918986505`*^-6", "+", 
       FractionBox[
        RowBox[{"8.042605056133484`*^19", " ", 
         RowBox[{"(", 
          RowBox[{"3.77107463`*^14", "+", "\[Delta]"}], ")"}]}], 
        SuperscriptBox["\[Delta]", "4"]], "+", 
       FractionBox[
        RowBox[{"203.10945306970447`", " ", 
         RowBox[{"(", 
          RowBox[{"3.77107463`*^14", "+", "\[Delta]"}], ")"}]}], 
        SuperscriptBox["\[Delta]", "2"]]}],
      Short[#, 2]& ],
     FrameMargins->5],
    Editable -> False], "]"}],
  InterpretTemplate[
  FittedModel[{
    "Nonlinear", {$CellContext`a0 -> 7.1525291918986505`*^-6, $CellContext`a2 -> 
      203.10945306970447`, $CellContext`a4 -> 
      8.042605056133484*^19}, {{$CellContext`\[Delta]}, $CellContext`a0 + \
($CellContext`a4 $CellContext`\[Delta]^(-4)) (
        3.77107463*^14 + $CellContext`\[Delta]) + ($CellContext`a2 \
$CellContext`\[Delta]^(-2)) (3.77107463*^14 + $CellContext`\[Delta])}}, {
    1}, {{-3000000000, 0.008901179185171082}, {-4000000000, 
      0.004886921905584123}, {-4.5*^9, 
     0.003839724354387525}, {-5000000000, 
      0.0031415926535897933`}, {-10000000000, 
      0.0008726646259971648}, {-15000000000, 
      0.00034906585039886593`}, {-20000000000, 
      0.00017453292519943296`}, {-40000000000, 0.}}, 
    Function[Null, 
     Internal`LocalizedBlock[{$CellContext`a0, $CellContext`a2, \
$CellContext`a4, $CellContext`\[Delta]}, #], {HoldAll}]]& ],
  Editable->False,
  SelectWithContents->True,
  Selectable->True]], "Output",
 CellChangeTimes->{{3.7398963669075933`*^9, 3.739896416692502*^9}, {
   3.7398979080174847`*^9, 3.73989793651392*^9}, {3.7398979678252754`*^9, 
   3.7398979783694677`*^9}, {3.7398980212557487`*^9, 
   3.7398980336962028`*^9}, {3.739898091682757*^9, 3.7398981180347257`*^9}, {
   3.739899982143343*^9, 3.7398999868265376`*^9}, 3.739901433834916*^9, 
   3.7399023765219765`*^9, {3.739960144524405*^9, 3.739960168352355*^9}, 
   3.7399636528632174`*^9, 3.740221830628405*^9, 3.74023918943988*^9, 
   3.7402393240120263`*^9, 3.740250561201004*^9, 3.740250706413241*^9, 
   3.740310482554227*^9, 3.740310657611668*^9, 3.7403107040991116`*^9, 
   3.7403147162666965`*^9, 3.7403148425202875`*^9, {3.740327249398359*^9, 
   3.7403272772595916`*^9}, 
   3.740327311855651*^9},ExpressionUUID->"07b04abf-1083-450e-bcbe-\
f5aa33053c84"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"a0", "\[Rule]", "7.1525291918986505`*^-6"}], ",", 
   RowBox[{"a2", "\[Rule]", "203.10945306970447`"}], ",", 
   RowBox[{"a4", "\[Rule]", "8.042605056133484`*^19"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7398963669075933`*^9, 3.739896416692502*^9}, {
   3.7398979080174847`*^9, 3.73989793651392*^9}, {3.7398979678252754`*^9, 
   3.7398979783694677`*^9}, {3.7398980212557487`*^9, 
   3.7398980336962028`*^9}, {3.739898091682757*^9, 3.7398981180347257`*^9}, {
   3.739899982143343*^9, 3.7398999868265376`*^9}, 3.739901433834916*^9, 
   3.7399023765219765`*^9, {3.739960144524405*^9, 3.739960168352355*^9}, 
   3.7399636528632174`*^9, 3.740221830628405*^9, 3.74023918943988*^9, 
   3.7402393240120263`*^9, 3.740250561201004*^9, 3.740250706413241*^9, 
   3.740310482554227*^9, 3.740310657611668*^9, 3.7403107040991116`*^9, 
   3.7403147162666965`*^9, 3.7403148425202875`*^9, {3.740327249398359*^9, 
   3.7403272772595916`*^9}, 
   3.740327311855651*^9},ExpressionUUID->"67f0b69b-0d49-475d-a7ba-\
d8d135beaa9d"],

Cell[BoxData["5.945250587247651`*^11"], "Output",
 CellChangeTimes->{{3.7398963669075933`*^9, 3.739896416692502*^9}, {
   3.7398979080174847`*^9, 3.73989793651392*^9}, {3.7398979678252754`*^9, 
   3.7398979783694677`*^9}, {3.7398980212557487`*^9, 
   3.7398980336962028`*^9}, {3.739898091682757*^9, 3.7398981180347257`*^9}, {
   3.739899982143343*^9, 3.7398999868265376`*^9}, 3.739901433834916*^9, 
   3.7399023765219765`*^9, {3.739960144524405*^9, 3.739960168352355*^9}, 
   3.7399636528632174`*^9, 3.740221830628405*^9, 3.74023918943988*^9, 
   3.7402393240120263`*^9, 3.740250561201004*^9, 3.740250706413241*^9, 
   3.740310482554227*^9, 3.740310657611668*^9, 3.7403107040991116`*^9, 
   3.7403147162666965`*^9, 3.7403148425202875`*^9, {3.740327249398359*^9, 
   3.7403272772595916`*^9}, 
   3.740327311855651*^9},ExpressionUUID->"990e410d-ed04-49cd-be4d-\
6943ef418191"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"datasetWavelength", "=", 
  RowBox[{"Transpose", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Delta]2\[CapitalDelta]\[Lambda]", "[", 
       RowBox[{"1*^-9", "*", 
        RowBox[{
         RowBox[{"Transpose", "[", "datasetRadians", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "*", "1*^-7"}], ",", 
     RowBox[{
      RowBox[{"Transpose", "[", "datasetRadians", "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7398964527430944`*^9, 3.7398964562124567`*^9}, {
  3.739896996105691*^9, 3.7398970657211723`*^9}, {3.7398971292254868`*^9, 
  3.739897132569767*^9}, {3.7398978408286576`*^9, 3.7398978505723033`*^9}, {
  3.739963659184333*^9, 3.739963663174864*^9}, {3.7402506753500247`*^9, 
  3.740250718728382*^9}, {3.7403109413649387`*^9, 3.7403109519593954`*^9}, {
  3.740311569003422*^9, 
  3.740311569534709*^9}},ExpressionUUID->"94e33514-4500-4524-b64e-\
7ec96653cc51"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"6.324339247612442`*^-10", ",", "0.008901179185171082`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"8.432474691403513`*^-10", ",", "0.004886921905584123`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"9.48654660601278`*^-10", ",", "0.003839724354387525`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"1.0540621315840326`*^-9", ",", "0.0031415926535897933`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"2.1081522151575883`*^-9", ",", "0.0008726646259971648`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"3.162270251823429`*^-9", ",", "0.00034906585039886593`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"4.216416242684318`*^-9", ",", "0.00017453292519943296`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"8.433279770474655`*^-9", ",", "0.`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.740327316574714*^9},ExpressionUUID->"835bc56f-ff9c-4cc5-8bff-\
f3ac33a3e4a1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dataset", "=", "datasetWavelength"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"model", "=", "wu"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"startPoints", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a2", ",", "6*^-1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a4", ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"nlmFit", " ", "=", 
  RowBox[{"NonlinearModelFit", "[", 
   RowBox[{
    RowBox[{"Normal", "[", "dataset", "]"}], ",", "model", ",", "startPoints",
     ",", "\[CapitalDelta]\[Lambda]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"fitParam", "=", 
  RowBox[{
  "nlmFit", "[", "\"\<BestFitParameters\>\"", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"WuA2Conv", "[", 
  RowBox[{
   RowBox[{"a2", "/.", "fitParam"}], ",", "300"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7398978577411923`*^9, 3.7398978798852963`*^9}, {
   3.7398981422072134`*^9, 3.7398981528784904`*^9}, 3.7398999789691772`*^9, {
   3.7399601839545918`*^9, 3.7399601890490427`*^9}, {3.740311066364482*^9, 
   3.7403111111955976`*^9}},ExpressionUUID->"642ad94b-4e92-4c25-bf56-\
b9a41b5a3545"],

Cell[BoxData[
 TagBox[
  RowBox[{"FittedModel", "[", 
   TagBox[
    PanelBox[
     TagBox[
      RowBox[{"7.160685697834249`*^-6", "+", 
       FractionBox["5.989340642858098`*^-41", 
        SuperscriptBox["\[CapitalDelta]\[Lambda]", "4"]], "+", 
       FractionBox["3.4039377125888695`*^-21", 
        SuperscriptBox["\[CapitalDelta]\[Lambda]", "2"]]}],
      Short[#, 2]& ],
     FrameMargins->5],
    Editable -> False], "]"}],
  InterpretTemplate[
  FittedModel[{
    "Nonlinear", {$CellContext`a0 -> 7.160685697834249*^-6, $CellContext`a2 -> 
      3.4039377125888695`*^-21, $CellContext`a4 -> 
      5.989340642858098*^-41}, {{$CellContext`\[CapitalDelta]\[Lambda]}, \
$CellContext`a0 + $CellContext`a4 $CellContext`\[CapitalDelta]\[Lambda]^(-4) + \
$CellContext`a2 $CellContext`\[CapitalDelta]\[Lambda]^(-2)}}, {1}, {{
    6.324339247612442*^-10, 0.008901179185171082}, {8.432474691403513*^-10, 
    0.004886921905584123}, {9.48654660601278*^-10, 0.003839724354387525}, {
    1.0540621315840326`*^-9, 0.0031415926535897933`}, {
    2.1081522151575883`*^-9, 0.0008726646259971648}, {3.162270251823429*^-9, 
    0.00034906585039886593`}, {4.216416242684318*^-9, 
    0.00017453292519943296`}, {8.433279770474655*^-9, 0.}}, 
    Function[Null, 
     Internal`LocalizedBlock[{$CellContext`a0, $CellContext`a2, \
$CellContext`a4, $CellContext`\[CapitalDelta]\[Lambda]}, #], {HoldAll}]]& ],
  Editable->False,
  SelectWithContents->True,
  Selectable->True]], "Output",
 CellChangeTimes->{{3.7398978677089915`*^9, 3.7398978865588474`*^9}, 
   3.7398981535389423`*^9, {3.7398999800739307`*^9, 3.739899991211528*^9}, 
   3.739901442580881*^9, 3.7399023829853845`*^9, {3.7399601801999483`*^9, 
   3.739960189665009*^9}, 3.739963670731929*^9, 3.7402218359920397`*^9, 
   3.740239193832302*^9, 3.7402507232094307`*^9, {3.7403106689248905`*^9, 
   3.7403106709875283`*^9}, 3.740310962328051*^9, {3.740311082334305*^9, 
   3.740311111930023*^9}, {3.7403116054121017`*^9, 3.740311632476406*^9}, 
   3.740314846254912*^9, {3.7403272555081406`*^9, 3.740327282713081*^9}, 
   3.740327317762294*^9},ExpressionUUID->"423173fe-e8f6-40be-a036-\
3c03f18eef16"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"a0", "\[Rule]", "7.160685697834249`*^-6"}], ",", 
   RowBox[{"a2", "\[Rule]", "3.4039377125888695`*^-21"}], ",", 
   RowBox[{"a4", "\[Rule]", "5.989340642858098`*^-41"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7398978677089915`*^9, 3.7398978865588474`*^9}, 
   3.7398981535389423`*^9, {3.7398999800739307`*^9, 3.739899991211528*^9}, 
   3.739901442580881*^9, 3.7399023829853845`*^9, {3.7399601801999483`*^9, 
   3.739960189665009*^9}, 3.739963670731929*^9, 3.7402218359920397`*^9, 
   3.740239193832302*^9, 3.7402507232094307`*^9, {3.7403106689248905`*^9, 
   3.7403106709875283`*^9}, 3.740310962328051*^9, {3.740311082334305*^9, 
   3.740311111930023*^9}, {3.7403116054121017`*^9, 3.740311632476406*^9}, 
   3.740314846254912*^9, {3.7403272555081406`*^9, 3.740327282713081*^9}, 
   3.74032731777792*^9},ExpressionUUID->"9c4e5d44-4158-4408-b0da-\
3f8a73e69008"],

Cell[BoxData["9.462278791977113`*^10"], "Output",
 CellChangeTimes->{{3.7398978677089915`*^9, 3.7398978865588474`*^9}, 
   3.7398981535389423`*^9, {3.7398999800739307`*^9, 3.739899991211528*^9}, 
   3.739901442580881*^9, 3.7399023829853845`*^9, {3.7399601801999483`*^9, 
   3.739960189665009*^9}, 3.739963670731929*^9, 3.7402218359920397`*^9, 
   3.740239193832302*^9, 3.7402507232094307`*^9, {3.7403106689248905`*^9, 
   3.7403106709875283`*^9}, 3.740310962328051*^9, {3.740311082334305*^9, 
   3.740311111930023*^9}, {3.7403116054121017`*^9, 3.740311632476406*^9}, 
   3.740314846254912*^9, {3.7403272555081406`*^9, 3.740327282713081*^9}, 
   3.74032731777792*^9},ExpressionUUID->"f448778a-7ad0-4618-9707-\
65b58f213b99"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1264, 951},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 182, 3, 67, "Section",ExpressionUUID->"3325b93f-79a1-4d3b-a9bc-058ed70576c9"],
Cell[CellGroupData[{
Cell[787, 29, 4222, 81, 162, "Input",ExpressionUUID->"f56046ef-d6db-4932-a120-404537e22800"],
Cell[5012, 112, 5908, 104, 394, "Output",ExpressionUUID->"0a9f46ec-b607-41c1-ae09-24fbe45b368d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10957, 221, 6209, 99, 105, "Input",ExpressionUUID->"3c4903f5-9cda-4077-8e71-1f494913a4dc"],
Cell[17169, 322, 1776, 28, 90, "Output",ExpressionUUID->"233a8c78-3394-4b52-92ec-47578b6d1406"],
Cell[18948, 352, 1027, 15, 32, "Output",ExpressionUUID->"bbe98571-2d22-4ce0-9e1f-0a423855eecc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20012, 372, 131, 3, 28, "Input",ExpressionUUID->"4a4b5116-13d7-47e6-b83a-8114304a1f0a"],
Cell[20146, 377, 154, 3, 32, "Output",ExpressionUUID->"05f3c627-0788-4fa0-a108-b557b1f2f063"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[20349, 386, 177, 3, 53, "Section",ExpressionUUID->"dca3300d-6598-47cb-85f7-97292b1c450f"],
Cell[CellGroupData[{
Cell[20551, 393, 154422, 3648, 12937, "Input",ExpressionUUID->"8dcca340-e825-4b53-8121-13aa353b7974",
 InitializationCell->True],
Cell[174976, 4043, 1860, 27, 52, "Output",ExpressionUUID->"343d4036-b006-434c-a7c2-466e9cda3367"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[176885, 4076, 176, 3, 53, "Section",ExpressionUUID->"28b19adf-29c5-49ee-9241-1cb5f0e4f388"],
Cell[177064, 4081, 46128, 1065, 3800, "Input",ExpressionUUID->"81f57f58-14cc-49ad-9ae8-edf2787a670a",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[223229, 5151, 180, 3, 53, "Section",ExpressionUUID->"ba54492e-d9cf-4ba6-886b-5339943d2580"],
Cell[223412, 5156, 20498, 471, 1619, "Input",ExpressionUUID->"ba38586e-2232-4d9c-b041-fcf42d7bcf4d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[243947, 5632, 173, 3, 53, "Section",ExpressionUUID->"eb5f1899-b825-43da-9ba0-ef66f79c9eb9"],
Cell[244123, 5637, 22459, 529, 2097, "Input",ExpressionUUID->"5c12a4bf-58aa-4df4-93bd-9d5fa0a247bd",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[266619, 6171, 230, 4, 53, "Section",ExpressionUUID->"e0b67700-322a-4b80-8d38-0df53e9d9d5d"],
Cell[266852, 6177, 2017, 38, 162, "Input",ExpressionUUID->"1ab52b34-9409-402b-9592-ed24d770ab06"]
}, Closed]],
Cell[CellGroupData[{
Cell[268906, 6220, 201, 3, 53, "Section",ExpressionUUID->"4a9c2b7c-c554-433c-955d-4dbe98ce5998"],
Cell[269110, 6225, 4025, 102, 219, "Input",ExpressionUUID->"468ef7dc-f8d6-444b-9b42-c27cd689cf01"]
}, Open  ]],
Cell[CellGroupData[{
Cell[273172, 6332, 229, 4, 67, "Section",ExpressionUUID->"92adc8ad-0473-48bb-9717-446e7d0ca705"],
Cell[273404, 6338, 1267, 30, 75, "Input",ExpressionUUID->"73c0b67e-c523-4a63-9be5-8965a9b1b540"],
Cell[274674, 6370, 4214, 101, 438, "Input",ExpressionUUID->"5a79e7ec-0d1c-4ea4-81ce-7d69cf977774"],
Cell[CellGroupData[{
Cell[278913, 6475, 400, 6, 67, "Input",ExpressionUUID->"eb13a117-d23a-45b2-b1f0-0122c6959d09"],
Cell[279316, 6483, 666, 10, 32, "Output",ExpressionUUID->"5f7fe9cb-03b9-4ea6-a7dd-c5e47781f5a3"],
Cell[279985, 6495, 666, 10, 32, "Output",ExpressionUUID->"4a9d7e33-c6c4-4294-8114-30dc1c27e8ca"],
Cell[280654, 6507, 666, 10, 32, "Output",ExpressionUUID->"b69c7854-917a-461d-b991-2921e691af16"]
}, Open  ]],
Cell[CellGroupData[{
Cell[281357, 6522, 1708, 43, 48, "Input",ExpressionUUID->"fba5a893-bb26-47b1-807a-d2ff8f894efe"],
Cell[283068, 6567, 1423, 37, 57, "Output",ExpressionUUID->"ad231292-27f4-4287-9301-ac73076f5348"]
}, Open  ]],
Cell[CellGroupData[{
Cell[284528, 6609, 2352, 60, 219, "Input",ExpressionUUID->"f60718be-7448-4de1-869e-f05bcd5ecc25"],
Cell[286883, 6671, 2508, 55, 77, "Output",ExpressionUUID->"ef5361ce-b71b-4709-a8c2-5c5f6f134e87"],
Cell[289394, 6728, 1063, 18, 35, "Output",ExpressionUUID->"5f9ace2c-13c9-494b-9f77-d5f8707c99e5"],
Cell[290460, 6748, 876, 13, 32, "Output",ExpressionUUID->"e34fd16e-9ccd-4dc3-8364-d4cbf646541c"],
Cell[291339, 6763, 2439, 53, 76, "Output",ExpressionUUID->"07b04abf-1083-450e-bcbe-f5aa33053c84"],
Cell[293781, 6818, 1062, 18, 35, "Output",ExpressionUUID->"67f0b69b-0d49-475d-a7ba-d8d135beaa9d"],
Cell[294846, 6838, 874, 13, 32, "Output",ExpressionUUID->"990e410d-ed04-49cd-be4d-6943ef418191"]
}, Open  ]],
Cell[CellGroupData[{
Cell[295757, 6856, 988, 21, 28, "Input",ExpressionUUID->"94e33514-4500-4524-b64e-7ec96653cc51"],
Cell[296748, 6879, 975, 28, 57, "Output",ExpressionUUID->"835bc56f-ff9c-4cc5-8bff-f3ac33a3e4a1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[297760, 6912, 1249, 31, 124, "Input",ExpressionUUID->"642ad94b-4e92-4c25-bf56-b9a41b5a3545"],
Cell[299012, 6945, 2147, 42, 72, "Output",ExpressionUUID->"423173fe-e8f6-40be-a036-3c03f18eef16"],
Cell[301162, 6989, 916, 15, 35, "Output",ExpressionUUID->"9c4e5d44-4158-4408-b0da-3f8a73e69008"],
Cell[302081, 7006, 723, 10, 32, "Output",ExpressionUUID->"f448778a-7ad0-4618-9707-65b58f213b99"]
}, Open  ]]
}, Open  ]]
}
]
*)

