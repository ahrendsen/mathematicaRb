(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    327138,       8222]
NotebookOptionsPosition[    291696,       7606]
NotebookOutlinePosition[    292146,       7625]
CellTagsIndexPosition[    292103,       7622]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Header comments", "Section",ExpressionUUID->"208c6ac7-148a-4bd3-9797-2677b1b2219a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{":", 
    RowBox[{"Title", ":", " ", "FigGeometry"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{":", 
    RowBox[{"Context", ":", " ", "SciDraw`"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{":", 
    RowBox[{"Summary", ":", " ", 
     RowBox[{
     "Geometry", " ", "utilities", " ", "needed", " ", "by", " ", "figure", 
      " ", "objects"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{":", 
     RowBox[{"Author", ":", " ", 
      RowBox[{"Mark", " ", 
       RowBox[{"A", ".", " ", "Caprio"}]}]}]}], ",", " ", 
    RowBox[{"Department", " ", "of", " ", "Physics"}], ",", " ", 
    RowBox[{"University", " ", "of", " ", "Notre", " ", "Dame"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{":", 
     RowBox[{"Copyright", ":", " ", 
      RowBox[{"Copyright", " ", "FIGYEAR"}]}]}], ",", " ", 
    RowBox[{"Mark", " ", 
     RowBox[{"A", ".", " ", "Caprio"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{":", 
    RowBox[{"Package", " ", 
     RowBox[{"Version", ":", " ", "FIGVERSION"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{":", 
    RowBox[{"Mathematica", " ", 
     RowBox[{"Version", ":", " ", "MATHVERSION"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{":", 
    RowBox[{"Discussion", ":", " ", "FIGDISCUSSION"}]}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{":", 
    RowBox[{"History", ":", " ", 
     RowBox[{"See", " ", "main", " ", "package", " ", 
      RowBox[{"file", "."}]}]}]}], " ", "*)"}]}]], "Input",
 InitializationCell->True,
 AutoIndent->False,
 CellChangeTimes->{{3.395093723328125*^9, 3.39509375184375*^9}, {
   3.398545735296875*^9, 3.39854574365625*^9}, 3.398799700609375*^9, {
   3.43024739209375*^9, 3.43024739990625*^9}, 3.430247813015625*^9, {
   3.436819738734375*^9, 3.436819746828125*^9}, 3.436820195484375*^9, {
   3.4439959535*^9, 3.4439959773125*^9}, {3.471089562875*^9, 
   3.471089568359375*^9}, {3.471089636203125*^9, 3.471089639046875*^9}, {
   3.48681044459375*^9, 3.4868104458125*^9}, {3.489687811140625*^9, 
   3.489687812484375*^9}, {3.497222348765625*^9, 3.497222354953125*^9}, 
   3.497224390546875*^9, {3.497299514859375*^9, 3.497299515046875*^9}, {
   3.49903536659375*^9, 3.49903536784375*^9}, {3.503265433671875*^9, 
   3.5032654415*^9}, {3.50612390383225*^9, 3.5061239087385*^9}, 
   3.507509920109375*^9, {3.51481857221875*^9, 3.514818754140625*^9}, 
   3.514822657671875*^9, {3.514823216234375*^9, 3.51482323709375*^9}, {
   3.51482326921875*^9, 3.514823311671875*^9}, {3.514823375546875*^9, 
   3.514823396890625*^9}, {3.5150157615*^9, 3.515015802921875*^9}, 
   3.515278625625*^9, {3.515611052734375*^9, 3.515611062421875*^9}},
 LanguageCategory->
  "NaturalLanguage",ExpressionUUID->"e26d7ff7-95c1-4171-a54d-cbf17ff9b91f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Begin package", "Section",ExpressionUUID->"7a78406e-7fb0-4e01-9a1d-e8bdf654019b"],

Cell[CellGroupData[{

Cell["Package context definition", "Subsection",ExpressionUUID->"b95caa02-f4a5-4794-800a-7b930824d15e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeginPackage", "[", 
   RowBox[{"\"\<SciDraw`\>\"", ",", "SciDraw`Private`$ExternalContexts"}], 
   "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.395087747453125*^9, 3.39508775096875*^9}, {
   3.39509064290625*^9, 3.395090643234375*^9}, 3.395090710546875*^9, {
   3.395091175015625*^9, 3.395091179703125*^9}, {3.395093472375*^9, 
   3.39509347784375*^9}, {3.395093608140625*^9, 3.3950936085*^9}, {
   3.395519039875*^9, 3.395519061546875*^9}, {3.495041989453125*^9, 
   3.495042010953125*^9}, {3.495042158078125*^9, 3.495042163671875*^9}, {
   3.497222416421875*^9, 3.497222462578125*^9}, {3.497222963890625*^9, 
   3.497222994640625*^9}, 3.497223030953125*^9, {3.514818766734375*^9, 
   3.514818800625*^9}, {3.5148197104375*^9, 3.514819710671875*^9}, {
   3.514819841546875*^9, 3.51481994284375*^9}, {3.514819979578125*^9, 
   3.514820025046875*^9}, {3.5148201316875*^9, 3.514820154671875*^9}, {
   3.51482025234375*^9, 3.514820275171875*^9}, {3.514820309703125*^9, 
   3.514820406921875*^9}, {3.51482051775*^9, 3.514820571328125*^9}, {
   3.514820843296875*^9, 3.51482087146875*^9}, 3.51482140903125*^9, {
   3.514821446859375*^9, 3.514821449890625*^9}, 3.514821641390625*^9, {
   3.514821674609375*^9, 3.514821798390625*^9}, {3.514823407859375*^9, 
   3.514823433140625*^9}, 3.51501104184375*^9, 3.515275343*^9, {
   3.515276331390625*^9, 3.51527633303125*^9}, {3.51542275479725*^9, 
   3.515422755141*^9}},ExpressionUUID->"89275891-c9ce-4dba-98c1-8da5fdce3f76"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Unprotect", "[", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"$Context", "<>", "\"\<*\>\""}], "]"}], "]"}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"a0831773-ee1b-4863-b544-d0cd8c29fc9f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Begin private context", "Subsection",ExpressionUUID->"db87bdc9-5fc4-48d5-ad56-38892d5f9fe8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.514823442859375*^9, 
  3.5148234431875*^9}},ExpressionUUID->"39efb280-7684-42f3-8dcc-af9689130a29"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dependencies", "Subsection",
 CellChangeTimes->{{3.514821147359375*^9, 
  3.51482114978125*^9}},ExpressionUUID->"3e656e35-a0e5-4284-84eb-\
9d8e6eaa7558"],

Cell[BoxData[""], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51482113128125*^9, 3.514821158515625*^9}, {
  3.514823452421875*^9, 
  3.51482349575*^9}},ExpressionUUID->"19346fc8-0241-4a7a-83b5-de1aa09d4fb3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Scalar/range/region arithmetic", "Section",
 CellChangeTimes->{{3.515362381890625*^9, 3.51536238459375*^9}, {
  3.51536254696875*^9, 3.515362547921875*^9}, {3.5154385657035*^9, 
  3.515438597937875*^9}, {3.5160372882395*^9, 
  3.516037292661375*^9}},ExpressionUUID->"a78321a6-1c5b-4c17-be82-\
b6fcc8d3e5db"],

Cell[CellGroupData[{

Cell["Single parameter upgrades", "Subsection",
 CellChangeTimes->{{3.51552677265625*^9, 
  3.515526788390625*^9}},ExpressionUUID->"ba6b3160-b54c-456b-8080-\
be3b64e63276"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ScalarParameterPattern", "=", 
   RowBox[{"None", "|", 
    RowBox[{"(", 
     RowBox[{"_", "?", "NumericQ"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NonNegativeScalarParameterPattern", "=", 
   RowBox[{"None", "|", "NonNegativePattern"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5156118653125*^9, 
  3.515611897578125*^9}},ExpressionUUID->"85c9dda3-1a9f-444c-a46c-\
79f79f042562"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"UpgradeScalar", "[", "None", "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UpgradeScalar", "[", 
    RowBox[{"x_", "?", "NumericQ"}], "]"}], ":=", "x"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515526790796875*^9, 
  3.51552681421875*^9}},ExpressionUUID->"51a029bd-8f36-4bc6-8a38-\
9717b4f3f83d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Interval rescaling", "Subsection",
 CellChangeTimes->{{3.51568050853125*^9, 
  3.515680510921875*^9}},ExpressionUUID->"1ad1c096-caa8-43dd-a9c1-\
eee94709351c"],

Cell["\<\
lambda wrapper for Rescale[u,{u1,u2},{v1,v2}]
   returns v1+(u-u1)/(u2-u1)*(v2-v1)\
\>", "Text",
 CellChangeTimes->{{3.518435352046875*^9, 3.51843535471875*^9}, {
  3.51843540059375*^9, 3.518435438921875*^9}, {3.5830763298686514`*^9, 
  3.5830763309086523`*^9}},ExpressionUUID->"140798ec-6970-442c-b221-\
bd29ca833664"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RescaleInterval", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"u1_", "?", "NumericQ"}], ",", 
        RowBox[{"u2_", "?", "NumericQ"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"v1_", "?", "NumericQ"}], ",", 
        RowBox[{"v2_", "?", "NumericQ"}]}], "}"}]}], "]"}], "[", 
    RowBox[{"u_", "?", "NumericQ"}], "]"}], ":=", 
   RowBox[{"Rescale", "[", 
    RowBox[{"u", ",", 
     RowBox[{"{", 
      RowBox[{"u1", ",", "u2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v1", ",", "v2"}], "}"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515680514625*^9, 3.515680567875*^9}, {
  3.518435429171875*^9, 
  3.51843543103125*^9}},ExpressionUUID->"f3390b97-879a-4d47-abb0-\
cabb04cf15c3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Range testing", "Subsection",
 CellChangeTimes->{{3.5155270585625*^9, 
  3.51552706028125*^9}},ExpressionUUID->"735cca9f-ea7e-4743-8715-\
b248d5f8b27b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"InRange", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1_", ",", "x2_"}], "}"}], ",", "x_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"x1", "\[LessEqual]", "x"}], ")"}], "&&", 
    RowBox[{"(", 
     RowBox[{"x", "\[LessEqual]", "x2"}], ")"}]}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"65cb372f-6c9e-4a7a-88c6-e34525072afe"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"InRange", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1_", ",", "x2_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y1_", ",", "y2_"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_"}], "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"InRange", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1", ",", "x2"}], "}"}], ",", "x"}], "]"}], "&&", 
    RowBox[{"InRange", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"y1", ",", "y2"}], "}"}], ",", "y"}], "]"}]}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5155270635*^9, 3.51552707109375*^9}, {
  3.52045229409375*^9, 
  3.52045229459375*^9}},ExpressionUUID->"f80975ef-e2de-46b5-bc3f-\
2801669f6829"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Interval extension by coordinate amount", "Subsection",
 CellChangeTimes->{{3.51536255090625*^9, 3.515362566421875*^9}, {
  3.51536267196875*^9, 3.515362677078125*^9}, {3.51604182739575*^9, 
  3.516041828661375*^9}},ExpressionUUID->"5f11e87f-04e0-4c55-b2fe-\
23ae9c55e93d"],

Cell["1-dimensional", "Text",
 CellChangeTimes->{{3.515796781015625*^9, 
  3.515796782875*^9}},ExpressionUUID->"a555013a-509d-468e-96a1-d91caf55df81"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ExtendInterval", "[", 
    RowBox[{
     RowBox[{"PRange", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"PDiff", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"Mode", ":", "Absolute"}]}], "]"}], ":=", 
   RowBox[{"PRange", "+", 
    RowBox[{"PDiff", "*", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"+", "1"}]}], "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtendInterval", "[", 
    RowBox[{
     RowBox[{"PRange", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"PFrac", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"Mode", ":", "Scaled"}]}], "]"}], ":=", 
   RowBox[{"PRange", "+", 
    RowBox[{"PFrac", "*", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"+", "1"}]}], "}"}], "*", 
     RowBox[{"-", 
      RowBox[{"Subtract", "@@", "PRange"}]}]}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515362576421875*^9, 3.515362581484375*^9}, {
  3.51536268640625*^9, 3.51536270134375*^9}, {3.515362838828125*^9, 
  3.51536286996875*^9}, {3.515797065078125*^9, 3.515797076484375*^9}, {
  3.516456354671875*^9, 3.51645636353125*^9}, {3.5830783443606825`*^9, 
  3.5830783447356834`*^9}},ExpressionUUID->"67eb8c8a-803a-4a99-a339-\
b3748cfb4638"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Vector geometry", "Section",
 CellChangeTimes->{{3.515617733140625*^9, 
  3.51561773625*^9}},ExpressionUUID->"6771cbc5-8f43-4500-8d5e-991ca920dddc"],

Cell[CellGroupData[{

Cell["Trigonometry for 2D vectors", "Subsection",ExpressionUUID->"b3e6b489-3718-4518-b422-adc9943cda15"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"VectorLength", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x_", "?", "NumericQ"}], ",", 
      RowBox[{"y_", "?", "NumericQ"}]}], "}"}], "]"}], ":=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"x", "^", "2"}], "+", 
     RowBox[{"y", "^", "2"}]}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"VectorArcTan", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x_", "?", "NumericQ"}], ",", 
      RowBox[{"y_", "?", "NumericQ"}]}], "}"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], "==", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], ",", "0.", ",", 
     RowBox[{"ArcTan", "[", 
      RowBox[{"x", ",", "y"}], "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51516775459375*^9, 
  3.5151677566875*^9}},ExpressionUUID->"6ccb850e-fe47-4485-ab46-05a63a47c0d0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SegmentLength", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p1", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
      RowBox[{"p2", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}]}]}], "}"}], "]"}], ":=", 
   RowBox[{"VectorLength", "[", 
    RowBox[{"p2", "-", "p1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SegmentTangent", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p1", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
      RowBox[{"p2", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}]}]}], "}"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"p2", "-", "p1"}], ")"}], "/", 
    RowBox[{"VectorLength", "[", 
     RowBox[{"p2", "-", "p1"}], "]"}]}]}], ";", 
  RowBox[{
   RowBox[{"SegmentArcTan", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p1", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
      RowBox[{"p2", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}]}]}], "}"}], "]"}], ":=", 
   RowBox[{"VectorArcTan", "[", 
    RowBox[{"p2", "-", "p1"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51516811021875*^9, 3.51516814440625*^9}, {
  3.519724204109375*^9, 
  3.519724222421875*^9}},ExpressionUUID->"a7bb0fad-f054-4d23-9a2b-\
a2f71d7e5e03"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FromPolar", "[", 
    RowBox[{"{", 
     RowBox[{"rho_", ",", "phi_"}], "}"}], "]"}], ":=", 
   RowBox[{"rho", "*", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "phi", "]"}], ",", 
      RowBox[{"Sin", "[", "phi", "]"}]}], "}"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51553846121875*^9, 
  3.515538463828125*^9}},ExpressionUUID->"c1a3b33b-4bce-48a4-9ece-\
7aa5a32b23ae"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Segment interpolation", "Subsection",
 CellChangeTimes->{{3.515854402640625*^9, 
  3.51585440940625*^9}},ExpressionUUID->"c63da412-2fca-4adb-84f5-\
e7e6bbba9712"],

Cell["Null segment", "Text",
 CellChangeTimes->{{3.51585465534375*^9, 
  3.515854656921875*^9}},ExpressionUUID->"57ffcbc7-638c-4622-bc3c-\
a85721a419c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InterpolateSegment", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"p1", ":", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"_", "?", "NumericQ"}], ",", 
            RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
         RowBox[{"p2", ":", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"_", "?", "NumericQ"}], ",", 
            RowBox[{"_", "?", "NumericQ"}]}], "}"}]}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Reference", ":", 
       RowBox[{"(", 
        RowBox[{"Tail", "|", "Center", "|", "Head"}], ")"}]}], ",", 
      RowBox[{"Mode", ":", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Absolute", "|", "Scaled"}], ")"}], ":", "Scaled"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"x_", "?", "NumericQ"}]}], "\[IndentingNewLine]", "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Chop", "[", 
       RowBox[{"SegmentLength", "[", "s", "]"}], "]"}], "\[Equal]", "0"}], 
     ")"}]}], ":=", "p1"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515854413203125*^9, 3.515854436390625*^9}, {
  3.515854482703125*^9, 3.515854538578125*^9}, {3.51585457090625*^9, 
  3.51585464740625*^9}, {3.5158546831875*^9, 
  3.515854702359375*^9}},ExpressionUUID->"8963bc36-24f8-4e14-806f-\
85e8c737eda8"],

Cell["\<\
Generic segment
\tCurve parameter is always in the *forward* direction (tail to head).
\tMappings for scaled coordinates:
\t\tTail [0,+1] -> [p1,p2]
\t\tCenter [-1,+1] -> [p1,p2] -- so units are scaled by factor of two \
relative to other cases, consistent with \[OpenCurlyDoubleQuote]offset\
\[CloseCurlyDoubleQuote] relative position
\t\tHead [-1,0] -> [p1,p2]\
\>", "Text",
 CellChangeTimes->{{3.515854660328125*^9, 3.51585466196875*^9}, {
  3.515854857609375*^9, 3.5158549445625*^9}, {3.515855273109375*^9, 
  3.515855285484375*^9}, {3.516554483421875*^9, 3.51655449028125*^9}, {
  3.5195627235625*^9, 
  3.5195627449375*^9}},ExpressionUUID->"d767bf86-d478-4b09-93d4-70c94aef7830"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InterpolateSegment", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"p1", ":", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"_", "?", "NumericQ"}], ",", 
            RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
         RowBox[{"p2", ":", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"_", "?", "NumericQ"}], ",", 
            RowBox[{"_", "?", "NumericQ"}]}], "}"}]}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Reference", ":", "Tail"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Mode", ":", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Absolute", "|", "Scaled"}], ")"}], ":", "Scaled"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"x_", "?", "NumericQ"}]}], "\[IndentingNewLine]", "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Chop", "[", 
       RowBox[{"SegmentLength", "[", "s", "]"}], "]"}], "!=", "0"}], ")"}]}], 
   ":=", 
   RowBox[{"p1", "+", 
    RowBox[{"x", "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"p2", "-", "p1"}], ")"}], "/", 
      RowBox[{"Switch", "[", 
       RowBox[{"Mode", ",", "Absolute", ",", 
        RowBox[{"SegmentLength", "[", "s", "]"}], ",", "Scaled", ",", "1"}], 
       "]"}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InterpolateSegment", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"p1", ":", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"_", "?", "NumericQ"}], ",", 
            RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
         RowBox[{"p2", ":", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"_", "?", "NumericQ"}], ",", 
            RowBox[{"_", "?", "NumericQ"}]}], "}"}]}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Reference", ":", "Center"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Mode", ":", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Absolute", "|", "Scaled"}], ")"}], ":", "Scaled"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"x_", "?", "NumericQ"}]}], "\[IndentingNewLine]", "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Chop", "[", 
       RowBox[{"SegmentLength", "[", "s", "]"}], "]"}], "!=", "0"}], ")"}]}], 
   ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"p2", "+", "p1"}], ")"}], "/", "2"}], "+", 
    RowBox[{"x", "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"p2", "-", "p1"}], ")"}], "/", 
      RowBox[{"Switch", "[", 
       RowBox[{"Mode", ",", "Absolute", ",", 
        RowBox[{"SegmentLength", "[", "s", "]"}], ",", "Scaled", ",", "2"}], 
       "]"}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InterpolateSegment", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"p1", ":", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"_", "?", "NumericQ"}], ",", 
            RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
         RowBox[{"p2", ":", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"_", "?", "NumericQ"}], ",", 
            RowBox[{"_", "?", "NumericQ"}]}], "}"}]}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Reference", ":", "Head"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Mode", ":", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Absolute", "|", "Scaled"}], ")"}], ":", "Scaled"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"x_", "?", "NumericQ"}]}], "\[IndentingNewLine]", "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Chop", "[", 
       RowBox[{"SegmentLength", "[", "s", "]"}], "]"}], "!=", "0"}], ")"}]}], 
   ":=", 
   RowBox[{"p2", "+", 
    RowBox[{"x", "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"p2", "-", "p1"}], ")"}], "/", 
      RowBox[{"Switch", "[", 
       RowBox[{"Mode", ",", "Absolute", ",", 
        RowBox[{"SegmentLength", "[", "s", "]"}], ",", "Scaled", ",", "1"}], 
       "]"}]}]}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51585466671875*^9, 3.515854669828125*^9}, {
   3.515854709953125*^9, 3.515854849453125*^9}, {3.515854962953125*^9, 
   3.5158550233125*^9}, 3.51655450759375*^9, {3.519562752203125*^9, 
   3.519562757796875*^9}},ExpressionUUID->"f330bd3e-41c3-4748-9548-\
e7d89a30ef7c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["XY pair geometry", "Section",
 CellChangeTimes->{{3.516037254661375*^9, 
  3.5160372584895*^9}},ExpressionUUID->"701badaa-a2b8-4af2-a2ed-8e651dfb587d"],

Cell[CellGroupData[{

Cell["Numerical pair pattern", "Subsection",
 CellChangeTimes->{{3.515438631812875*^9, 3.515438636281625*^9}, {
  3.516037225848875*^9, 
  3.516037231598875*^9}},ExpressionUUID->"17d47039-8a8f-45f0-b3ea-\
287fa227e893"],

Cell["\<\
Explicit numerical {x,y} pair
Note: Text should use FigTextOffsetPattern instead, which allows the value \
Automatic as well.\
\>", "Text",
 CellChangeTimes->{{3.51568165675*^9, 3.515681698171875*^9}, {
  3.5156817973125*^9, 
  3.515681809296875*^9}},ExpressionUUID->"072b3020-da10-4dd6-8dfa-\
aa3e6b64778d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NumericalPairPattern", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"_", "?", "NumericQ"}], ",", 
     RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515681661859375*^9, 3.51568166925*^9}, {
   3.51568173871875*^9, 3.515681740046875*^9}, 
   3.515681791296875*^9},ExpressionUUID->"d61b79ee-8eb8-4373-aafc-\
8cf040508b24"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Pair parameter upgrades", "Subsection",
 CellChangeTimes->{
  3.516037234848875*^9},ExpressionUUID->"9a669006-c628-47ab-ba97-\
c1178cb1343e"],

Cell["\<\
Generic upgrade to equal values -- appropriate for radii and most types of \
nonnumeric parameters\
\>", "Text",
 CellChangeTimes->{{3.515525280671875*^9, 
  3.515525299515625*^9}},ExpressionUUID->"1177a4ed-63f7-4e20-8c10-\
7ea0f33d46a0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"UpgradePair", "[", 
    RowBox[{"a", ":", "NonListPattern"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"a", ",", "a"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UpgradePair", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", ":", "NonListPattern"}], ",", 
      RowBox[{"y", ":", "NonListPattern"}]}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515438642625375*^9, 3.51543870473475*^9}, 
   3.51544740729725*^9, {3.51552508746875*^9, 3.5155250899375*^9}, {
   3.515610756890625*^9, 
   3.51561077403125*^9}},ExpressionUUID->"615afd7c-d3f7-454d-ac3c-\
ff11178b1421"],

Cell["\<\
Upgrade to default horizontal or default vertical numerical pair -- as in \
classic Nudge behavior\
\>", "Text",
 CellChangeTimes->{{3.51552530759375*^9, 
  3.515525343234375*^9}},ExpressionUUID->"ab37621b-20d3-45e9-9001-\
742063a90d22"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"IntervalParametersPattern", "=", 
   RowBox[{"(", 
    RowBox[{"None", "|", 
     RowBox[{"(", 
      RowBox[{"_", "?", "NumericQ"}], ")"}], "|", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"_", "?", "NumericQ"}], ")"}], ",", 
       RowBox[{"(", 
        RowBox[{"_", "?", "NumericQ"}], ")"}]}], "}"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NonNegativeIntervalParametersPattern", "=", 
   RowBox[{"(", 
    RowBox[{"None", "|", "NonNegativePattern", "|", 
     RowBox[{"{", 
      RowBox[{"NonNegativePattern", ",", "NonNegativePattern"}], "}"}]}], 
    ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515527647796875*^9, 3.51552765653125*^9}, {
  3.51561045678125*^9, 
  3.515610472046875*^9}},ExpressionUUID->"9a131ad3-411d-492b-b55a-\
bad3241e1600"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"UpgradePairEqual", "[", "None", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UpgradePairEqual", "[", 
    RowBox[{"x_", "?", "NumericQ"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "x"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UpgradePairEqual", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x_", "?", "NumericQ"}], ",", 
      RowBox[{"y_", "?", "NumericQ"}]}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515438642625375*^9, 3.51543870473475*^9}, 
   3.51544740729725*^9, {3.515525069765625*^9, 3.515525171546875*^9}, {
   3.515610823484375*^9, 
   3.515610835984375*^9}},ExpressionUUID->"fea616f4-e1a3-4978-b7c4-\
a62cc17da301"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"UpgradePairHorizontal", "[", "None", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UpgradePairHorizontal", "[", 
    RowBox[{"x_", "?", "NumericQ"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UpgradePairHorizontal", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x_", "?", "NumericQ"}], ",", 
      RowBox[{"y_", "?", "NumericQ"}]}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515438642625375*^9, 3.51543870473475*^9}, 
   3.51544740729725*^9, {3.515525069765625*^9, 
   3.515525171546875*^9}},ExpressionUUID->"4ee36305-0fc4-4a40-a984-\
11b2b4d401ac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"UpgradePairVertical", "[", "None", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UpgradePairVertical", "[", 
    RowBox[{"y_", "?", "NumericQ"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "y"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UpgradePairVertical", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x_", "?", "NumericQ"}], ",", 
      RowBox[{"y_", "?", "NumericQ"}]}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515438642625375*^9, 3.51543870473475*^9}, 
   3.51544740729725*^9, {3.515525069765625*^9, 3.5155250950625*^9}, {
   3.51552514259375*^9, 
   3.51552518078125*^9}},ExpressionUUID->"2e628984-f7c6-4606-afbd-\
9d2b3ecbaa0b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Point/anchor geometry", "Section",
 CellChangeTimes->{{3.51516648646875*^9, 3.5151664916875*^9}, {
  3.515450145094125*^9, 3.515450145766*^9}, {3.515956528703125*^9, 
  3.515956529765625*^9}},ExpressionUUID->"0c3ddaf8-aaac-4118-9599-\
766acce470e1"],

Cell[CellGroupData[{

Cell["Point pattern", "Subsection",
 CellChangeTimes->{{3.51543946635975*^9, 3.515439471687875*^9}, 
   3.515439602219125*^9, {3.515450693812875*^9, 3.515450694531625*^9}, {
   3.51561552875*^9, 3.515615530546875*^9}, 3.515953613125*^9, 
   3.515956525796875*^9},ExpressionUUID->"26685b6d-14d6-4671-bc81-\
dc03a854be21"],

Cell["\<\
Point specification (including anchor name or object anchor generation).\
\>", "Text",
 CellChangeTimes->{{3.515439488187875*^9, 3.5154395102035*^9}, {
  3.515530327703125*^9, 3.515530335078125*^9}, {3.51553036696875*^9, 
  3.515530367734375*^9}, {3.515530668171875*^9, 3.515530676734375*^9}, {
  3.515608246390625*^9, 3.515608283140625*^9}, {3.515685208359375*^9, 
  3.515685209734375*^9}},ExpressionUUID->"254c29a8-93ed-4ba4-a724-\
b46d210e4555"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FigCoordinatePointPattern", "=", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"_", "?", "NumericQ"}], ")"}], "|", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Scaled", "|", "Canvas"}], ")"}], "[", 
         RowBox[{"(", 
          RowBox[{"_", "?", "NumericQ"}], ")"}], "]"}]}], ")"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"_", "?", "NumericQ"}], ")"}], "|", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Scaled", "|", "Canvas"}], ")"}], "[", 
         RowBox[{"(", 
          RowBox[{"_", "?", "NumericQ"}], ")"}], "]"}]}], ")"}]}], 
     "\[IndentingNewLine]", "}"}], "|", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Scaled", "|", "Canvas"}], ")"}], "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"_", "?", "NumericQ"}], ",", 
       RowBox[{"_", "?", "NumericQ"}]}], "}"}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.53653109659375*^9, 3.5365311166875*^9}, {
  3.53653196265625*^9, 
  3.536531987046875*^9}},ExpressionUUID->"c7adb5bb-5daf-46a4-a7ca-\
b912a139f3c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FigPointPattern", "=", 
   RowBox[{"(", 
    RowBox[{"FigCoordinatePointPattern", "|", 
     RowBox[{"ObjectPattern", "[", "FigAnchor", "]"}], "|", 
     RowBox[{"ObjectNamePattern", "[", "FigAnchor", "]"}]}], ")"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515439472969125*^9, 3.51543948604725*^9}, {
   3.515450698281625*^9, 3.515450701687875*^9}, {3.515530339265625*^9, 
   3.5155303765*^9}, {3.515530557765625*^9, 3.515530569203125*^9}, {
   3.5155975314375*^9, 3.51559754925*^9}, {3.515597792984375*^9, 
   3.51559779728125*^9}, {3.515598279671875*^9, 3.515598286234375*^9}, {
   3.515613950328125*^9, 3.51561395671875*^9}, 3.515615579109375*^9, {
   3.515615903859375*^9, 3.515615912078125*^9}, {3.51561688265625*^9, 
   3.5156168859375*^9}, {3.515685177828125*^9, 3.515685200484375*^9}, 
   3.515883397828125*^9, 3.51810490809375*^9, {3.53653113275*^9, 
   3.5365311334375*^9}, {3.53653207609375*^9, 
   3.536532076421875*^9}},ExpressionUUID->"2b9073b4-f2fb-4d29-8712-\
d7852b520a9a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Point resolution", "Subsection",
 CellChangeTimes->{{3.5155389481875*^9, 3.5155389531875*^9}, {
  3.515616414640625*^9, 
  3.515616416671875*^9}},ExpressionUUID->"db0fc866-0139-4dd5-937d-\
292a826efeaa"],

Cell["\<\
Resolves a point/anchor specification into canvas coordinates.

Note: This function is technically not necessary, since any valid point \
specification can be converted to an anchor with FigAnchor[p], and then the \
point part of the anchor can be extracted.  However, this function is more \
direct for ordinary numerical points, in that it avoids unnecessary creation \
of anchors for these points.\
\>", "Text",
 CellChangeTimes->{{3.515541825421875*^9, 3.515541838140625*^9}, {
   3.5156001483125*^9, 3.515600176546875*^9}, {3.515600221875*^9, 
   3.515600281890625*^9}, {3.51560485615625*^9, 3.515604856515625*^9}, {
   3.515861223421875*^9, 3.51586124259375*^9}, 
   3.51801844496875*^9},ExpressionUUID->"a9e0ce27-3397-43b5-aaf2-\
badabab99033"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FigResolvePoint", "[", 
    RowBox[{"p", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"_", "?", "NumericQ"}], ",", 
       RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"CurrentWindow", "[", "]"}], "@", 
      RowBox[{"TFunction", "[", "]"}]}], ")"}], "@", "p"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolvePoint", "[", 
    RowBox[{"Canvas", "[", 
     RowBox[{"p", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "]"}], "]"}], ":=", "p"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolvePoint", "[", 
    RowBox[{"Scaled", "[", 
     RowBox[{"p", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"CurrentWindow", "[", "]"}], "@", 
      RowBox[{"ScaledTFunction", "[", "]"}]}], ")"}], "@", "p"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolvePoint", "[", 
    RowBox[{"a", ":", 
     RowBox[{"ObjectPattern", "[", "FigAnchor", "]"}]}], "]"}], ":=", 
   RowBox[{"a", "@", 
    RowBox[{"GetPoint", "[", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolvePoint", "[", 
    RowBox[{"n", ":", 
     RowBox[{"ObjectNamePattern", "[", "FigAnchor", "]"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Object", "[", "n", "]"}], "@", 
    RowBox[{"GetPoint", "[", "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.515541817625*^9, {3.515541908421875*^9, 3.515541912828125*^9}, {
   3.515541996375*^9, 3.515541998203125*^9}, {3.515597628171875*^9, 
   3.51559764675*^9}, {3.5155978139375*^9, 3.5155978360625*^9}, {
   3.51559791015625*^9, 3.515597910953125*^9}, 3.51560013915625*^9, 
   3.51560485446875*^9, {3.51561594209375*^9, 3.51561595153125*^9}, {
   3.515616120734375*^9, 3.515616383671875*^9}, {3.51578413475*^9, 
   3.515784134765625*^9}, 3.518018521875*^9, 
   3.5180188034375*^9},ExpressionUUID->"a81007ca-5aa6-4fa7-ad05-51d68f3c9603"],

Cell["Ad hoc treatment of hybrid coordinates", "Text",
 CellChangeTimes->{{3.5365308433125*^9, 3.536530862453125*^9}, 
   3.577552241511182*^9},ExpressionUUID->"bd1a1afe-2e51-4971-9bf2-\
eddd49549481"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigResolvePoint", "[", "\[IndentingNewLine]", 
    RowBox[{"p", ":", 
     RowBox[{"Except", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x", ":", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"_", "?", "NumericQ"}], ")"}], "|", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Scaled", "|", "Canvas"}], ")"}], "[", 
             RowBox[{"(", 
              RowBox[{"_", "?", "NumericQ"}], ")"}], "]"}]}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"y", ":", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"_", "?", "NumericQ"}], ")"}], "|", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Scaled", "|", "Canvas"}], ")"}], "[", 
             RowBox[{"(", 
              RowBox[{"_", "?", "NumericQ"}], ")"}], "]"}]}], ")"}]}]}], 
        "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"FigResolveCoordinate", "[", 
      RowBox[{"x", ",", "1"}], "]"}], ",", 
     RowBox[{"FigResolveCoordinate", "[", 
      RowBox[{"y", ",", "2"}], "]"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.53653087075*^9, 3.536530887890625*^9}, {
  3.536530960421875*^9, 
  3.536530998171875*^9}},ExpressionUUID->"edfa5353-75fb-4627-9270-\
54869d77fc7a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generic bounding box generation for point-like objects", "Subsection",
 CellChangeTimes->{{3.515166674140625*^9, 3.515166694546875*^9}, {
  3.51545023029725*^9, 3.5154502318285*^9}, {3.515616428796875*^9, 
  3.515616447625*^9}},ExpressionUUID->"51c9cb8d-2e80-4c85-89f3-0308a68f166a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigPointBoundingBox", "[", 
    RowBox[{"p", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x_", "?", "NumericQ"}], ",", 
       RowBox[{"y_", "?", "NumericQ"}]}], "}"}]}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "x"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "y"}], "}"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51516616575*^9, 3.51516620196875*^9}, {
   3.515166363734375*^9, 3.51516642103125*^9}, {3.5151665123125*^9, 
   3.51516652478125*^9}, 3.515167326484375*^9, {3.515167359171875*^9, 
   3.515167378671875*^9}, {3.515167540625*^9, 3.515167556453125*^9}, {
   3.51545042535975*^9, 3.515450461031625*^9}, 3.516039158067625*^9, 
   3.524070974171875*^9},ExpressionUUID->"67e826a6-767a-4695-a512-\
d1d24d6837e5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Displacement geometry", "Section",
 CellChangeTimes->{{3.515615972609375*^9, 3.515615975328125*^9}, {
  3.51568593528125*^9, 
  3.51568594096875*^9}},ExpressionUUID->"32e9363a-b8b2-4a2e-8668-\
2cad17879ad9"],

Cell["\<\
A \[OpenCurlyDoubleQuote]displacement\[CloseCurlyDoubleQuote] is a difference \
of positions, i.e., a vector describing a translation\
\>", "Text",
 CellChangeTimes->{{3.5830761548684063`*^9, 
  3.58307619338846*^9}},ExpressionUUID->"60396592-c283-4f82-804b-\
840748e65fcb"],

Cell[CellGroupData[{

Cell["Displacement patterns", "Subsection",
 CellChangeTimes->{{3.5156155039375*^9, 3.515615508109375*^9}, 
   3.515615550390625*^9},ExpressionUUID->"ef3078e0-94c1-46e3-98a9-\
1b568eaf78d8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FigDisplacementPattern", "=", 
   RowBox[{"None", "|", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}], "|", 
      RowBox[{"Scaled", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}], "]"}], "|", 
      RowBox[{"Canvas", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}], "]"}]}], ")"}], "|", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"_", "?", "NumericQ"}], ")"}], "|", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Scaled", "|", "Canvas"}], ")"}], "[", 
         RowBox[{"(", 
          RowBox[{"_", "?", "NumericQ"}], ")"}], "]"}]}], ")"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"_", "?", "NumericQ"}], ")"}], "|", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Scaled", "|", "Canvas"}], ")"}], "[", 
         RowBox[{"(", 
          RowBox[{"_", "?", "NumericQ"}], ")"}], "]"}]}], ")"}]}], 
     "\[IndentingNewLine]", "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigDisplacementSequencePattern", "[", "n_Integer", "]"}], ":=", 
   RowBox[{"Repeated", "[", 
    RowBox[{
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{"#", ",", "FigDisplacementPattern"}], "]"}], "&"}], ")"}]}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "Infinity"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigDisplacementSetPattern", "[", "n_Integer", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"Repeated", "[", 
     RowBox[{
      RowBox[{"_", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"#", ",", "FigDisplacementPattern"}], "]"}], "&"}], ")"}]}],
       ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "Infinity"}], "}"}]}], "]"}], "}"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51561556428125*^9, 3.515615591890625*^9}, {
  3.51561568934375*^9, 3.515615695046875*^9}, {3.51561684240625*^9, 
  3.515616847796875*^9}, {3.516284387*^9, 3.516284407734375*^9}, {
  3.520031935078125*^9, 3.520031936015625*^9}, {3.5775526127767015`*^9, 
  3.5775526158517056`*^9}},ExpressionUUID->"517bc679-d72d-4dc9-997d-\
a30da08dd9e7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["FigResolveDisplacement", "Subsection",
 CellChangeTimes->{{3.5155389481875*^9, 3.5155389531875*^9}, {
  3.51561598071875*^9, 
  3.51561598290625*^9}},ExpressionUUID->"caf9bb40-ecf0-4b37-a302-\
1380e7b71326"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveDisplacement", "[", "None", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveDisplacement", "[", 
    RowBox[{"d", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"_", "?", "NumericQ"}], ",", 
       RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"CurrentWindow", "[", "]"}], "@", 
      RowBox[{"DeltaTFunction", "[", "]"}]}], ")"}], "@", "d"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveDisplacement", "[", 
    RowBox[{"Canvas", "[", 
     RowBox[{"d", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "]"}], "]"}], ":=", "d"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveDisplacement", "[", 
    RowBox[{"Scaled", "[", 
     RowBox[{"d", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"CurrentWindow", "[", "]"}], "@", 
      RowBox[{"ScaledDeltaTFunction", "[", "]"}]}], ")"}], "@", "d"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.515541817625*^9, {3.515541908421875*^9, 3.515541912828125*^9}, {
   3.515541996375*^9, 3.515541998203125*^9}, {3.515597628171875*^9, 
   3.51559764675*^9}, {3.5155978139375*^9, 3.5155978360625*^9}, {
   3.51559791015625*^9, 3.515597910953125*^9}, 3.51560013915625*^9, 
   3.51560485446875*^9, {3.51561594209375*^9, 3.51561595153125*^9}, {
   3.515615986265625*^9, 3.5156160985*^9}, {3.51578413478125*^9, 
   3.5157841348125*^9}, {3.5200319503125*^9, 
   3.52003195840625*^9}},ExpressionUUID->"b124f1b0-61cd-4e09-be93-\
045f43a5447c"],

Cell["Ad hoc treatment of hybrid coordinates", "Text",
 CellChangeTimes->{{3.5365308433125*^9, 3.536530862453125*^9}, 
   3.577552241511182*^9},ExpressionUUID->"1325483e-27ea-49ed-94ac-\
bc8cc9d88abf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveDisplacement", "[", "\[IndentingNewLine]", 
    RowBox[{"p", ":", 
     RowBox[{"Except", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x", ":", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"_", "?", "NumericQ"}], ")"}], "|", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Scaled", "|", "Canvas"}], ")"}], "[", 
             RowBox[{"(", 
              RowBox[{"_", "?", "NumericQ"}], ")"}], "]"}]}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"y", ":", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"_", "?", "NumericQ"}], ")"}], "|", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Scaled", "|", "Canvas"}], ")"}], "[", 
             RowBox[{"(", 
              RowBox[{"_", "?", "NumericQ"}], ")"}], "]"}]}], ")"}]}]}], 
        "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"FigResolveCoordinateDisplacement", "[", 
      RowBox[{"x", ",", "1"}], "]"}], ",", 
     RowBox[{"FigResolveCoordinateDisplacement", "[", 
      RowBox[{"y", ",", "2"}], "]"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.53653087075*^9, 3.536530887890625*^9}, {
  3.536530960421875*^9, 3.536530998171875*^9}, {3.577552251676196*^9, 
  3.5775522636462126`*^9}, {3.625166579988096*^9, 
  3.625166581813299*^9}},ExpressionUUID->"d207621c-bfbc-4293-8233-\
bd281a7ad634"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Offset geometry", "Section",
 CellChangeTimes->{{3.519492514984375*^9, 
  3.519492516859375*^9}},ExpressionUUID->"67643ee0-f947-4a37-9d25-\
09810b19ac35"],

Cell["An \[OpenCurlyDoubleQuote]offset\[CloseCurlyDoubleQuote] is a relative \
position within a rectangle", "Text",
 CellChangeTimes->{{3.583076204708476*^9, 
  3.5830762239985027`*^9}},ExpressionUUID->"c4d68c22-7f4e-4ab9-8b24-\
54327377ad98"],

Cell[CellGroupData[{

Cell["Named point offsets", "Subsection",
 CellChangeTimes->{{3.51585667196875*^9, 
  3.51585667590625*^9}},ExpressionUUID->"c24f996d-6392-4792-b960-\
4e840c4b522f"],

Cell[TextData[{
 "Note: These are the offsets ",
 StyleBox["to",
  FontSlant->"Italic"],
 " the point.  The offset of text attached to the point should be the \
negative of this."
}], "Text",
 CellChangeTimes->{{3.515856679296875*^9, 
  3.515856701953125*^9}},ExpressionUUID->"c83f4e83-9fe8-4cdd-8665-\
6c796e5dc604"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NamedPointPattern", "=", 
   RowBox[{
   "Center", "|", "Left", "|", "Right", "|", "Bottom", "|", "Top", "|", 
    "TopLeft", "|", "TopRight", "|", "BottomLeft", "|", "BottomRight"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51847362190625*^9, 3.518473625921875*^9}, {
  3.518473733375*^9, 
  3.518473772203125*^9}},ExpressionUUID->"2cb856f1-0d13-4cb9-97a5-\
bfdd2772bd74"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NamedPointOffset", "[", "Center", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NamedPointOffset", "[", "Left", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NamedPointOffset", "[", "Right", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"+", "1"}], ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NamedPointOffset", "[", "Bottom", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "1"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NamedPointOffset", "[", "Top", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"+", "1"}]}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51585658321875*^9, 3.51585664778125*^9}, {
  3.51585670484375*^9, 
  3.5158567275625*^9}},ExpressionUUID->"4615960a-efde-44dc-accb-730f22f35b56"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NamedPointOffset", "[", "TopLeft", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"+", "1"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NamedPointOffset", "[", "TopRight", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"+", "1"}], ",", 
     RowBox[{"+", "1"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NamedPointOffset", "[", "BottomLeft", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "1"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NamedPointOffset", "[", "BottomRight", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"+", "1"}], ",", 
     RowBox[{"-", "1"}]}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51847356375*^9, 
  3.518473604984375*^9}},ExpressionUUID->"e1784ee3-804d-4d81-bff6-\
1ad542d80282"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Realizing offset", "Subsection",
 CellChangeTimes->{{3.5194922451875*^9, 
  3.519492247734375*^9}},ExpressionUUID->"5d28b025-c74c-471a-8b1c-\
b7177e1bfa62"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FigOffsetPattern", "=", 
   RowBox[{"NamedPointPattern", "|", "NumericalPairPattern"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.519492311796875*^9, 3.519492321453125*^9}, {
  3.519492469*^9, 
  3.5194924740625*^9}},ExpressionUUID->"9d5729f7-e8c0-4e68-84ed-20fb52a5414c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveOffset", "[", 
    RowBox[{"Offset", ":", "NamedPointPattern"}], "]"}], ":=", 
   RowBox[{"NamedPointOffset", "[", "Offset", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveOffset", "[", 
    RowBox[{"Offset", ":", "NumericalPairPattern"}], "]"}], ":=", "Offset"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.519492248640625*^9, 3.519492290796875*^9}, {
  3.519492486625*^9, 3.519492493421875*^9}, {3.519495312078125*^9, 
  3.519495316453125*^9}},ExpressionUUID->"261a6e33-1616-4046-8999-\
19417b19e197"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Window/panel geometry", "Section",
 CellChangeTimes->{{3.51516648646875*^9, 3.5151664916875*^9}, {
  3.515617659953125*^9, 3.515617686125*^9}, {3.515782122671875*^9, 
  3.515782123171875*^9}, {3.51578499628125*^9, 
  3.515784997953125*^9}},ExpressionUUID->"bbc9ccdb-6453-4825-a926-\
4f7e8e16bf98"],

Cell[CellGroupData[{

Cell["Generic numerical region pattern", "Subsection",
 CellChangeTimes->{{3.515342045546875*^9, 3.515342048015625*^9}, {
  3.515342428203125*^9, 3.515342429546875*^9}, {3.51603713177075*^9, 
  3.5160371333645*^9}, {3.516037165036375*^9, 
  3.516037205192625*^9}},ExpressionUUID->"66eddeb1-9d21-4ff9-8664-\
c48bd6baa024"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RangeParametersPattern", "=", 
   RowBox[{"(", 
    RowBox[{"None", "|", 
     RowBox[{"(", 
      RowBox[{"_", "?", "NumericQ"}], ")"}], "|", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"_", "?", "NumericQ"}], ")"}], ",", 
       RowBox[{"(", 
        RowBox[{"_", "?", "NumericQ"}], ")"}]}], "}"}], "|", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"_", "?", "NumericQ"}], ")"}], ",", 
         RowBox[{"(", 
          RowBox[{"_", "?", "NumericQ"}], ")"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"_", "?", "NumericQ"}], ")"}], ",", 
         RowBox[{"(", 
          RowBox[{"_", "?", "NumericQ"}], ")"}]}], "}"}]}], "}"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NonNegativeRangeParametersPattern", "=", 
   RowBox[{"(", 
    RowBox[{"None", "|", "NonNegativePattern", "|", 
     RowBox[{"{", 
      RowBox[{"NonNegativePattern", ",", "NonNegativePattern"}], "}"}], "|", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"NonNegativePattern", ",", "NonNegativePattern"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"NonNegativePattern", ",", "NonNegativePattern"}], "}"}]}], 
      "}"}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NumericalRegionPattern", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"_", "?", "NumericQ"}], ")"}], ",", 
       RowBox[{"(", 
        RowBox[{"_", "?", "NumericQ"}], ")"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"_", "?", "NumericQ"}], ")"}], ",", 
       RowBox[{"(", 
        RowBox[{"_", "?", "NumericQ"}], ")"}]}], "}"}]}], "}"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515353469921875*^9, 3.5153535245625*^9}, {
  3.515353653453125*^9, 3.515353654515625*^9}, {3.515353694734375*^9, 
  3.5153537149375*^9}, {3.515353797671875*^9, 3.515353826796875*^9}, {
  3.51603798577075*^9, 
  3.516038001177*^9}},ExpressionUUID->"0e666322-1f9b-4019-a107-eb0ad3755213"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generic numerical region upgrade", "Subsection",
 CellChangeTimes->{{3.5160371906145*^9, 
  3.51603720895825*^9}},ExpressionUUID->"0d790c14-3521-4975-b711-\
745905641067"],

Cell["\<\
for numeric data

general rules
\tx -> {x,x}
\t{x,y} -> {{x,x},{y,y}}
\t{{x1,x2},{y1,y2}} left unchanged
\t
special case
\tNone -> {{0,0},{0,0}}\
\>", "Text",
 CellChangeTimes->{{3.428181708328125*^9, 3.428181714515625*^9}, {
  3.459546646359375*^9, 3.45954666640625*^9}, {3.461090186078125*^9, 
  3.461090206421875*^9}, {3.461090554328125*^9, 3.461090557796875*^9}, {
  3.46694655503125*^9, 3.466946556640625*^9}, {3.515342181828125*^9, 
  3.51534226246875*^9}, {3.515342351140625*^9, 
  3.515342395984375*^9}},ExpressionUUID->"fc984117-d415-4087-8dbb-\
abd560b943f0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"UpgradeRangeParameters", "[", 
    RowBox[{"xy_", "?", "NumericQ"}], "]"}], ":=", 
   RowBox[{"UpgradeRangeParameters", "[", 
    RowBox[{"{", 
     RowBox[{"xy", ",", "xy"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UpgradeRangeParameters", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x_", "?", "NumericQ"}], ",", 
      RowBox[{"y_", "?", "NumericQ"}]}], "}"}], "]"}], ":=", 
   RowBox[{"UpgradeRangeParameters", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "x"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", "y"}], "}"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UpgradeRangeParameters", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x1_", "?", "NumericQ"}], ",", 
        RowBox[{"x2_", "?", "NumericQ"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"y1_", "?", "NumericQ"}], ",", 
        RowBox[{"y2_", "?", "NumericQ"}]}], "}"}]}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "x2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y1", ",", "y2"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UpgradeRangeParameters", "[", "None", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.428181740703125*^9, 3.4281817943125*^9}, {
   3.428181880328125*^9, 3.428181908125*^9}, {3.428182150109375*^9, 
   3.428182171484375*^9}, {3.42818246159375*^9, 3.42818248540625*^9}, 
   3.466946390578125*^9, 3.51534217165625*^9, {3.51534228034375*^9, 
   3.515342342328125*^9}, {3.5153424063125*^9, 3.515342420765625*^9}, 
   3.515353680546875*^9},ExpressionUUID->"43197aa7-6f0d-4426-b2db-\
121afed95c85"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Region extension by coordinate amount", "Subsection",
 CellChangeTimes->{{3.516041839880125*^9, 
  3.516041844802*^9}},ExpressionUUID->"60f630fb-de67-4b93-9cd4-fb2cc9da631b"],

Cell["2-dimensional", "Text",
 CellChangeTimes->{{3.51579679171875*^9, 3.515796793390625*^9}, {
  3.5669433672474875`*^9, 3.5669433913275213`*^9}, {3.5669434945076656`*^9, 
  3.5669435408777304`*^9}, {3.5669436014378157`*^9, 3.566943650347884*^9}, {
  3.5830783778607297`*^9, 
  3.5830783793657317`*^9}},ExpressionUUID->"40ea30dd-a0a4-40e5-b606-\
37191d2e7c23"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ExtendRegion", "[", 
    RowBox[{
     RowBox[{"PRange", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PDiff", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Mode", ":", "Absolute"}]}], "]"}], ":=", 
   RowBox[{"PRange", "+", 
    RowBox[{"PDiff", "*", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"+", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"+", "1"}]}], "}"}]}], "}"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtendRegion", "[", 
    RowBox[{
     RowBox[{"PRange", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PFrac", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Mode", ":", "Scaled"}]}], "]"}], ":=", 
   RowBox[{"PRange", "+", 
    RowBox[{"PFrac", "*", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"+", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"+", "1"}]}], "}"}]}], "}"}], "*", 
     RowBox[{"-", 
      RowBox[{"Subtract", "@@@", "PRange"}]}]}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.470920245828125*^9, 3.470920252046875*^9}, {
   3.515362535484375*^9, 3.51536253778125*^9}, {3.515362583265625*^9, 
   3.51536260653125*^9}, {3.515362687484375*^9, 3.515362709484375*^9}, 
   3.51536284434375*^9, {3.515362895421875*^9, 3.515362906125*^9}, 
   3.51536299653125*^9, {3.515797038171875*^9, 3.51579705753125*^9}, {
   3.51645637384375*^9, 
   3.51645638003125*^9}},ExpressionUUID->"7fe9e50c-40e2-4360-8bbe-\
3ec5a710d9f5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Window region specification pattern", "Subsection",
 CellChangeTimes->{{3.515782275453125*^9, 3.515782279703125*^9}, 
   3.51578499171875*^9},ExpressionUUID->"2e579d98-5cdc-4e30-81b2-\
a54ada6af043"],

Cell["\<\
Note: Pattern excludes case {_Integer,_Integer}, for panel in multipanel \
array, since this case requires special treatment.\
\>", "Text",
 CellChangeTimes->{{3.5157847563125*^9, 
  3.515784790640625*^9}},ExpressionUUID->"e0f77f4a-3a57-4574-a74c-\
b1d17d5aba64"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FigRegionPattern", "=", 
   RowBox[{"(", 
    RowBox[{"All", "|", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}], "|", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Scaled", "|", "Canvas"}], ")"}], "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}], "]"}]}], ")"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515782131515625*^9, 3.515782173640625*^9}, {
   3.51578220403125*^9, 3.51578225421875*^9}, {3.51578477109375*^9, 
   3.515784771390625*^9}, 3.515784983671875*^9, 
   3.51628696821875*^9},ExpressionUUID->"2da40daf-b77e-44ef-8959-\
f8123500655c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Region resolution", "Subsection",
 CellChangeTimes->{{3.5155389481875*^9, 3.5155389531875*^9}, {
   3.515616414640625*^9, 3.515616416671875*^9}, {3.515784677796875*^9, 
   3.515784694203125*^9}, 3.515784985390625*^9, {3.5162867565625*^9, 
   3.516286756890625*^9}},ExpressionUUID->"cfefe12a-c6ac-43ac-a401-\
80f15043c5b6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveRegion", "[", 
    RowBox[{"r", ":", "All"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"CurrentWindow", "[", "]"}], "@", 
     RowBox[{"CanvasRegion", "[", "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveRegion", "[", 
    RowBox[{"r", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], "]"}], ":=", 
   RowBox[{"TransformRegion", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"CurrentWindow", "[", "]"}], "@", 
      RowBox[{"TFunction", "[", "]"}]}], ",", "r"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveRegion", "[", 
    RowBox[{"Canvas", "[", 
     RowBox[{"r", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], "]"}], "]"}], ":=",
    "r"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveRegion", "[", 
    RowBox[{"Scaled", "[", 
     RowBox[{"r", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], "]"}], "]"}], ":=", 
   RowBox[{"TransformRegion", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"CurrentWindow", "[", "]"}], "@", 
      RowBox[{"ScaledTFunction", "[", "]"}]}], ",", "r"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.515541817625*^9, {3.515541908421875*^9, 3.515541912828125*^9}, {
   3.515541996375*^9, 3.515541998203125*^9}, {3.515597628171875*^9, 
   3.51559764675*^9}, {3.5155978139375*^9, 3.5155978360625*^9}, {
   3.51559791015625*^9, 3.515597910953125*^9}, 3.51560013915625*^9, 
   3.51560485446875*^9, {3.51561594209375*^9, 3.51561595153125*^9}, {
   3.515616120734375*^9, 3.515616383671875*^9}, {3.515782289078125*^9, 
   3.51578232515625*^9}, {3.515784012125*^9, 3.5157840259375*^9}, {
   3.5157841345625*^9, 3.51578425153125*^9}, {3.515784491796875*^9, 
   3.51578457575*^9}, {3.515784696953125*^9, 3.5157847003125*^9}, {
   3.515784985828125*^9, 3.5157849881875*^9}, {3.51628696884375*^9, 
   3.51628697021875*^9}, {3.5334151966875*^9, 3.533415201578125*^9}, 
   3.5334152335625*^9},ExpressionUUID->"35a54482-b6da-4bfd-9d3d-cef98f8a7100"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Region extension", "Subsection",
 CellChangeTimes->{{3.5162860230625*^9, 3.51628602884375*^9}, {
  3.51628675059375*^9, 
  3.5162867515625*^9}},ExpressionUUID->"9a452c93-ccd1-4523-a270-19933479eca0"],

Cell["\<\
Programmer level functions -- working in canvas coordinates
Serve to resolve \[OpenCurlyDoubleQuote]delta region patterns\
\[CloseCurlyDoubleQuote] to adjustments which can be handled arithmetically \
by ExtendRegion
Here \[OpenCurlyDoubleQuote]Scaled\[CloseCurlyDoubleQuote] refers to a \
fraction of the region which is being expanded, not of the current window.\
\>", "Text",
 CellChangeTimes->{{3.516286740265625*^9, 3.51628679584375*^9}, {
  3.516286830875*^9, 3.51628684359375*^9}, {3.520528652796875*^9, 
  3.520528657046875*^9}, {3.5830801838869057`*^9, 3.5830801912501187`*^9}, {
  3.5830810836947255`*^9, 
  3.5830811069387665`*^9}},ExpressionUUID->"3aa30291-1e76-42bf-8e4b-\
da05a4896928"],

Cell["\<\
FigResolveRegionExtension converts a user-acceptable region extension and \
returns arguments {{{x1,x2},{y1,y2}},{dx1,dx2},{dy1,dy2},Absolute|Scaled}  \
for use with ExtendRegion.\
\>", "Text",
 CellChangeTimes->{{3.6228398100573626`*^9, 3.6228398648914585`*^9}, {
  3.6228414516326456`*^9, 3.6228414565622544`*^9}, {3.6228415244535737`*^9, 
  3.6228415522216225`*^9}},ExpressionUUID->"9a69bb8b-0bb2-45e6-92c6-\
8f5d820ec53f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveRegionExtension", "[", 
    RowBox[{
     RowBox[{"r", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"d", ":", "None"}]}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"r", ",", 
     RowBox[{"UpgradeRangeParameters", "[", "0", "]"}], ",", "Absolute"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveRegionExtension", "[", 
    RowBox[{
     RowBox[{"r", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"d", ":", "Automatic"}]}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"r", ",", 
     RowBox[{"UpgradeRangeParameters", "[", "0.02", "]"}], ",", "Scaled"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveRegionExtension", "[", 
    RowBox[{
     RowBox[{"r", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"d", ":", "RangeParametersPattern"}]}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"r", ",", 
     RowBox[{"TransformRegion", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"CurrentWindow", "[", "]"}], "@", 
        RowBox[{"DeltaTFunction", "[", "]"}]}], ",", 
       RowBox[{"UpgradeRangeParameters", "[", "d", "]"}]}], "]"}], ",", 
     "Absolute"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveRegionExtension", "[", 
    RowBox[{
     RowBox[{"r", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Canvas", "[", 
      RowBox[{"d", ":", "RangeParametersPattern"}], "]"}]}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"r", ",", 
     RowBox[{"UpgradeRangeParameters", "[", "d", "]"}], ",", "Absolute"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveRegionExtension", "[", 
    RowBox[{
     RowBox[{"r", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Scaled", "[", 
      RowBox[{"d", ":", "RangeParametersPattern"}], "]"}]}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"r", ",", 
     RowBox[{"UpgradeRangeParameters", "[", "d", "]"}], ",", "Scaled"}], 
    "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.516286496359375*^9, 3.51628649825*^9}, {
  3.516286544375*^9, 3.51628656809375*^9}, {3.5162866254375*^9, 
  3.516286687359375*^9}, {3.516286803796875*^9, 3.516286875703125*^9}, {
  3.51628823759375*^9, 3.516288243828125*^9}, {3.5181196755625*^9, 
  3.518119676328125*^9}, {3.51811982978125*^9, 3.51811985040625*^9}, {
  3.5181199225625*^9, 3.51811992603125*^9}, {3.566943272207354*^9, 
  3.5669432722373543`*^9}, {3.5830811196371884`*^9, 3.583081141695627*^9}, {
  3.6228396474582767`*^9, 3.6228397313708243`*^9}, {3.622841387235733*^9, 
  3.622841432990613*^9}},ExpressionUUID->"72b40dfc-9d38-4e7d-a8ba-\
0e4e25934732"]
}, Open  ]],

Cell[CellGroupData[{

Cell["General adjustment of region", "Subsection",
 CellChangeTimes->{{3.58308020895615*^9, 
  3.583080223167775*^9}},ExpressionUUID->"6a418b69-9b77-4555-ad06-\
6fcfa9871aa1"],

Cell["\<\
User-level wrapper
\tReturns result as valid region specification, wrapped in Canvas[]\
\>", "Text",
 CellChangeTimes->{{3.516286908109375*^9, 3.516286915203125*^9}, {
  3.518124271375*^9, 3.518124278109375*^9}, {3.52052866159375*^9, 
  3.52052868296875*^9}},ExpressionUUID->"26513b28-611b-4dd3-8f08-\
6b428851b27f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FigDeltaRegionPattern", "=", 
   RowBox[{"Automatic", "|", "None", "|", "RangeParametersPattern", "|", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Scaled", "|", "Canvas"}], ")"}], "[", "RangeParametersPattern",
      "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515782131515625*^9, 3.515782173640625*^9}, {
   3.51578220403125*^9, 3.51578225421875*^9}, {3.51578477109375*^9, 
   3.515784771390625*^9}, 3.515784983671875*^9, {3.51628624659375*^9, 
   3.516286258796875*^9}, {3.516286295140625*^9, 3.51628630284375*^9}, {
   3.516286340328125*^9, 3.516286342234375*^9}, {3.5830810733363075`*^9, 
   3.583081074334709*^9}},ExpressionUUID->"3aa29102-4c33-4987-94f9-\
f0596e6e6b7f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "AdjustRegion", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"RegionExtension", "\[Rule]", "None"}], ",", 
     RowBox[{"RegionDisplacement", "\[Rule]", "None"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AdjustRegion", "[", 
    RowBox[{
     RowBox[{"r", ":", "FigRegionPattern"}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullOptions", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Opts", ",", 
           RowBox[{"Options", "[", "AdjustRegion", "]"}]}], "}"}], "]"}]}], 
       ",", "CanvasRegion"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"validate", " ", "options"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FigCheckOption", "[", 
       RowBox[{
       "AdjustRegion", ",", "RegionDisplacement", ",", 
        "FigDisplacementPattern", ",", "FullOptions"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{
       "AdjustRegion", ",", "RegionExtension", ",", "FigDeltaRegionPattern", 
        ",", "FullOptions"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "resolve", " ", "given", " ", "region", " ", "to", " ", "canvas", " ", 
        "coordinates"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"CanvasRegion", "=", 
       RowBox[{"FigResolveRegion", "[", "r", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"do", " ", "displacement"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"CanvasRegion", "=", 
       RowBox[{"CanvasRegion", "+", 
        RowBox[{"FigResolveDisplacement", "[", 
         RowBox[{"(", 
          RowBox[{"RegionDisplacement", "/.", "FullOptions"}], ")"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"do", " ", "extension"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"CanvasRegion", "=", 
       RowBox[{"ExtendRegion", "@@", 
        RowBox[{"FigResolveRegionExtension", "[", 
         RowBox[{"CanvasRegion", ",", 
          RowBox[{"(", 
           RowBox[{"RegionExtension", "/.", "FullOptions"}], ")"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "return", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Canvas", "[", "CanvasRegion", "]"}]}]}], "\[IndentingNewLine]",
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DeclareFigFallThroughError", "[", "AdjustRegion", "]"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5830791169805884`*^9, 3.583079133858348*^9}, {
  3.583079202241898*^9, 3.5830793635706263`*^9}, {3.5830795570882845`*^9, 
  3.583079561313526*^9}, {3.583079885104046*^9, 3.5830800708646708`*^9}, {
  3.583081516002678*^9, 3.5830815210726852`*^9}, {3.583081673146535*^9, 
  3.5830816749405384`*^9}, {3.5836974442451077`*^9, 3.5836974601051297`*^9}, {
  3.6228397932249327`*^9, 
  3.62283980306855*^9}},ExpressionUUID->"42d0bd03-b3ba-4bca-80b5-\
6d022b6eddbf"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Region points", "Subsection",
 CellChangeTimes->{{3.51827685290625*^9, 
  3.518276860484375*^9}},ExpressionUUID->"916f83ca-b12f-4406-b724-\
c83f333ce62e"],

Cell["User-level region point extraction", "Text",
 CellChangeTimes->{{3.518276874921875*^9, 
  3.51827688321875*^9}},ExpressionUUID->"35f65e10-3f62-45fd-9c70-\
4caeb8eed901"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RegionPoint", "[", 
    RowBox[{
     RowBox[{"r", ":", "FigRegionPattern"}], ",", 
     RowBox[{"Offset", ":", "FigOffsetPattern"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "UsedOffset", ",", "CanvasRegion", ",", "CanvasCenter", ",", 
       "CanvasRadius"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"resolve", " ", "geometry"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"UsedOffset", "=", 
       RowBox[{"FigResolveOffset", "[", "Offset", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CanvasRegion", "=", 
       RowBox[{"FigResolveRegion", "[", "r", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CanvasCenter", "=", 
       RowBox[{"Mean", "/@", "CanvasRegion"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"CanvasRadius", "=", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"Subtract", "@@@", "CanvasRegion"}], ")"}]}], "/", "2"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"return", " ", "offset", " ", "point"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Canvas", "[", 
       RowBox[{"CanvasCenter", "+", 
        RowBox[{"UsedOffset", "*", "CanvasRadius"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.518276869859375*^9, 3.518276948953125*^9}, {
  3.518276992453125*^9, 3.518277104421875*^9}, {3.51951058934375*^9, 
  3.51951061803125*^9}},ExpressionUUID->"06a66e4a-814e-422d-8bfc-\
01f06ddc53d7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Object set bounding box", "Subsection",
 CellChangeTimes->{{3.51603589645825*^9, 
  3.516035901380125*^9}},ExpressionUUID->"cd6a7f03-3c07-44e4-80d3-\
584fd81b48fe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ExtractBoundingBox", "[", 
    RowBox[{
     RowBox[{"Object", "[", 
      RowBox[{"n", ":", 
       RowBox[{"ObjectNamePattern", "[", "FigAnchor", "]"}]}], "]"}], "|", 
     RowBox[{"(", 
      RowBox[{"n", ":", 
       RowBox[{"ObjectNamePattern", "[", "FigAnchor", "]"}]}], ")"}]}], "]"}],
    ":=", 
   RowBox[{"FigPointBoundingBox", "[", 
    RowBox[{
     RowBox[{"Object", "[", "n", "]"}], "@", 
     RowBox[{"GetPoint", "[", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtractBoundingBox", "[", 
    RowBox[{
     RowBox[{"Object", "[", 
      RowBox[{"n", ":", 
       RowBox[{"ObjectNamePattern", "[", "FigObject", "]"}]}], "]"}], "|", 
     RowBox[{"(", 
      RowBox[{"n", ":", 
       RowBox[{"ObjectNamePattern", "[", "FigObject", "]"}]}], ")"}]}], "]"}],
    ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Object", "[", "n", "]"}], "@", 
     RowBox[{"MakeBoundingBox", "[", "]"}]}], ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51603773045825*^9, 3.516037752630125*^9}, {
  3.51603778345825*^9, 
  3.516037850130125*^9}},ExpressionUUID->"bbac4e1d-a630-4eda-86df-\
9bbeff9ab0d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ObjectCanvasBox", "[", 
    RowBox[{"ObjectList", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ObjectPattern", "[", "FigAnchor", "]"}], "|", 
         RowBox[{"ObjectNamePattern", "[", "FigAnchor", "]"}], "|", 
         RowBox[{"ObjectPattern", "[", "FigObject", "]"}], "|", 
         RowBox[{"ObjectNamePattern", "[", "FigObject", "]"}]}], ")"}], 
       ".."}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"RegionList", ",", "ExtremumLists"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RegionList", "=", 
       RowBox[{"(", 
        RowBox[{"ExtractBoundingBox", "/@", "ObjectList"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ExtremumLists", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{"List", ",", "RegionList", ",", "2"}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xminlist", ",", "xmaxlist"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"yminlist", ",", "ymaxlist"}], "}"}]}], "}"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"MapAt", "[", 
       RowBox[{"Max", ",", 
        RowBox[{"MapAt", "[", 
         RowBox[{"Min", ",", "ExtremumLists", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "2"}], "}"}]}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.516037549973875*^9, 3.516037630848875*^9}, {
   3.516037863911375*^9, 3.516037898255125*^9}, {3.51603849195825*^9, 
   3.5160386641145*^9}, {3.516038847942625*^9, 3.516038848848875*^9}, {
   3.516038953223875*^9, 3.516038959161375*^9}, 3.51604321702075*^9, {
   3.516043256630125*^9, 
   3.51604328527075*^9}},ExpressionUUID->"64d9ce5d-4691-40c8-a44d-\
0a79b5ac88e7"],

Cell["User-level bounding region function", "Text",
 CellChangeTimes->{{3.583082700711568*^9, 
  3.583082710455468*^9}},ExpressionUUID->"6dda4a23-0913-4eca-a7e5-\
43f585502de5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SDBoundingRegion", "[", "\[IndentingNewLine]", 
    RowBox[{"ObjectList", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ObjectPattern", "[", "FigAnchor", "]"}], "|", 
         RowBox[{"ObjectNamePattern", "[", "FigAnchor", "]"}], "|", 
         RowBox[{"ObjectPattern", "[", "FigObject", "]"}], "|", 
         RowBox[{"ObjectNamePattern", "[", "FigObject", "]"}]}], ")"}], 
       ".."}], "}"}]}], "\[IndentingNewLine]", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FigCheckInFigure", "[", "BoundingRegion", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Canvas", "[", 
       RowBox[{"ObjectCanvasBox", "[", "ObjectList", "]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SDBoundingRegion", "[", "\[IndentingNewLine]", 
    RowBox[{"obj", ":", 
     RowBox[{"(", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ObjectPattern", "[", "FigAnchor", "]"}], "|", 
        RowBox[{"ObjectNamePattern", "[", "FigAnchor", "]"}], "|", 
        RowBox[{"ObjectPattern", "[", "FigObject", "]"}], "|", 
        RowBox[{"ObjectNamePattern", "[", "FigObject", "]"}]}], ")"}], 
      ")"}]}], "\[IndentingNewLine]", "]"}], ":=", 
   RowBox[{"BoundingRegion", "[", 
    RowBox[{"{", "obj", "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DeclareFigFallThroughError", "[", "SDBoundingRegion", "]"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.516037549973875*^9, 3.516037630848875*^9}, {
  3.516037863911375*^9, 3.516037898255125*^9}, {3.51603849195825*^9, 
  3.5160386641145*^9}, {3.516038847942625*^9, 3.516038848848875*^9}, {
  3.516038953223875*^9, 3.516038959161375*^9}, {3.51604318177075*^9, 
  3.516043185630125*^9}, {3.516285789828125*^9, 3.516285817*^9}, {
  3.51827666221875*^9, 3.518276690953125*^9}, {3.518277205515625*^9, 
  3.51827721*^9}, {3.518277416671875*^9, 3.518277417234375*^9}, {
  3.583082644399453*^9, 3.583082692317689*^9}, {3.7998493620404453`*^9, 
  3.799849375110981*^9}},ExpressionUUID->"174302b5-5ac1-4b2d-8e6e-\
5261564683c1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Edge-type parameter list interpretation", "Section",
 CellChangeTimes->{{3.515342435171875*^9, 3.515342438984375*^9}, {
  3.516037020661375*^9, 3.5160370247395*^9}, {3.516037068927*^9, 
  3.516037072755125*^9}},ExpressionUUID->"eca6dfd6-bdf9-461f-956f-\
208235dcfae9"],

Cell[TextData[{
 "modeled on FrameLabel, etc.\n\ngeneral rules\n\t[B -> {B,B} -- contrary to ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " FrameLabel behavior {B,X}]\n\t\tThis case is usually only reasonable a \
boolean parameter or a style parameter.  \n\t\t\tPattern: \
EdgeXYSameParametersPattern[patt]\n\t\tOther properties are XY properties, \
and a value appropriate to X should never propagate to Y, except perhaps the \
value None.\n\t\t\tPatterns: EdgeXYUniqueParametersPattern[patt]\n\t\tIt is \
up to the *pattern* to exclude other possibilities, such as AxisLabel->\
\[CloseCurlyDoubleQuote]x\[CloseCurlyDoubleQuote].\n\t{B,L} -> {{L,X},{B,X}}  \
  no mirroring\n\t\tor {{L,L},{B,B}}    mirroring\n\t{{L,R},{B,T}} left \
unchanged\nlegacy list format rules\n\t{B} was legitimate legacy case but is \
disallowed in present conversion\n\t{B,L,T} was legitimate legacy case but is \
disallowed in present conversion\n\t{B,L,T,R}->{{L,R},{B,T}}\nwhere X is \
given filler\n\nNo special treatment is imposed on the value None.  For \
instance, it is not translated into Filler."
}], "Text",
 CellChangeTimes->{{3.428181708328125*^9, 3.428181714515625*^9}, {
   3.459546646359375*^9, 3.45954666640625*^9}, {3.461090186078125*^9, 
   3.461090206421875*^9}, {3.461090554328125*^9, 3.461090557796875*^9}, {
   3.46694655503125*^9, 3.466946556640625*^9}, {3.515342181828125*^9, 
   3.51534226246875*^9}, {3.515342351140625*^9, 3.515342395984375*^9}, {
   3.515342455484375*^9, 3.515342456296875*^9}, {3.5153424865625*^9, 
   3.515342722703125*^9}, {3.515343454640625*^9, 3.51534347678125*^9}, {
   3.515343518859375*^9, 3.51534356825*^9}, {3.515352454421875*^9, 
   3.515352461703125*^9}, 3.515352506265625*^9, {3.515353016171875*^9, 
   3.5153530378125*^9}, 3.516037036317625*^9, {3.5163893819375*^9, 
   3.516389413859375*^9}, {3.516389500359375*^9, 3.516389507171875*^9}, {
   3.516389546109375*^9, 3.516389573234375*^9}, {3.516389608390625*^9, 
   3.51638961084375*^9}, {3.516389642671875*^9, 3.516389692671875*^9}, {
   3.516389761671875*^9, 3.51638995615625*^9}, {3.516390130078125*^9, 
   3.5163901309375*^9}, {3.5163909391875*^9, 3.5163909453125*^9}, {
   3.5163911913125*^9, 3.516391221421875*^9}, {3.51639199809375*^9, 
   3.51639202265625*^9}, {3.516461558421875*^9, 
   3.516461601984375*^9}},ExpressionUUID->"f2b0cd9d-e3e0-4b5e-ba25-\
980f28990857"],

Cell["\<\
example usage: 
\tEdgeParametersPattern[NonListPattern]) -- includes None as allowable case
\tNone|EdgeParametersPattern[FlatListPattern]\
\>", "Text",
 CellChangeTimes->{{3.51579191709375*^9, 3.515791919203125*^9}, {
  3.515791977453125*^9, 3.51579200184375*^9}, {3.51579204621875*^9, 
  3.51579205353125*^9}, {3.515792145578125*^9, 
  3.5157921623125*^9}},ExpressionUUID->"28087a24-e31a-4934-904e-eef2b802b8d0"],

Cell[CellGroupData[{

Cell["Masking of edge options", "Subsection",
 CellChangeTimes->{{3.5163955378125*^9, 
  3.516395540625*^9}},ExpressionUUID->"d0a95032-68d4-4ffe-8298-157c0852091c"],

Cell["\<\
EdgeMaskingFunction[DataEntry_,MaskEntry_,ExteriorEdgeMaskEntry_,Filler_] \
masks DataEntry, i.e., returning either DataEntry or Filler.  DataEntry is \
returned if the mask value is True or is Exterior on an exterior edge (as \
indicated by ExteriorEdgeMaskEntry).\
\>", "Text",
 CellChangeTimes->{{3.579102750238942*^9, 
  3.5791028246354723`*^9}},ExpressionUUID->"bf5505f0-4f58-4da1-8959-\
975b09d12663"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EdgeMaskingFunction", "[", 
    RowBox[{
    "DataEntry_", ",", "MaskEntry_", ",", "ExteriorEdgeMaskEntry_", ",", 
     "Filler_"}], "]"}], ":=", 
   RowBox[{"If", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"MaskEntry", "===", "True"}], ")"}], "||", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"MaskEntry", "===", "Exterior"}], ")"}], "&&", 
        "ExteriorEdgeMaskEntry"}], ")"}]}], ",", "\[IndentingNewLine]", 
     "DataEntry", ",", "\[IndentingNewLine]", "Filler"}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5164602644375*^9, 3.51646040815625*^9}, {
  3.516460634953125*^9, 
  3.516460635828125*^9}},ExpressionUUID->"0c6a486e-80e1-4270-93d4-\
4cc4733135b7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MaskEdgeOption", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Data", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_", ",", "_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"_", ",", "_"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Mask", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Exterior", "|", "LogicalPattern"}], ",", 
          RowBox[{"Exterior", "|", "LogicalPattern"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Exterior", "|", "LogicalPattern"}], ",", 
          RowBox[{"Exterior", "|", "LogicalPattern"}]}], "}"}]}], "}"}]}], 
     ",", 
     RowBox[{"ExteriorEdgeMask", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"LogicalPattern", ",", "LogicalPattern"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"LogicalPattern", ",", "LogicalPattern"}], "}"}]}], "}"}]}], 
     ",", "\[IndentingNewLine]", "Filler_"}], "\[IndentingNewLine]", "]"}], ":=", 
   RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"EdgeMaskingFunction", "[", 
       RowBox[{"##", ",", "Filler"}], "]"}], "&"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Data", ",", "Mask", ",", "ExteriorEdgeMask"}], "}"}], ",", 
     "\[IndentingNewLine]", "2"}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.516395320109375*^9, 3.51639548109375*^9}, {
  3.516460135921875*^9, 3.51646021159375*^9}, {3.516460251640625*^9, 
  3.51646026215625*^9}, {3.516460507125*^9, 3.516460513171875*^9}, {
  3.516460636296875*^9, 
  3.516460643921875*^9}},ExpressionUUID->"70126a37-ecd1-4305-91bf-\
12ea632e61fd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Automatic values for edge options", "Subsection",
 CellChangeTimes->{{3.5163955378125*^9, 3.516395540625*^9}, {
  3.579102839549099*^9, 
  3.579102845289909*^9}},ExpressionUUID->"09530716-44cc-4f07-b111-\
127b1d65af0b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ResolveAutomaticEdgeOption", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Data", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_", ",", "_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"_", ",", "_"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Defaults", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_", ",", "_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"_", ",", "_"}], "}"}]}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}], ":=", 
   RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Replace", "[", 
       RowBox[{"#1", ",", 
        RowBox[{"{", 
         RowBox[{"Automatic", "\[Rule]", "#2"}], "}"}]}], "]"}], "&"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Data", ",", "Defaults"}], "}"}], ",", "\[IndentingNewLine]", 
     "2"}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.516395320109375*^9, 3.51639548109375*^9}, {
   3.516460135921875*^9, 3.51646021159375*^9}, {3.516460251640625*^9, 
   3.51646026215625*^9}, {3.516460507125*^9, 3.516460513171875*^9}, {
   3.516460636296875*^9, 3.516460643921875*^9}, {3.5791028530431223`*^9, 
   3.5791029554261026`*^9}, 
   3.5791044306453896`*^9},ExpressionUUID->"60137c80-199b-4e3c-9867-\
5c7122a4c159"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ResolveAutomaticEdgeOption", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "Automatic"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7", ",", "8"}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.579104379115317*^9, 3.579104394875339*^9}, {
  3.579104437145398*^9, 
  3.5791044381253996`*^9}},ExpressionUUID->"ae5f97c5-b970-4f5c-a652-\
d20ab6a04a61"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "8"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.579104396425341*^9, {3.5791044338453937`*^9, 
   3.5791044385053997`*^9}},ExpressionUUID->"6b05f4f4-50ae-4f1f-9e5d-\
1fc4c62ba43a"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Single-coordinate geometry", "Section",
 CellChangeTimes->{{3.516047466036375*^9, 
  3.51604747252075*^9}},ExpressionUUID->"17471a25-cb62-4674-939a-\
fae2000932cd"],

Cell[CellGroupData[{

Cell["Single-coordinate pattern", "Subsection",
 CellChangeTimes->{{3.51604749777075*^9, 
  3.51604750070825*^9}},ExpressionUUID->"d43df64b-a3da-4f71-ad3e-\
b48c9b59c935"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FigCoordinatePattern", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"_", "?", "NumericQ"}], ")"}], "|", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Scaled", "|", "Canvas"}], ")"}], "[", 
      RowBox[{"(", 
       RowBox[{"_", "?", "NumericQ"}], ")"}], "]"}], "|", "FigPointPattern"}],
     ")"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.516047483817625*^9, 3.516047488973875*^9}, {
  3.51604754014575*^9, 
  3.516047540927*^9}},ExpressionUUID->"4195cfa5-dfbc-4a20-aa25-9c861a5a0afb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Complementary coordinate index", "Subsection",
 CellChangeTimes->{{3.51846246559375*^9, 
  3.518462470828125*^9}},ExpressionUUID->"84c8c44d-40f5-4bb5-bfa0-\
5a1fbd393b71"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AntiCoordinateIndex", "[", "1", "]"}], "=", "2"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AntiCoordinateIndex", "[", "2", "]"}], "=", "1"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.518462472265625*^9, 
  3.518462495203125*^9}},ExpressionUUID->"1c58ff43-61ae-4a77-9385-\
83a2555cbd34"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Interpret Horizontal/Vertical as coordinate indices", "Subsection",
 CellChangeTimes->{{3.516047836130125*^9, 3.51604784989575*^9}, {
  3.5833521853867435`*^9, 
  3.5833521882167473`*^9}},ExpressionUUID->"be4d95a0-8668-409c-9b1e-\
3b08cb957106"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveCoordinateIndex", "[", "Horizontal", "]"}], "=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveCoordinateIndex", "[", "Vertical", "]"}], "=", "2"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.516046467942625*^9, 3.5160465244895*^9}, 
   3.516047415177*^9, {3.516047556192625*^9, 3.51604755827075*^9}, 
   3.516047601661375*^9, {3.516047804473875*^9, 3.5160478323645*^9}, {
   3.5833521912667513`*^9, 
   3.5833522121567802`*^9}},ExpressionUUID->"e35731fb-93fb-4356-997f-\
5296b88bfe86"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Conversion of coordinate system for individual coordinate", "Subsection",
 CellChangeTimes->{{3.5160473852395*^9, 
  3.516047397802*^9}},ExpressionUUID->"c606a2e2-384b-4689-ace6-309048c158e1"],

Cell["\<\
must come *after* point geometry, since uses FigPointPattern
can be used eith to convert a single coordinate to canvas coordinates or to \
extract canvas coordinate from a point\
\>", "Text",
 CellChangeTimes->{{3.516293167375*^9, 3.5162931786875*^9}, {
  3.5184615730625*^9, 3.51846158109375*^9}, {3.5184616460625*^9, 
  3.518461646640625*^9}, {3.518461720234375*^9, 
  3.518461752*^9}},ExpressionUUID->"a6234ed8-4b88-4445-8ada-e22d47967c71"],

Cell["Conversions", "Text",
 CellChangeTimes->{{3.516047858411375*^9, 
  3.516047864598875*^9}},ExpressionUUID->"ddce322a-6838-4a9c-9bc3-\
7cc171553005"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveCoordinate", "[", 
    RowBox[{
     RowBox[{"x_", "?", "NumericQ"}], ",", 
     RowBox[{"CoordinateIndex", ":", 
      RowBox[{"(", 
       RowBox[{"1", "|", "2"}], ")"}]}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"FigResolvePoint", "[", 
     RowBox[{"x", "*", 
      RowBox[{"UnitVector", "[", "CoordinateIndex", "]"}]}], "]"}], "[", 
    RowBox[{"[", "CoordinateIndex", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveCoordinate", "[", 
    RowBox[{
     RowBox[{"Scaled", "[", 
      RowBox[{"x_", "?", "NumericQ"}], "]"}], ",", 
     RowBox[{"CoordinateIndex", ":", 
      RowBox[{"(", 
       RowBox[{"1", "|", "2"}], ")"}]}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"FigResolvePoint", "[", 
     RowBox[{"Scaled", "[", 
      RowBox[{"x", "*", 
       RowBox[{"UnitVector", "[", "CoordinateIndex", "]"}]}], "]"}], "]"}], 
    "[", 
    RowBox[{"[", "CoordinateIndex", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveCoordinate", "[", 
    RowBox[{
     RowBox[{"Canvas", "[", 
      RowBox[{"x_", "?", "NumericQ"}], "]"}], ",", 
     RowBox[{"CoordinateIndex", ":", 
      RowBox[{"(", 
       RowBox[{"1", "|", "2"}], ")"}]}]}], "]"}], ":=", "x"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveCoordinate", "[", 
    RowBox[{
     RowBox[{"p", ":", "FigPointPattern"}], ",", 
     RowBox[{"CoordinateIndex", ":", 
      RowBox[{"(", 
       RowBox[{"1", "|", "2"}], ")"}]}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"FigResolvePoint", "[", "p", "]"}], "[", 
    RowBox[{"[", "CoordinateIndex", "]"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.516046467942625*^9, 3.5160465244895*^9}, 
   3.516047415177*^9, {3.516047556192625*^9, 3.51604755827075*^9}, 
   3.516047601661375*^9, {3.516047804473875*^9, 3.5160478323645*^9}, {
   3.5184621599375*^9, 
   3.518462185796875*^9}},ExpressionUUID->"a2b96656-f855-4767-a630-\
0e2ad1ad1c06"],

Cell["Interpret Horizontal/Vertical as arguments", "Text",
 CellChangeTimes->{{3.516047836130125*^9, 
  3.51604784989575*^9}},ExpressionUUID->"93b4ae06-cea4-4965-8b3d-\
825deb9658b1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveCoordinate", "[", 
    RowBox[{"x_", ",", "Horizontal"}], "]"}], ":=", 
   RowBox[{"FigResolveCoordinate", "[", 
    RowBox[{"x", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveCoordinate", "[", 
    RowBox[{"x_", ",", "Vertical"}], "]"}], ":=", 
   RowBox[{"FigResolveCoordinate", "[", 
    RowBox[{"x", ",", "2"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.516046467942625*^9, 3.5160465244895*^9}, 
   3.516047415177*^9, {3.516047556192625*^9, 3.51604755827075*^9}, 
   3.516047601661375*^9, {3.516047804473875*^9, 
   3.5160478323645*^9}},ExpressionUUID->"807dbd7d-6422-4352-a333-\
3abd625efbcc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Conversion of coordinate system for individual coordinate", "Subsection",
 CellChangeTimes->{{3.5160473852395*^9, 
  3.516047397802*^9}},ExpressionUUID->"926c5a61-8fa5-4524-832b-a38afea69b25"],

Cell["Conversions", "Text",
 CellChangeTimes->{{3.516047858411375*^9, 
  3.516047864598875*^9}},ExpressionUUID->"3cb2893a-37f3-4212-89f3-\
7b4b0889c004"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveCoordinateDisplacement", "[", 
    RowBox[{
     RowBox[{"x_", "?", "NumericQ"}], ",", 
     RowBox[{"CoordinateIndex", ":", 
      RowBox[{"(", 
       RowBox[{"1", "|", "2"}], ")"}]}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"FigResolveDisplacement", "[", 
     RowBox[{"x", "*", 
      RowBox[{"UnitVector", "[", "CoordinateIndex", "]"}]}], "]"}], "[", 
    RowBox[{"[", "CoordinateIndex", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveCoordinateDisplacement", "[", 
    RowBox[{
     RowBox[{"Scaled", "[", 
      RowBox[{"x_", "?", "NumericQ"}], "]"}], ",", 
     RowBox[{"CoordinateIndex", ":", 
      RowBox[{"(", 
       RowBox[{"1", "|", "2"}], ")"}]}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"FigResolveDisplacement", "[", 
     RowBox[{"Scaled", "[", 
      RowBox[{"x", "*", 
       RowBox[{"UnitVector", "[", "CoordinateIndex", "]"}]}], "]"}], "]"}], 
    "[", 
    RowBox[{"[", "CoordinateIndex", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveCoordinateDisplacement", "[", 
    RowBox[{
     RowBox[{"Canvas", "[", 
      RowBox[{"x_", "?", "NumericQ"}], "]"}], ",", 
     RowBox[{"CoordinateIndex", ":", 
      RowBox[{"(", 
       RowBox[{"1", "|", "2"}], ")"}]}]}], "]"}], ":=", "x"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveCoordinateDisplacement", "[", 
    RowBox[{
     RowBox[{"p", ":", "FigPointPattern"}], ",", 
     RowBox[{"CoordinateIndex", ":", 
      RowBox[{"(", 
       RowBox[{"1", "|", "2"}], ")"}]}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"FigResolveDisplacement", "[", "p", "]"}], "[", 
    RowBox[{"[", "CoordinateIndex", "]"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.516046467942625*^9, 3.5160465244895*^9}, 
   3.516047415177*^9, {3.516047556192625*^9, 3.51604755827075*^9}, 
   3.516047601661375*^9, {3.516047804473875*^9, 3.5160478323645*^9}, {
   3.5184621599375*^9, 3.518462185796875*^9}, {3.5775521056959915`*^9, 
   3.5775521493110523`*^9}},ExpressionUUID->"44de38e4-9159-4182-a3a2-\
2dd3193e0cdf"],

Cell["Interpret Horizontal/Vertical as arguments", "Text",
 CellChangeTimes->{{3.516047836130125*^9, 
  3.51604784989575*^9}},ExpressionUUID->"c8a4a6ea-5746-4da3-8ec9-\
e92f295f7df2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveCoordinateDisplacement", "[", 
    RowBox[{"x_", ",", "Horizontal"}], "]"}], ":=", 
   RowBox[{"FigResolveCoordinateDisplacement", "[", 
    RowBox[{"x", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveCoordinateDisplacement", "[", 
    RowBox[{"x_", ",", "Vertical"}], "]"}], ":=", 
   RowBox[{"FigResolveCoordinateDisplacement", "[", 
    RowBox[{"x", ",", "2"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.516046467942625*^9, 3.5160465244895*^9}, 
   3.516047415177*^9, {3.516047556192625*^9, 3.51604755827075*^9}, 
   3.516047601661375*^9, {3.516047804473875*^9, 3.5160478323645*^9}, {
   3.577552122316015*^9, 
   3.5775521265760207`*^9}},ExpressionUUID->"dca82be7-0848-469f-be57-\
44b1eb2a77d9"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Point set geometry", "Section",
 CellChangeTimes->{{3.515953547734375*^9, 
  3.515953550140625*^9}},ExpressionUUID->"b7ed01c5-cb36-4cc2-80d8-\
74ad697dd93b"],

Cell[CellGroupData[{

Cell["Point set pattern", "Subsection",
 CellChangeTimes->{{3.515883408046875*^9, 3.515883414421875*^9}, {
  3.5159535560625*^9, 
  3.515953556546875*^9}},ExpressionUUID->"a798bf59-9dd0-429d-b4f7-\
2a6f15c95907"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigPointSetPattern", "[", "n_Integer", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"Repeated", "[", 
     RowBox[{"FigPointPattern", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "Infinity"}], "}"}]}], "]"}], "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515439472969125*^9, 3.51543948604725*^9}, {
   3.515450698281625*^9, 3.515450701687875*^9}, {3.515530339265625*^9, 
   3.5155303765*^9}, {3.515530557765625*^9, 3.515530569203125*^9}, {
   3.5155975314375*^9, 3.51559754925*^9}, {3.515597792984375*^9, 
   3.51559779728125*^9}, {3.515598279671875*^9, 3.515598286234375*^9}, {
   3.515613950328125*^9, 3.51561395671875*^9}, 3.515615579109375*^9, {
   3.515615903859375*^9, 3.515615912078125*^9}, {3.51561688265625*^9, 
   3.5156168859375*^9}, {3.515685177828125*^9, 3.515685200484375*^9}, {
   3.515883397828125*^9, 3.51588342459375*^9}, {3.515953558234375*^9, 
   3.51595355859375*^9}},ExpressionUUID->"d1803c0a-9940-4477-965e-\
9001171571f1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Centroid of point set", "Subsection",
 CellChangeTimes->{{3.515605128859375*^9, 
  3.51560513228125*^9}},ExpressionUUID->"a20d4996-56df-4e15-a237-\
9128f9a10302"],

Cell["\<\
Note: Returns a Canvas point specification, rather than just a canvas \
coordinate pair.  This is so the user can use PointCentroid[] as a point \
specification.\
\>", "Text",
 CellChangeTimes->{{3.515614705796875*^9, 3.515614728171875*^9}, {
  3.515953573375*^9, 
  3.5159536025625*^9}},ExpressionUUID->"fb0382cd-f379-4c98-9718-71e80c6e64b6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CentroidPoint", "[", 
    RowBox[{"PointSet", ":", 
     RowBox[{"FigPointSetPattern", "[", "1", "]"}]}], "]"}], ":=", 
   RowBox[{"Canvas", "[", 
    RowBox[{"Mean", "[", 
     RowBox[{"FigResolvePoint", "/@", "PointSet"}], "]"}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51560881140625*^9, 3.51560881715625*^9}, {
  3.515608865109375*^9, 3.515608866390625*^9}, {3.5156164674375*^9, 
  3.515616468625*^9}, {3.516035884848875*^9, 
  3.516035886973875*^9}},ExpressionUUID->"194eb7ca-73f7-4bc3-8036-\
4dc384eec197"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bounding box of point set", "Subsection",
 CellChangeTimes->{{3.515166674140625*^9, 3.515166694546875*^9}, {
  3.51545023029725*^9, 3.5154502318285*^9}, {3.515616428796875*^9, 
  3.515616447625*^9}, {3.5240709911875*^9, 
  3.52407099534375*^9}},ExpressionUUID->"212e9662-e5b5-4a73-8794-\
e7e32fe03ea9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigPointSetBoundingBox", "[", 
    RowBox[{"PointSet", ":", 
     RowBox[{"FigPointSetPattern", "[", "1", "]"}]}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Min", "[", 
        RowBox[{"First", "/@", "PointSet"}], "]"}], ",", 
       RowBox[{"Max", "[", 
        RowBox[{"First", "/@", "PointSet"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Min", "[", 
        RowBox[{"Last", "/@", "PointSet"}], "]"}], ",", 
       RowBox[{"Max", "[", 
        RowBox[{"Last", "/@", "PointSet"}], "]"}]}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51516616575*^9, 3.51516620196875*^9}, {
   3.515166363734375*^9, 3.51516642103125*^9}, {3.5151665123125*^9, 
   3.51516652478125*^9}, 3.515167326484375*^9, {3.515167359171875*^9, 
   3.515167378671875*^9}, {3.515167540625*^9, 3.515167556453125*^9}, {
   3.51545042535975*^9, 3.515450461031625*^9}, 3.516039158067625*^9, 
   3.524070974171875*^9},ExpressionUUID->"55d0e707-89a8-4523-bf20-\
602d1217b15c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rectangle/ellipse geometry", "Section",
 CellChangeTimes->{{3.515612120984375*^9, 3.515612123390625*^9}, {
  3.515615859109375*^9, 3.515615859828125*^9}, {3.515619430953125*^9, 
  3.515619431921875*^9}, {3.515854053390625*^9, 3.515854054609375*^9}, {
  3.5194943288125*^9, 
  3.519494332171875*^9}},ExpressionUUID->"3c24d3d3-44aa-4f29-9240-\
50a3b1b07941"],

Cell[CellGroupData[{

Cell["Radius pattern", "Subsection",
 CellChangeTimes->{{3.515610554171875*^9, 
  3.51561055915625*^9}},ExpressionUUID->"57b1f488-0390-45c1-a26a-\
bf0e4c313dac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FigRadiusPattern", "=", 
   RowBox[{"NonNegativeIntervalParametersPattern", "|", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Horizontal", "|", "Vertical", "|", "Canvas", "|", "Scaled"}], 
       ")"}], "[", "NonNegativeIntervalParametersPattern", "]"}], ")"}], "|", 
    
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"_", "?", "NonNegative"}], ")"}], "|", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Scaled", "|", "Canvas"}], ")"}], "[", 
         RowBox[{"(", 
          RowBox[{"_", "?", "NonNegative"}], ")"}], "]"}]}], ")"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"_", "?", "NonNegative"}], ")"}], "|", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Scaled", "|", "Canvas"}], ")"}], "[", 
         RowBox[{"(", 
          RowBox[{"_", "?", "NonNegative"}], ")"}], "]"}]}], ")"}]}], 
     "\[IndentingNewLine]", "}"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51561057296875*^9, 3.515610592296875*^9}, {
  3.515611154578125*^9, 3.515611156109375*^9}, {3.515611416296875*^9, 
  3.515611429078125*^9}, {3.515612473546875*^9, 3.5156124871875*^9}, {
  3.515612659125*^9, 3.515612676546875*^9}, {3.5775525711766434`*^9, 
  3.577552576796651*^9}},ExpressionUUID->"a3ecbc5b-ddb4-4bf8-bf00-\
908e6610fe4d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Geometry calculations", "Subsection",
 CellChangeTimes->{{3.519494339390625*^9, 
  3.519494341953125*^9}},ExpressionUUID->"b04e78d3-25f1-4f45-83a6-\
bce06a243c00"],

Cell["\<\
calculate {CanvasCenter,CanvasRadius,CanvasPivot,RotationAngle} for a rectangle
this function takes care of point resolution for the argumentsbut does no \
option validation\
\>", "Text",
 CellChangeTimes->{{3.5666623228196354`*^9, 3.566662336259654*^9}, {
  3.566662531059927*^9, 
  3.5666625458299475`*^9}},ExpressionUUID->"535b24c2-8e49-41b9-97d1-\
dba5a183a7df"],

Cell["given center (with option Radius)", "Text",
 CellChangeTimes->{{3.515857538046875*^9, 
  3.515857549203125*^9}},ExpressionUUID->"0646e09c-6520-45ad-8b0f-\
7c9a8d721bd1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeRectangleGeometry", "[", 
    RowBox[{
     RowBox[{"p", ":", "FigPointPattern"}], ",", "FullOptions_List"}], "]"}], 
   ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Anchor", ",", "UsedAnchorOffset", ",", "UsedPivotOffset", ",", 
       "\[IndentingNewLine]", "CanvasCenter", ",", "CanvasRadius", ",", 
       "CanvasPivot", ",", "RotationAngle"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"resolve", " ", "arguments"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Anchor", "=", 
       RowBox[{"FigAnchor", "[", "p", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"CanvasRadius", "=", 
       RowBox[{"FigResolveRadius", "[", 
        RowBox[{"(", 
         RowBox[{"Radius", "/.", "FullOptions"}], ")"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"UsedAnchorOffset", "=", 
       RowBox[{"FigResolveOffset", "[", 
        RowBox[{"(", 
         RowBox[{"AnchorOffset", "/.", "FullOptions"}], ")"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"UsedPivotOffset", "=", 
       RowBox[{"FigResolveOffset", "[", 
        RowBox[{"ResolveOption", "[", 
         RowBox[{"PivotOffset", ",", 
          RowBox[{"{", 
           RowBox[{"Automatic", "\[Rule]", "UsedAnchorOffset"}], "}"}], ",", 
          "FullOptions"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"RotationAngle", "=", 
       RowBox[{"UpgradeScalar", "[", 
        RowBox[{"ResolveOption", "[", 
         RowBox[{"Rotate", ",", 
          RowBox[{"{", 
           RowBox[{"Automatic", "\[Rule]", 
            RowBox[{"AnchorAngle", "[", "Anchor", "]"}]}], "}"}], ",", 
          "FullOptions"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"derived", " ", "geometry"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"CanvasCenter", "=", 
       RowBox[{
        RowBox[{"FigResolvePoint", "[", "Anchor", "]"}], "-", 
        RowBox[{"UsedAnchorOffset", "*", "CanvasRadius"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CanvasPivot", "=", 
       RowBox[{"CanvasCenter", "+", 
        RowBox[{"UsedPivotOffset", "*", "CanvasRadius"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"combined", " ", "answer"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "CanvasCenter", ",", "CanvasRadius", ",", "CanvasPivot", ",", 
        "RotationAngle"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51949340609375*^9, 3.51949361109375*^9}, 
   3.519493832640625*^9, {3.51949386959375*^9, 3.519493884828125*^9}, {
   3.5194939371875*^9, 3.5194941966875*^9}, {3.51949431403125*^9, 
   3.51949431565625*^9}, 
   3.519497099984375*^9},ExpressionUUID->"dbb5a96b-d478-4236-bd7e-\
c6587d990607"],

Cell["given diametric corners", "Text",
 CellChangeTimes->{{3.5158575525*^9, 
  3.515857557328125*^9}},ExpressionUUID->"8e383f66-74c6-44ac-813f-\
fd268fde4db8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeRectangleGeometry", "[", 
    RowBox[{
     RowBox[{"p1", ":", "FigPointPattern"}], ",", 
     RowBox[{"p2", ":", "FigPointPattern"}], ",", "FullOptions_List"}], "]"}],
    ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "CanvasCorner1", ",", "CanvasCorner2", ",", "CanvasCenter", ",", 
       "CanvasPivot", ",", "CanvasRadius", ",", "RotationAngle", ",", 
       "UsedRoundingRadius"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"generate", " ", "geometry"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CanvasCorner1", "=", 
       RowBox[{"FigResolvePoint", "[", "p1", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CanvasCorner2", "=", 
       RowBox[{"FigResolvePoint", "[", "p2", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CanvasCenter", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"CanvasCorner2", "+", "CanvasCorner1"}], ")"}], "/", "2"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"CanvasRadius", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"CanvasCorner2", "-", "CanvasCorner1"}], ")"}], "/", "2"}], 
        "]"}]}], ";", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Abs", " ", "allows", " ", "any", " ", "two", " ", "points", " ", 
         "to", " ", "be", " ", "taken"}], ",", " ", 
        RowBox[{
        "not", " ", "just", " ", "lower", " ", "left", " ", "to", " ", 
         "upper", " ", "right"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"invoke", " ", "base", " ", "form"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"MakeRectangleGeometry", " ", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Canvas", "[", "CanvasCenter", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"AnchorOffset", "\[Rule]", "Center"}], ",", 
            RowBox[{"Radius", "\[Rule]", 
             RowBox[{"Canvas", "[", "CanvasRadius", "]"}]}]}], "}"}], ",", 
          "FullOptions"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51510150784375*^9, 3.51510165284375*^9}, {
   3.5151018264375*^9, 3.515101837625*^9}, {3.515160729234375*^9, 
   3.5151607388125*^9}, {3.515160815109375*^9, 3.515160905421875*^9}, {
   3.515429900281625*^9, 3.5154299283285*^9}, {3.515432005344125*^9, 
   3.51543202310975*^9}, {3.515432080625375*^9, 3.515432260875375*^9}, {
   3.515432559875375*^9, 3.515432618141*^9}, {3.515432654812875*^9, 
   3.515432706531625*^9}, {3.515433020406625*^9, 3.515433023781625*^9}, {
   3.515442053016*^9, 3.5154420783285*^9}, {3.51544252460975*^9, 
   3.515442586281625*^9}, {3.5154469192035*^9, 3.515446929391*^9}, {
   3.5154471764535*^9, 3.515447183094125*^9}, {3.515447219250375*^9, 
   3.515447220250375*^9}, {3.515447301531625*^9, 3.5154473044535*^9}, 
   3.515448155969125*^9, {3.515449235594125*^9, 3.515449253000375*^9}, 
   3.51545048954725*^9, {3.51545052173475*^9, 3.5154505228285*^9}, {
   3.51561162565625*^9, 3.51561168884375*^9}, {3.515613185078125*^9, 
   3.51561321028125*^9}, {3.515618454140625*^9, 3.51561845509375*^9}, {
   3.515618558328125*^9, 3.5156186138125*^9}, {3.515618681625*^9, 
   3.51561873415625*^9}, {3.51561877528125*^9, 3.515618818671875*^9}, {
   3.51561889240625*^9, 3.515618944546875*^9}, {3.515618982953125*^9, 
   3.515619023359375*^9}, {3.515619092859375*^9, 3.515619138140625*^9}, {
   3.515619171359375*^9, 3.515619215109375*^9}, {3.51562323090625*^9, 
   3.515623257734375*^9}, {3.51562330753125*^9, 3.515623308109375*^9}, {
   3.515681444234375*^9, 3.515681508125*^9}, 3.51568187259375*^9, {
   3.515682018390625*^9, 3.51568221309375*^9}, {3.51568226515625*^9, 
   3.5156822661875*^9}, {3.515682919375*^9, 3.5156829705625*^9}, {
   3.51568384184375*^9, 3.515683846484375*^9}, {3.515684146515625*^9, 
   3.51568417878125*^9}, {3.515684224390625*^9, 3.515684240109375*^9}, {
   3.515684273125*^9, 3.515684274734375*^9}, {3.515684459265625*^9, 
   3.515684461609375*^9}, {3.51568454121875*^9, 3.515684560484375*^9}, {
   3.51568461046875*^9, 3.515684631296875*^9}, {3.51568532846875*^9, 
   3.515685330359375*^9}, {3.5156861304375*^9, 3.515686149703125*^9}, 
   3.515686398875*^9, {3.515857189484375*^9, 3.515857194375*^9}, {
   3.515857228125*^9, 3.515857237625*^9}, {3.51585727684375*^9, 
   3.515857366875*^9}, 3.515857417078125*^9, {3.515857447453125*^9, 
   3.5158575215625*^9}, {3.51585999478125*^9, 3.515860005375*^9}, {
   3.51586171846875*^9, 3.515861718828125*^9}, 3.5158652513125*^9, {
   3.5158655109375*^9, 3.51586551628125*^9}, 3.51595888284375*^9, {
   3.516291600171875*^9, 3.5162916071875*^9}, 3.51949437234375*^9, {
   3.51949474809375*^9, 3.519494849203125*^9}, {3.5666623714097033`*^9, 
   3.5666624079497547`*^9}, {3.5666624573398237`*^9, 
   3.5666624854498625`*^9}, {3.566662564779974*^9, 3.5666625688899794`*^9}, {
   3.624758806941062*^9, 
   3.6247588594050627`*^9}},ExpressionUUID->"d8c305a4-aac9-4035-b10d-\
dccbb52641ba"],

Cell["given region specification", "Text",
 CellChangeTimes->{{3.515857562734375*^9, 
  3.515857567828125*^9}},ExpressionUUID->"be2226b4-5580-451a-a405-\
ba82998d14c1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeRectangleGeometry", "[", 
    RowBox[{
     RowBox[{"r", ":", "FigRegionPattern"}], ",", "FullOptions_List"}], "]"}],
    ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "CanvasRegion", ",", "CanvasCorner1", ",", "CanvasCorner2", ",", 
       "CanvasCenter", ",", "CanvasPivot", ",", "CanvasRadius", ",", 
       "RotationAngle", ",", "UsedRoundingRadius"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"generate", " ", "geometry"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CanvasRegion", "=", 
       RowBox[{"FigResolveRegion", "[", "r", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"CanvasCorner1", ",", "CanvasCorner2"}], "}"}], "=", 
       RowBox[{"Transpose", "@", "CanvasRegion"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CanvasCenter", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"CanvasCorner2", "+", "CanvasCorner1"}], ")"}], "/", "2"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"CanvasRadius", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"CanvasCorner2", "-", "CanvasCorner1"}], ")"}], "/", "2"}], 
        "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Abs", " ", "allows", " ", "any", " ", "two", " ", "points", " ", 
         "to", " ", "be", " ", "taken"}], ",", " ", 
        RowBox[{
        "not", " ", "just", " ", "lower", " ", "left", " ", "to", " ", 
         "upper", " ", "right"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"invoke", " ", "base", " ", "form"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"MakeRectangleGeometry", " ", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Canvas", "[", "CanvasCenter", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"AnchorOffset", "\[Rule]", "Center"}], ",", 
            RowBox[{"Radius", "\[Rule]", 
             RowBox[{"Canvas", "[", "CanvasRadius", "]"}]}]}], "}"}], ",", 
          "FullOptions"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51510150784375*^9, 3.51510165284375*^9}, {
   3.5151018264375*^9, 3.515101837625*^9}, {3.515160729234375*^9, 
   3.5151607388125*^9}, {3.515160815109375*^9, 3.515160905421875*^9}, {
   3.515429900281625*^9, 3.5154299283285*^9}, {3.515432005344125*^9, 
   3.51543202310975*^9}, {3.515432080625375*^9, 3.515432260875375*^9}, {
   3.515432559875375*^9, 3.515432618141*^9}, {3.515432654812875*^9, 
   3.515432706531625*^9}, {3.515433020406625*^9, 3.515433023781625*^9}, {
   3.515442053016*^9, 3.5154420783285*^9}, {3.51544252460975*^9, 
   3.515442586281625*^9}, {3.5154469192035*^9, 3.515446929391*^9}, {
   3.5154471764535*^9, 3.515447183094125*^9}, {3.515447219250375*^9, 
   3.515447220250375*^9}, {3.515447301531625*^9, 3.5154473044535*^9}, 
   3.515448155969125*^9, {3.515449235594125*^9, 3.515449253000375*^9}, 
   3.51545048954725*^9, {3.51545052173475*^9, 3.5154505228285*^9}, {
   3.51561162565625*^9, 3.51561168884375*^9}, {3.515613185078125*^9, 
   3.51561321028125*^9}, {3.515618454140625*^9, 3.51561845509375*^9}, {
   3.515618558328125*^9, 3.5156186138125*^9}, {3.515618681625*^9, 
   3.51561873415625*^9}, {3.51561877528125*^9, 3.515618818671875*^9}, {
   3.51561889240625*^9, 3.515618944546875*^9}, {3.515618982953125*^9, 
   3.515619023359375*^9}, {3.515619092859375*^9, 3.515619138140625*^9}, {
   3.515619171359375*^9, 3.515619215109375*^9}, {3.51562323090625*^9, 
   3.515623257734375*^9}, {3.51562330753125*^9, 3.515623308109375*^9}, {
   3.515681444234375*^9, 3.515681508125*^9}, 3.51568187259375*^9, {
   3.515682018390625*^9, 3.51568221309375*^9}, {3.51568226515625*^9, 
   3.5156822661875*^9}, {3.515682919375*^9, 3.5156829705625*^9}, {
   3.51568384184375*^9, 3.515683846484375*^9}, {3.515684146515625*^9, 
   3.51568417878125*^9}, {3.515684224390625*^9, 3.515684240109375*^9}, {
   3.515684273125*^9, 3.515684274734375*^9}, {3.515684459265625*^9, 
   3.515684461609375*^9}, {3.51568454121875*^9, 3.515684560484375*^9}, {
   3.51568461046875*^9, 3.515684631296875*^9}, {3.51568532846875*^9, 
   3.515685330359375*^9}, {3.5156861304375*^9, 3.515686149703125*^9}, 
   3.515686398875*^9, {3.515857189484375*^9, 3.515857194375*^9}, {
   3.515857228125*^9, 3.515857237625*^9}, {3.51585727684375*^9, 
   3.515857366875*^9}, 3.515857417078125*^9, {3.515857447453125*^9, 
   3.5158575215625*^9}, {3.515857619859375*^9, 3.515857621234375*^9}, {
   3.51585765746875*^9, 3.51585769365625*^9}, 3.515860007921875*^9, {
   3.5158617195625*^9, 3.51586172084375*^9}, 3.515865255828125*^9, {
   3.515865521609375*^9, 3.515865535234375*^9}, {3.515865578796875*^9, 
   3.51586557909375*^9}, 3.5159588880625*^9, {3.516287250515625*^9, 
   3.516287251265625*^9}, {3.516291610375*^9, 3.516291614703125*^9}, 
   3.519494373265625*^9, 3.51949488159375*^9, {3.5666624992798824`*^9, 
   3.5666625195499105`*^9}, {3.566662556219962*^9, 3.5666625840300007`*^9}, {
   3.624758850125532*^9, 
   3.6247588647333674`*^9}},ExpressionUUID->"e94c2c15-03a8-40f0-a653-\
a70cfcda4066"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Make region given rectangle specification", "Subsection",
 CellChangeTimes->{{3.566663311151019*^9, 
  3.566663316491027*^9}},ExpressionUUID->"8ce08940-67a2-4914-be71-\
bdac61abad24"],

Cell["\<\
User-level function to convert a rectangle specification to a Canvas region \
specification
For rotated rectangle, circumscribing bounding box is used\
\>", "Text",
 CellChangeTimes->{{3.566663356801083*^9, 
  3.5666633970411396`*^9}},ExpressionUUID->"a455493a-3c0a-438d-8453-\
511ed5e3516f"],

Cell["TODO option resultion and validation", "Text",
 CellChangeTimes->{{3.566663736575616*^9, 
  3.566663741215622*^9}},ExpressionUUID->"adafc5ea-8ea4-40fa-b8c0-\
ca1e97235d2e"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"RectangleRegion", "[", "Args___", "]"}], ":=", 
    RowBox[{"Canvas", "[", 
     RowBox[{"FigRectangleBoundingBox", "@@", 
      RowBox[{"MakeRectangleGeometry", "[", "Args", "]"}]}], "]"}]}], ";"}], 
  "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5666633238710375`*^9, 3.5666633755211096`*^9}, {
  3.566663408181155*^9, 3.566663420321172*^9}, {3.5666637340006123`*^9, 
  3.566663734625613*^9}},ExpressionUUID->"4367fed4-b022-42a3-96e7-\
391b3e86c480"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Standard rectangle geometry options", "Subsection",
 CellChangeTimes->{{3.5154308919535*^9, 3.515430894656625*^9}, {
  3.51543111848475*^9, 3.51543111998475*^9}, {3.515681194203125*^9, 
  3.515681195296875*^9}, {3.51949454353125*^9, 3.5194945450625*^9}, {
  3.519557889453125*^9, 
  3.519557891640625*^9}},ExpressionUUID->"afbe4314-bee8-40b0-8fa3-\
e46be0e3afb7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FigRectangleOptions", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", "geometry", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Radius", "\[Rule]", "1"}], ",", 
     RowBox[{"AnchorOffset", "\[Rule]", "Center"}], ",", 
     RowBox[{"PivotOffset", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"Rotate", "\[Rule]", "None"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515430903687875*^9, 3.515430989031625*^9}, {
   3.515431026844125*^9, 3.515431030625375*^9}, {3.515431105094125*^9, 
   3.5154311113285*^9}, 3.515609867390625*^9, {3.515610068609375*^9, 
   3.51561007096875*^9}, {3.5156102813125*^9, 3.515610326796875*^9}, {
   3.515611182890625*^9, 3.515611184453125*^9}, {3.51561123521875*^9, 
   3.5156112356875*^9}, {3.5156812055*^9, 3.51568120890625*^9}, {
   3.515681963703125*^9, 3.515681982015625*^9}, {3.519493122078125*^9, 
   3.519493136890625*^9}, {3.519493371640625*^9, 3.519493373203125*^9}, {
   3.519493924953125*^9, 3.519493929265625*^9}, 3.519494362*^9, {
   3.519557624046875*^9, 3.519557624578125*^9}, 
   3.519557847625*^9},ExpressionUUID->"d2cd1ff7-d7fb-4e04-84bb-c211dbcafef5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigCheckRectangleOptions", "[", "Self_Object", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FigCheckOption", "[", 
       RowBox[{
       "Self", ",", "Radius", ",", "FigRadiusPattern", ",", "FigOptions"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{
       "Self", ",", "AnchorOffset", ",", "FigOffsetPattern", ",", 
        "FigOptions"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{"Self", ",", "PivotOffset", ",", 
        RowBox[{"Automatic", "|", "FigOffsetPattern"}], ",", "FigOptions"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{"Self", ",", "Rotate", ",", 
        RowBox[{"Automatic", "|", "ScalarParameterPattern"}], ",", 
        "FigOptions"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5156100370625*^9, 3.515610074328125*^9}, {
   3.515610247703125*^9, 3.515610278484375*^9}, {3.51561033215625*^9, 
   3.5156103411875*^9}, {3.51561118840625*^9, 3.515611213953125*^9}, {
   3.515681221765625*^9, 3.515681251484375*^9}, {3.515681835359375*^9, 
   3.515681860875*^9}, {3.515681987921875*^9, 3.515681996453125*^9}, {
   3.515708374421875*^9, 3.51570837446875*^9}, {3.51570843621875*^9, 
   3.5157084375*^9}, {3.519493202875*^9, 3.519493243390625*^9}, {
   3.519493366375*^9, 3.519493367765625*^9}, {3.519493918171875*^9, 
   3.51949392159375*^9}, 3.5194943625*^9, 
   3.51955788621875*^9},ExpressionUUID->"9425a7ff-f8d8-400e-bee4-\
27207a797e72"]
}, Open  ]],

Cell[CellGroupData[{

Cell["FigResolveRadius", "Subsection",
 CellChangeTimes->{{3.515612142890625*^9, 
  3.515612146890625*^9}},ExpressionUUID->"c82253e9-91b7-4c7f-9bb6-\
c417cb79b39b"],

Cell["\<\
closely related to FigResolveDisplacement:
\t-- upgrades single radius argument
\t-- allows for \[OpenCurlyDoubleQuote]vertical\[CloseCurlyDoubleQuote] or \
\[OpenCurlyDoubleQuote]horizontal\[CloseCurlyDoubleQuote] units
\t-- requires nonnegative arguments\
\>", "Text",
 CellChangeTimes->{{3.577552303241268*^9, 
  3.577552386006384*^9}},ExpressionUUID->"06c5f997-9bf0-481c-aa2f-\
4a850b82792c"],

Cell["User coordinates: None or r or {rx,ry}", "Text",
 CellChangeTimes->{{3.515612317875*^9, 
  3.515612350390625*^9}},ExpressionUUID->"09c430bf-ce29-4720-bd11-\
626cdaa6d3cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveRadius", "[", 
    RowBox[{"r", ":", "NonNegativeIntervalParametersPattern"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"CurrentWindow", "[", "]"}], "@", 
      RowBox[{"DeltaTFunction", "[", "]"}]}], ")"}], "@", 
    RowBox[{"UpgradePairEqual", "[", "r", "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515612152828125*^9, 3.515612227046875*^9}, {
   3.51561228878125*^9, 3.515612301140625*^9}, 
   3.515784134828125*^9},ExpressionUUID->"e090ec7f-9d98-443d-978a-\
bd32822a4eb6"],

Cell["\<\
Horizontal user coordinates: Horizontal[None] or Horizontal[r] or \
Horizontal[{rx,ry}]\
\>", "Text",
 CellChangeTimes->{{3.515612317875*^9, 
  3.51561238440625*^9}},ExpressionUUID->"d5ca4f72-f932-4462-b9ca-\
bf512a1e2a30"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveRadius", "[", 
    RowBox[{"Horizontal", "[", 
     RowBox[{"r", ":", "NonNegativeIntervalParametersPattern"}], "]"}], "]"}],
    ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "LengthUnit", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"LengthUnit", "=", 
       RowBox[{"First", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"CurrentWindow", "[", "]"}], "@", 
           RowBox[{"DeltaTFunction", "[", "]"}]}], ")"}], "@", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"LengthUnit", "*", 
       RowBox[{"UpgradePairEqual", "[", "r", "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515612401*^9, 3.51561246034375*^9}, {3.5156125289375*^9,
    3.515612549875*^9}, 
   3.51578413484375*^9},ExpressionUUID->"97576ddc-192f-46a3-a3de-\
788028e8dc88"],

Cell["\<\
Vertical user coordinates: Vertical[None] or Vertical[r] or Vertical[{rx,ry}]\
\
\>", "Text",
 CellChangeTimes->{{3.515612317875*^9, 3.51561238440625*^9}, {
  3.515612588296875*^9, 
  3.5156125901875*^9}},ExpressionUUID->"6168432d-b464-430d-8f84-10e80748c3b8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveRadius", "[", 
    RowBox[{"Vertical", "[", 
     RowBox[{"r", ":", "NonNegativeIntervalParametersPattern"}], "]"}], "]"}],
    ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "LengthUnit", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"LengthUnit", "=", 
       RowBox[{"Last", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"CurrentWindow", "[", "]"}], "@", 
           RowBox[{"DeltaTFunction", "[", "]"}]}], ")"}], "@", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"LengthUnit", "*", 
       RowBox[{"UpgradePairEqual", "[", "r", "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515612401*^9, 3.51561246034375*^9}, {3.5156125289375*^9,
    3.51561259175*^9}, 
   3.515784134859375*^9},ExpressionUUID->"9b201589-aa61-492b-b025-\
715d4719e45e"],

Cell["\<\
Canvas coordinates: Canvas[None] or Canvas[r] or Canvas[{rx,ry}]\
\>", "Text",
 CellChangeTimes->{{3.515612317875*^9, 3.51561238440625*^9}, {
  3.515612588296875*^9, 
  3.515612626015625*^9}},ExpressionUUID->"934aff96-5ff2-480d-8aef-\
00b0fc057ae0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveRadius", "[", 
    RowBox[{"Canvas", "[", 
     RowBox[{"r", ":", "NonNegativeIntervalParametersPattern"}], "]"}], "]"}],
    ":=", 
   RowBox[{"UpgradePairEqual", "[", "r", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515612401*^9, 3.51561246034375*^9}, {3.5156125289375*^9,
   3.51561259175*^9}, {3.51561262853125*^9, 
  3.515612638796875*^9}},ExpressionUUID->"dbce92f3-5ce5-45d5-9d48-\
cfd57a96aaf1"],

Cell["\<\
Scaled coordinates: Scaled[None] or Scaled[r] or Scaled[{rx,ry}]\
\>", "Text",
 CellChangeTimes->{{3.515612317875*^9, 3.51561238440625*^9}, {
  3.515612588296875*^9, 3.515612626015625*^9}, {3.515612721078125*^9, 
  3.515612722625*^9}},ExpressionUUID->"2a43717b-816c-41fe-9ad2-e9af2b14afbb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveRadius", "[", 
    RowBox[{"Scaled", "[", 
     RowBox[{"r", ":", "NonNegativeIntervalParametersPattern"}], "]"}], "]"}],
    ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"CurrentWindow", "[", "]"}], "@", 
      RowBox[{"ScaledDeltaTFunction", "[", "]"}]}], ")"}], "@", 
    RowBox[{"UpgradePairEqual", "[", "r", "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515612401*^9, 3.51561246034375*^9}, {3.5156125289375*^9,
    3.51561259175*^9}, {3.51561262853125*^9, 3.515612638796875*^9}, {
   3.5156127235*^9, 3.51561273265625*^9}, {3.515612774234375*^9, 
   3.51561277878125*^9}, 
   3.515784134890625*^9},ExpressionUUID->"39f0dbb2-878b-4fa6-a118-\
3fe79284a8ba"],

Cell["Ad hoc treatment of hybrid coordinates", "Text",
 CellChangeTimes->{{3.5365308433125*^9, 3.536530862453125*^9}, 
   3.5775516678053784`*^9},ExpressionUUID->"d4379402-cb93-4385-9e17-\
70d3f04f539e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveRadius", "[", "\[IndentingNewLine]", 
    RowBox[{"p", ":", 
     RowBox[{"Except", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x", ":", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"_", "?", "NonNegative"}], ")"}], "|", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Scaled", "|", "Canvas"}], ")"}], "[", 
             RowBox[{"(", 
              RowBox[{"_", "?", "NonNegative"}], ")"}], "]"}]}], ")"}]}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"y", ":", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"_", "?", "NonNegative"}], ")"}], "|", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Scaled", "|", "Canvas"}], ")"}], "[", 
             RowBox[{"(", 
              RowBox[{"_", "?", "NonNegative"}], ")"}], "]"}]}], ")"}]}]}], 
        "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}], ":=", 
   RowBox[{"FigResolveDisplacement", "[", "p", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.53653087075*^9, 3.536530887890625*^9}, {
   3.536530960421875*^9, 3.536530998171875*^9}, 3.5775516748953886`*^9, {
   3.5775517490554924`*^9, 3.577551751385495*^9}, {3.5775524291664443`*^9, 
   3.577552473066506*^9}},ExpressionUUID->"63c6f0a2-9cb8-4a5c-bde8-\
58e18412b5eb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rectangle \[OpenCurlyDoubleQuote]circumference\[CloseCurlyDoubleQuote] \
points", "Subsection",
 CellChangeTimes->{{3.51585621278125*^9, 
  3.51585621846875*^9}},ExpressionUUID->"e3a8fb19-2051-49a8-96aa-\
2d0616f6630c"],

Cell["used also for circle geometry", "Text",
 CellChangeTimes->{{3.5158562263125*^9, 
  3.515856232375*^9}},ExpressionUUID->"5a1942ac-99fe-4066-8c15-e1affc396d08"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RectangleOffsetPoint", "[", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}], ",", 
     RowBox[{"Offset", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"RotationTransform", "[", 
     RowBox[{"RotationAngle", ",", "CanvasPivot"}], "]"}], "@", 
    RowBox[{"(", 
     RowBox[{"CanvasCenter", "+", 
      RowBox[{"CanvasRadius", "*", "Offset"}]}], ")"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51585567546875*^9, 3.515855770515625*^9}, {
   3.51585585721875*^9, 3.515855861734375*^9}, {3.5158563874375*^9, 
   3.515856391078125*^9}, {3.515857048875*^9, 3.515857049875*^9}, 
   3.5158570894375*^9},ExpressionUUID->"8e421d79-41b4-4286-bfcc-72969fccc67c"],

Cell["\<\
segments orientations are in the \[OpenCurlyDoubleQuote]upward\
\[CloseCurlyDoubleQuote] and \[OpenCurlyDoubleQuote]rightward\
\[CloseCurlyDoubleQuote] directions (with respect to the original unrotated \
rectangle)\
\>", "Text",
 CellChangeTimes->{{3.515856289578125*^9, 
  3.515856317984375*^9}},ExpressionUUID->"871d035a-cf7e-431c-9263-\
ec51894195a3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RectangleSideSegment", "[", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}], ",", 
     RowBox[{"Side", ":", "Left"}]}], "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RectangleOffsetPoint", "[", 
      RowBox[{
      "CanvasCenter", ",", "CanvasRadius", ",", "CanvasPivot", ",", 
       "RotationAngle", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"RectangleOffsetPoint", "[", 
      RowBox[{
      "CanvasCenter", ",", "CanvasRadius", ",", "CanvasPivot", ",", 
       "RotationAngle", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"+", "1"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RectangleSideSegment", "[", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}], ",", 
     RowBox[{"Side", ":", "Right"}]}], "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RectangleOffsetPoint", "[", 
      RowBox[{
      "CanvasCenter", ",", "CanvasRadius", ",", "CanvasPivot", ",", 
       "RotationAngle", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"+", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"RectangleOffsetPoint", "[", 
      RowBox[{
      "CanvasCenter", ",", "CanvasRadius", ",", "CanvasPivot", ",", 
       "RotationAngle", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"+", "1"}], ",", 
         RowBox[{"+", "1"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RectangleSideSegment", "[", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}], ",", 
     RowBox[{"Side", ":", "Bottom"}]}], "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RectangleOffsetPoint", "[", 
      RowBox[{
      "CanvasCenter", ",", "CanvasRadius", ",", "CanvasPivot", ",", 
       "RotationAngle", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"RectangleOffsetPoint", "[", 
      RowBox[{
      "CanvasCenter", ",", "CanvasRadius", ",", "CanvasPivot", ",", 
       "RotationAngle", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"+", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RectangleSideSegment", "[", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}], ",", 
     RowBox[{"Side", ":", "Top"}]}], "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RectangleOffsetPoint", "[", 
      RowBox[{
      "CanvasCenter", ",", "CanvasRadius", ",", "CanvasPivot", ",", 
       "RotationAngle", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"+", "1"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"RectangleOffsetPoint", "[", 
      RowBox[{
      "CanvasCenter", ",", "CanvasRadius", ",", "CanvasPivot", ",", 
       "RotationAngle", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"+", "1"}], ",", 
         RowBox[{"+", "1"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51585567546875*^9, 3.515855770515625*^9}, {
  3.51585585721875*^9, 3.515855861734375*^9}, {3.5158562369375*^9, 
  3.515856285171875*^9}, {3.515856320421875*^9, 3.5158564296875*^9}, {
  3.51585708996875*^9, 3.515857093671875*^9}, {3.515864340796875*^9, 
  3.51586434390625*^9}},ExpressionUUID->"b0e2c9fb-f41e-4a58-b483-\
a589437dcf20"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rectangle anchors", "Subsection",
 CellChangeTimes->{{3.515619435859375*^9, 3.515619463203125*^9}, {
  3.515854266515625*^9, 
  3.5158542678125*^9}},ExpressionUUID->"d0f63447-6cc7-4e8e-99d6-88998158d9f2"],

Cell["A \[OpenCurlyDoubleQuote]rectangle\[CloseCurlyDoubleQuote] here more \
generally means a tilted rectangle", "Text",
 CellChangeTimes->{{3.51561946596875*^9, 3.51561947509375*^9}, {
  3.51585427165625*^9, 
  3.515854275765625*^9}},ExpressionUUID->"69521328-098d-4556-adf5-\
f195a1e5da96"],

Cell["\<\
Named points: Center (default), Left/Right, Bottom/Top
\tidentical to circle, sans AngleRange parameter\
\>", "Text",
 CellChangeTimes->{{3.515683659515625*^9, 3.51568367915625*^9}, {
   3.515854295015625*^9, 3.515854314734375*^9}, 3.5665957020770273`*^9, 
   3.5665958654805136`*^9},ExpressionUUID->"06e62720-11de-47cc-92fc-\
2d6b8bdf6797"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigRectangleAnchor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"Name", ":", "NamedPointPattern"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Arg", ":", "None"}]}], "\[IndentingNewLine]", "]"}], ":=", 
   RowBox[{"FigAnchor", "[", 
    RowBox[{
     RowBox[{"Canvas", "[", 
      RowBox[{"RectangleOffsetPoint", "[", 
       RowBox[{
       "CanvasCenter", ",", "CanvasRadius", ",", "CanvasPivot", ",", 
        "RotationAngle", ",", 
        RowBox[{"NamedPointOffset", "[", "Name", "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"-", 
      RowBox[{"NamedPointOffset", "[", "Name", "]"}]}], ",", 
     "RotationAngle"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51561947978125*^9, 3.51561955340625*^9}, 
   3.51561961984375*^9, 3.51568066303125*^9, {3.51568074428125*^9, 
   3.5156807529375*^9}, {3.5156833859375*^9, 3.515683449140625*^9}, {
   3.515683529125*^9, 3.51568352978125*^9}, {3.515683574328125*^9, 
   3.51568360171875*^9}, 3.515686652203125*^9, 3.515855486375*^9, {
   3.51585589378125*^9, 3.51585589428125*^9}, {3.515856060390625*^9, 
   3.5158560630625*^9}, 3.515856410328125*^9, {3.51585677471875*^9, 
   3.51585680621875*^9}, {3.515856858390625*^9, 3.515856863640625*^9}, 
   3.51585709596875*^9, 3.518018926578125*^9, {3.51847384828125*^9, 
   3.518473851484375*^9}, {3.519647287125*^9, 
   3.519647328328125*^9}},ExpressionUUID->"8a61ca0e-7553-4b87-8f19-\
a082559245d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigRectangleAnchor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"Name", ":", "Offset"}], ",", "\[IndentingNewLine]", 
     RowBox[{"OffsetValue", ":", "FigOffsetPattern"}]}], 
    "\[IndentingNewLine]", "]"}], ":=", 
   RowBox[{"FigAnchor", "[", 
    RowBox[{
     RowBox[{"Canvas", "[", 
      RowBox[{"RectangleOffsetPoint", "[", 
       RowBox[{
       "CanvasCenter", ",", "CanvasRadius", ",", "CanvasPivot", ",", 
        "RotationAngle", ",", 
        RowBox[{"FigResolveOffset", "[", "OffsetValue", "]"}]}], "]"}], "]"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", "RotationAngle"}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51956759509375*^9, 3.51956769671875*^9}, 
   3.519647303921875*^9, {3.51964747875*^9, 
   3.519647479515625*^9}},ExpressionUUID->"30b71bfe-9d6e-4bf9-95fa-\
8dd9265cf541"],

Cell["\<\
Side interpolations: {Left|Right|Bottom|Top,x}
Note: Simple side points could be absorbed as special case by making x \
default to 0 but are already handled as named points above.
Reference:(Tail|Center|Head):Center,Mode:(Absolute|Scaled):Scaled\
\>", "Text",
 CellChangeTimes->{{3.515683659515625*^9, 3.51568367915625*^9}, {
  3.515854295015625*^9, 3.515854314734375*^9}, {3.515855561890625*^9, 
  3.515855625140625*^9}, {3.515864215734375*^9, 3.51586424396875*^9}, {
  3.51964565225*^9, 3.519645675921875*^9}, {3.51964740409375*^9, 
  3.5196474663125*^9}},ExpressionUUID->"1c41848a-a10c-4c0a-a92a-8d2b562bbc5b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigRectangleAnchor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"Name", ":", 
      RowBox[{"(", 
       RowBox[{"Left", "|", "Right", "|", "Bottom", "|", "Top"}], ")"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"x_", "?", "NumericQ"}]}], "\[IndentingNewLine]", "]"}], ":=", 
   RowBox[{"FigAnchor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Canvas", "[", "\[IndentingNewLine]", 
      RowBox[{"InterpolateSegment", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"RectangleSideSegment", "[", 
         RowBox[{
         "CanvasCenter", ",", "CanvasRadius", ",", "CanvasPivot", ",", 
          "RotationAngle", ",", "Name"}], "]"}], ",", "\[IndentingNewLine]", 
        "Center", ",", "Scaled", ",", "x"}], "\[IndentingNewLine]", "]"}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"-", 
      RowBox[{"NamedPointOffset", "[", "Name", "]"}]}], ",", 
     "\[IndentingNewLine]", "RotationAngle"}], "\[IndentingNewLine]", "]"}]}],
   ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51561947978125*^9, 3.51561955340625*^9}, {
   3.51561962175*^9, 3.515619730953125*^9}, {3.515619773140625*^9, 
   3.515619811484375*^9}, {3.51562215609375*^9, 3.5156221565*^9}, {
   3.51562352409375*^9, 3.51562353096875*^9}, {3.515680635890625*^9, 
   3.515680669921875*^9}, {3.5156807540625*^9, 3.51568075928125*^9}, {
   3.51568342634375*^9, 3.51568345734375*^9}, {3.515683530296875*^9, 
   3.515683533984375*^9}, {3.51568357875*^9, 3.51568360446875*^9}, {
   3.51585429221875*^9, 3.51585434665625*^9}, {3.515855461015625*^9, 
   3.51585546246875*^9}, {3.515855507375*^9, 3.51585551225*^9}, {
   3.51585587759375*^9, 3.51585588034375*^9}, {3.515855985375*^9, 
   3.5158560140625*^9}, {3.515856116921875*^9, 3.515856171609375*^9}, {
   3.5158564421875*^9, 3.515856445046875*^9}, {3.515856475828125*^9, 
   3.51585657578125*^9}, {3.515856889671875*^9, 3.51585690059375*^9}, {
   3.515863975046875*^9, 3.515863983828125*^9}, {3.515864204734375*^9, 
   3.515864207421875*^9}, 3.518018928671875*^9, {3.51964734409375*^9, 
   3.51964734834375*^9}, {3.51964739053125*^9, 3.51964739146875*^9}, {
   3.51964745184375*^9, 3.5196474560625*^9}, {3.52002508840625*^9, 
   3.520025093484375*^9}},ExpressionUUID->"c83150e9-9a96-4814-93a3-\
b0a5cd41e276"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rectangle bounding box", "Subsection",
 CellChangeTimes->{{3.515619435859375*^9, 3.515619463203125*^9}, {
  3.515854266515625*^9, 3.5158542678125*^9}, {3.5158594105625*^9, 
  3.515859412515625*^9}},ExpressionUUID->"22c2652e-5a89-4137-866e-\
d67e4dde522b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigRectangleBoundingBox", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}]}], "\[IndentingNewLine]", 
    "]"}], ":=", 
   RowBox[{"FigPointSetBoundingBox", "[", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RectangleOffsetPoint", "[", 
       RowBox[{
       "CanvasCenter", ",", "CanvasRadius", ",", "CanvasPivot", ",", 
        "RotationAngle", ",", "Offset"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Offset", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"+", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"+", "1"}], ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"+", "1"}], ",", 
            RowBox[{"+", "1"}]}], "}"}]}], "}"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51585942346875*^9, 
  3.5158595128125*^9}},ExpressionUUID->"0ac0f7c1-0cdf-4231-81b8-dcc64ff3562b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Circle anchors", "Subsection",
 CellChangeTimes->{{3.515619435859375*^9, 
  3.515619463203125*^9}},ExpressionUUID->"ff04d625-d0e9-48aa-b92c-\
7c388585882f"],

Cell["A \[OpenCurlyDoubleQuote]circle\[CloseCurlyDoubleQuote] here more \
generally means a tilted ellipse", "Text",
 CellChangeTimes->{{3.51561946596875*^9, 
  3.51561947509375*^9}},ExpressionUUID->"8ea4812b-e943-4812-8dc4-\
a9d550562c31"],

Cell["Named points: Center (default), Left/Right, Bottom/Top", "Text",
 CellChangeTimes->{{3.515683659515625*^9, 
  3.51568367915625*^9}},ExpressionUUID->"e7213795-cf38-40cd-9e82-\
8b6d7f4363bc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigCircleAnchor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"AngleRange", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"theta1_", "?", "NumericQ"}], ",", 
        RowBox[{"theta2_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"Name", ":", 
      RowBox[{"(", 
       RowBox[{
       "Center", "|", "Left", "|", "Right", "|", "Bottom", "|", "Top"}], 
       ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Arg", ":", "None"}]}], "\[IndentingNewLine]", "]"}], ":=", 
   RowBox[{"FigAnchor", "[", 
    RowBox[{
     RowBox[{"Canvas", "[", 
      RowBox[{"RectangleOffsetPoint", "[", 
       RowBox[{
       "CanvasCenter", ",", "CanvasRadius", ",", "CanvasPivot", ",", 
        "RotationAngle", ",", 
        RowBox[{"NamedPointOffset", "[", "Name", "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"-", 
      RowBox[{"NamedPointOffset", "[", "Name", "]"}]}], ",", 
     "RotationAngle"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51561947978125*^9, 3.51561955340625*^9}, 
   3.51561961984375*^9, 3.51568066303125*^9, {3.51568074428125*^9, 
   3.5156807529375*^9}, {3.5156833859375*^9, 3.515683449140625*^9}, {
   3.515683529125*^9, 3.51568352978125*^9}, {3.515683574328125*^9, 
   3.51568360171875*^9}, 3.515686652203125*^9, 3.515855486375*^9, {
   3.51585589378125*^9, 3.51585589428125*^9}, {3.515856060390625*^9, 
   3.5158560630625*^9}, 3.515856410328125*^9, {3.51585677471875*^9, 
   3.51585680621875*^9}, 3.5158570951875*^9, 3.518018907359375*^9, {
   3.519647305734375*^9, 3.519647306796875*^9}, {3.519651750765625*^9, 
   3.519651753296875*^9}, 3.5202765048125*^9, 3.566595702638628*^9, 
   3.566595865496114*^9},ExpressionUUID->"ee7267d9-321f-40de-8f76-\
7ffab812fea0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigCircleAnchor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"AngleRange", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"theta1_", "?", "NumericQ"}], ",", 
        RowBox[{"theta2_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"Name", ":", "Offset"}], ",", "\[IndentingNewLine]", 
     RowBox[{"OffsetValue", ":", "FigOffsetPattern"}]}], 
    "\[IndentingNewLine]", "]"}], ":=", 
   RowBox[{"FigAnchor", "[", 
    RowBox[{
     RowBox[{"Canvas", "[", 
      RowBox[{"RectangleOffsetPoint", "[", 
       RowBox[{
       "CanvasCenter", ",", "CanvasRadius", ",", "CanvasPivot", ",", 
        "RotationAngle", ",", 
        RowBox[{"FigResolveOffset", "[", "OffsetValue", "]"}]}], "]"}], "]"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", "RotationAngle"}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51956759509375*^9, 3.519567659296875*^9}, 
   3.519647307984375*^9, 3.566595703106629*^9, 
   3.566595865496114*^9},ExpressionUUID->"9a77910e-7329-44ea-8e75-\
baad40f2f69c"],

Cell[TextData[{
 "For a circle, the conventional direction is the \"positive theta\" \
direction from polar coordinates, i.e., CCW.  For instance, this is the \
convention followed by the ordering of the arc angle arguments \
{theta1,theta2} in the ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " Circle and Disk primatives.  However, it is more natural for the text \
baseline to follow the \"negative theta\" tangent, so that the text \"sits on\
\" the outside of the circle.  This is the convention adopted with the \
anchors for Point, for instance.  For the most part, TextRectify renders this \
problem irrelevant.  However, the orientation of the tangent also affect \
arrowheads.  "
}], "Text",
 CellChangeTimes->{{3.51568368459375*^9, 3.515683699953125*^9}, {
  3.51596956909375*^9, 3.5159695745625*^9}, {3.566596935201379*^9, 
  3.566597008631481*^9}},ExpressionUUID->"60225616-0117-4ed4-872e-\
adaf375989d8"],

Cell["\<\
Curve anchors:
\tNormal/Tangent, t|Scaled[t]\
\>", "Text",
 CellChangeTimes->{{3.51568370453125*^9, 3.51568372775*^9}, {
   3.515683799265625*^9, 3.51568382240625*^9}, {3.51596953903125*^9, 
   3.515969565*^9}, 3.5195646395625*^9, {3.51964578821875*^9, 
   3.519645812046875*^9}, {3.566597123661642*^9, 3.566597125991646*^9}, {
   3.5665971672317033`*^9, 
   3.5665971689217057`*^9}},ExpressionUUID->"ccdba59c-c9e7-410b-aa7e-\
24ddc9d211b7"],

Cell["\<\
Previously: FigCircle sorted the AngleRange angles to *enforce* a CCW curve.  \
The solution was to use the \"negative theta\" tangent, but still have the \
scaled curve parameter run from 0=Tail to 1=Head going CCW, and then flip the \
tangent used in drawing arrowheads (with \
RotateAnchor[Self@MakeAnchor[Tail,None],Pi],RotateAnchor[Self@MakeAnchor[Head,\
None],Pi]).\
\>", "Text",
 CellChangeTimes->{{3.51568368459375*^9, 3.515683699953125*^9}, {
  3.51596956909375*^9, 3.5159695745625*^9}, {3.566596935201379*^9, 
  3.5665969941814613`*^9}, {3.5665977351724987`*^9, 
  3.5665977436225104`*^9}},ExpressionUUID->"65feec02-a20c-4bbe-a6eb-\
4f7c2985e0a7"],

Cell["\<\
FigCircleAnchor[
   CanvasCenter : {_?NumericQ, _?NumericQ}, CanvasRadius : {_?NumericQ, \
_?NumericQ}, AngleRange : {theta1_?NumericQ, theta2_?NumericQ}, CanvasPivot : \
{_?NumericQ, _?NumericQ}, RotationAngle_?NumericQ,
   OrthoMode : (Normal | Tangent), Arg : ((t_?NumericQ) | \
Scaled[t_?NumericQ])
   ] := Module[
   {theta, AnchorPoint, TangentAngle, AnchorAngle, AnchorOffset},
   
   theta = Switch[
     Arg,
     _?NumericQ, t, (* literal angle, before rotation *)
     Scaled[_?NumericQ], RescaleInterval[{0, 1}, {theta1, theta2}][t]  (* \
scaled from 0 to 1 on displayed arc *)
     ];
   AnchorPoint = RotationTransform[RotationAngle, CanvasPivot]@(CanvasCenter \
+ CanvasRadius*{Cos[theta], Sin[theta]});
   AnchorOffset = Switch[OrthoMode, Normal, {-1, 0}, Tangent, {0, -1}];
   TangentAngle = VectorArcTan[CanvasRadius*{Sin[theta], -Cos[theta]}] + \
RotationAngle; (* tangent vector in negative theta sense *)
   AnchorAngle = TangentAngle + Switch[OrthoMode, Normal, +Pi/2, Tangent, 0];
   
   FigAnchor[Canvas[AnchorPoint], AnchorOffset, AnchorAngle]
   ];\
\>", "Program",
 CellChangeTimes->{{3.51562248925*^9, 3.515622550609375*^9}, {
   3.51562259421875*^9, 3.515622770515625*^9}, {3.515622819828125*^9, 
   3.51562290796875*^9}, {3.515623667421875*^9, 3.515623667875*^9}, {
   3.51562374040625*^9, 3.5156238078125*^9}, 3.515623878640625*^9, {
   3.515623915140625*^9, 3.515623923640625*^9}, 3.515624255578125*^9, 
   3.515624289046875*^9, 3.515624322640625*^9, {3.515680598203125*^9, 
   3.515680612328125*^9}, 3.515680671671875*^9, {3.5156808*^9, 
   3.515680806640625*^9}, {3.515683432125*^9, 3.51568353646875*^9}, {
   3.51568358396875*^9, 3.51568360671875*^9}, {3.515683790921875*^9, 
   3.515683817*^9}, {3.515855906578125*^9, 3.515855910234375*^9}, 
   3.5180189155*^9, 3.519564636328125*^9, 3.519565432015625*^9, {
   3.519645741390625*^9, 3.51964577971875*^9}, {3.519645824046875*^9, 
   3.519645841515625*^9}, 3.5665957046978316`*^9, 3.566595865511714*^9, 
   3.583516245635868*^9},ExpressionUUID->"54560d93-197f-4121-86ae-\
fc1317d00063"],

Cell["\<\
Revised: FigCircle leaves the angles unsorted, so curve sense can be either \
way.  The d(theta) for the tangent is in the same sense as the delta(theta) \
of the angles.  The scaled curve parameter runs from 0=Tail to 1=Head.\
\>", "Text",
 CellChangeTimes->{{3.51568368459375*^9, 3.515683699953125*^9}, {
   3.51596956909375*^9, 3.5159695745625*^9}, {3.566596935201379*^9, 
   3.5665969941814613`*^9}, {3.56659702876151*^9, 3.5665970707915688`*^9}, {
   3.5665974743421335`*^9, 3.566597481462143*^9}, {3.584015739599758*^9, 
   3.584015825337509*^9}, 
   3.5840158901400228`*^9},ExpressionUUID->"eaeadbab-0439-4ef9-b679-\
6df044da3e21"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FigCircleAnchor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"AngleRange", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"theta1_", "?", "NumericQ"}], ",", 
        RowBox[{"theta2_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"OrthoMode", ":", 
      RowBox[{"(", 
       RowBox[{"Normal", "|", "Tangent"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Arg", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"t_", "?", "NumericQ"}], ")"}], "|", 
        RowBox[{"{", 
         RowBox[{"\"\<Angle\>\"", ",", 
          RowBox[{"t_", "?", "NumericQ"}]}], "}"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "theta", ",", "AnchorPoint", ",", "TangentAngle", ",", "AnchorAngle", 
       ",", "AnchorOffset", ",", "ArcSense"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"arc", " ", 
       RowBox[{"sense", ":", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"+", "1"}], " ", "for", " ", "CCW", " ", "or"}], " ", "-", 
         RowBox[{"1", " ", "for", " ", "CW"}]}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ArcSense", "=", 
       RowBox[{"Sign", "[", 
        RowBox[{"theta2", "-", "theta1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"theta", "=", 
       RowBox[{"Switch", "[", "\[IndentingNewLine]", 
        RowBox[{"Arg", ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<Angle\>\"", ",", 
           RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", "t", ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"literal", " ", "angle"}], ",", " ", 
           RowBox[{"before", " ", "rotation"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{
          RowBox[{"RescaleInterval", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"theta1", ",", "theta2"}], "}"}]}], "]"}], "[", "t", 
          "]"}]}], "  ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "scaled", " ", "from", " ", "0", " ", "to", " ", "1", " ", "on", " ",
           "displayed", " ", "arc"}], " ", "*)"}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AnchorPoint", "=", 
       RowBox[{
        RowBox[{"RotationTransform", "[", 
         RowBox[{"RotationAngle", ",", "CanvasPivot"}], "]"}], "@", 
        RowBox[{"(", 
         RowBox[{"CanvasCenter", "+", 
          RowBox[{"CanvasRadius", "*", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Cos", "[", "theta", "]"}], ",", 
             RowBox[{"Sin", "[", "theta", "]"}]}], "}"}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AnchorOffset", "=", 
       RowBox[{
        RowBox[{"Switch", "[", 
         RowBox[{"OrthoMode", ",", "Normal", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", "Tangent", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "*", "ArcSense"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "trig", " ", "gives", " ", "tangent", " ", "vector", " ", "in", " ", 
         "negative", " ", "theta", " ", 
         RowBox[{"sense", " ", "--"}], " ", "for", " ", "arc", " ", 
         "tangent"}], ",", " ", 
        RowBox[{
         RowBox[{
         "this", " ", "must", " ", "be", " ", "flipped", " ", "if", " ", 
          "delta", " ", "theta", " ", "is", " ", "positive"}], ";", " ", 
         RowBox[{"for", " ", "outward", " ", "normal"}]}], ",", " ", 
        RowBox[{"this", " ", "must", " ", "have", " ", 
         RowBox[{"Pi", "/", "2"}], " ", "added"}]}], "  ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"TangentAngle", "=", 
       RowBox[{
        RowBox[{"VectorArcTan", "[", 
         RowBox[{"CanvasRadius", "*", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Sin", "[", "theta", "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"Cos", "[", "theta", "]"}]}]}], "}"}]}], "]"}], "+", 
        "RotationAngle"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "trig", " ", "gives", " ", "tangent", " ", "vector", " ", "in", " ", 
         "negative", " ", "theta", " ", "sense"}], ",", " ", 
        RowBox[{"which", " ", "y"}]}], "  ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"AnchorAngle", "=", 
       RowBox[{"TangentAngle", "+", 
        RowBox[{"Switch", "[", 
         RowBox[{"OrthoMode", ",", "Normal", ",", 
          RowBox[{
           RowBox[{"+", "Pi"}], "/", "2"}], ",", "Tangent", ",", 
          RowBox[{"Switch", "[", 
           RowBox[{"ArcSense", ",", 
            RowBox[{"+", "1"}], ",", "Pi", ",", 
            RowBox[{
             RowBox[{"-", "1"}], "|", "0"}], ",", "0"}], "]"}]}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"FigAnchor", "[", 
       RowBox[{
        RowBox[{"Canvas", "[", "AnchorPoint", "]"}], ",", "AnchorOffset", ",",
         "AnchorAngle"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigCircleAnchor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"AngleRange", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"theta1_", "?", "NumericQ"}], ",", 
        RowBox[{"theta2_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"OrthoMode", ":", 
      RowBox[{"(", 
       RowBox[{"Normal", "|", "Tangent"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Arg", ":", "None"}]}], "]"}], ":=", 
   RowBox[{"FigCircleAnchor", "[", 
    RowBox[{
    "CanvasCenter", ",", "CanvasRadius", ",", "AngleRange", ",", 
     "CanvasPivot", ",", "RotationAngle", ",", "\[IndentingNewLine]", 
     "OrthoMode", ",", "0.5"}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51562248925*^9, 3.515622550609375*^9}, {
   3.51562259421875*^9, 3.515622770515625*^9}, {3.515622819828125*^9, 
   3.51562290796875*^9}, {3.515623667421875*^9, 3.515623667875*^9}, {
   3.51562374040625*^9, 3.5156238078125*^9}, 3.515623878640625*^9, {
   3.515623915140625*^9, 3.515623923640625*^9}, 3.515624255578125*^9, 
   3.515624289046875*^9, 3.515624322640625*^9, {3.515680598203125*^9, 
   3.515680612328125*^9}, 3.515680671671875*^9, {3.5156808*^9, 
   3.515680806640625*^9}, {3.515683432125*^9, 3.51568353646875*^9}, {
   3.51568358396875*^9, 3.51568360671875*^9}, {3.515683790921875*^9, 
   3.515683817*^9}, {3.515855906578125*^9, 3.515855910234375*^9}, 
   3.5180189155*^9, 3.519564636328125*^9, 3.519565432015625*^9, {
   3.519645741390625*^9, 3.51964577971875*^9}, {3.519645824046875*^9, 
   3.519645841515625*^9}, 3.5665957046978316`*^9, 3.566595865511714*^9, {
   3.5665973726719913`*^9, 3.5665974943121614`*^9}, {3.56659753637222*^9, 
   3.5665975511922407`*^9}, 3.566597867942684*^9, {3.5665979308827724`*^9, 
   3.566597934757778*^9}, {3.56659813875869*^9, 3.5665981489767084`*^9}, {
   3.5665993598066673`*^9, 3.566599415370021*^9}, {3.5835189416845284`*^9, 
   3.5835189595465593`*^9}, {3.5835189946310205`*^9, 3.583519007329443*^9}, {
   3.5835191977785077`*^9, 3.5835192222705507`*^9}, {3.5840161439056683`*^9, 
   3.5840162685678873`*^9}, {3.5840163089095583`*^9, 
   3.5840163956301107`*^9}},ExpressionUUID->"a14a7c6c-e1d2-42bb-80f5-\
c7bc9f6b456e"],

Cell["Head/Tail anchors -- tangent at endpoint of arc", "Text",
 CellChangeTimes->{{3.5665971736917124`*^9, 
  3.566597184201727*^9}},ExpressionUUID->"32378bb0-b885-40fc-905f-\
d8313151ab17"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FigCircleAnchor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"AngleRange", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"theta1_", "?", "NumericQ"}], ",", 
        RowBox[{"theta2_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"Name", ":", "Tail"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Arg", ":", "None"}]}], "\[IndentingNewLine]", "]"}], ":=", 
   RowBox[{"FigCircleAnchor", "[", 
    RowBox[{
    "CanvasCenter", ",", "CanvasRadius", ",", "AngleRange", ",", 
     "CanvasPivot", ",", "RotationAngle", ",", "Tangent", ",", "0"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigCircleAnchor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"AngleRange", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"theta1_", "?", "NumericQ"}], ",", 
        RowBox[{"theta2_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"Name", ":", "Head"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Arg", ":", "None"}]}], "\[IndentingNewLine]", "]"}], ":=", 
   RowBox[{"FigCircleAnchor", "[", 
    RowBox[{
    "CanvasCenter", ",", "CanvasRadius", ",", "AngleRange", ",", 
     "CanvasPivot", ",", "RotationAngle", ",", "Tangent", ",", "1"}], "]"}]}],
   ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515683625984375*^9, 3.515683646890625*^9}, {
  3.515683810796875*^9, 3.515683811484375*^9}, {3.515855497171875*^9, 
  3.515855498296875*^9}, {3.515855899234375*^9, 3.51585590309375*^9}, {
  3.519647308984375*^9, 3.51964730965625*^9}, {3.519651832625*^9, 
  3.519651837796875*^9}, {3.520277971359375*^9, 3.520277976140625*^9}, {
  3.5665957034654293`*^9, 3.5665957044170313`*^9}, {3.566595865511714*^9, 
  3.566595865511714*^9}, {3.5665970146014895`*^9, 3.5665970159614916`*^9}, {
  3.5835269632193575`*^9, 
  3.583526965619361*^9}},ExpressionUUID->"98c3299a-fa50-4ba7-acc3-\
d32c9e19e5f5"],

Cell["\<\
Bounding radii
\tdefault text offset chosen to put labels outside if arc is in CCW \
(positive) sense\
\>", "Text",
 CellChangeTimes->{{3.5767712565270863`*^9, 3.576771257542088*^9}, {
   3.576771409782301*^9, 3.5767714113873034`*^9}, 3.576771869080945*^9, {
   3.5767731940498266`*^9, 
   3.576773217232682*^9}},ExpressionUUID->"0a4ebbd7-3cc0-43a9-b757-\
dd202b030946"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FigCircleAnchor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"AngleRange", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"theta1_", "?", "NumericQ"}], ",", 
        RowBox[{"theta2_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"Name", ":", 
      RowBox[{"(", 
       RowBox[{"HeadRadius", "|", "TailRadius"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Arg", ":", 
      RowBox[{"(", 
       RowBox[{"p_", "?", "NumericQ"}], ")"}]}]}], "\[IndentingNewLine]", 
    "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"CenterPoint", ",", "EndPoint"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CenterPoint", "=", 
       RowBox[{"FigResolvePoint", "[", 
        RowBox[{"FigCircleAnchor", "[", 
         RowBox[{
         "CanvasCenter", ",", "CanvasRadius", ",", "AngleRange", ",", 
          "CanvasPivot", ",", "RotationAngle", ",", "Center", ",", "None"}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"EndPoint", "=", 
       RowBox[{"FigResolvePoint", "[", 
        RowBox[{"FigCircleAnchor", "[", 
         RowBox[{
         "CanvasCenter", ",", "CanvasRadius", ",", "AngleRange", ",", 
          "CanvasPivot", ",", "RotationAngle", ",", 
          RowBox[{"Switch", "[", 
           RowBox[{
           "Name", ",", "HeadRadius", ",", "Head", ",", "TailRadius", ",", 
            "Tail"}], "]"}], ",", "None"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"FigCurveAnchorFromPoints", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"CenterPoint", ",", "EndPoint"}], "}"}], ",", 
        RowBox[{"Switch", "[", 
         RowBox[{
         "Name", ",", "HeadRadius", ",", "Left", ",", "TailRadius", ",", 
          "Right"}], "]"}], ",", "p"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigCircleAnchor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"AngleRange", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"theta1_", "?", "NumericQ"}], ",", 
        RowBox[{"theta2_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"Name", ":", 
      RowBox[{"(", 
       RowBox[{"HeadRadius", "|", "TailRadius"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Arg", ":", "None"}]}], "]"}], ":=", 
   RowBox[{"FigCircleAnchor", "[", 
    RowBox[{
    "CanvasCenter", ",", "CanvasRadius", ",", "AngleRange", ",", 
     "CanvasPivot", ",", "RotationAngle", ",", "\[IndentingNewLine]", "Name", 
     ",", "0.5"}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51561947978125*^9, 3.51561955340625*^9}, 
   3.51561961984375*^9, 3.51568066303125*^9, {3.51568074428125*^9, 
   3.5156807529375*^9}, {3.5156833859375*^9, 3.515683449140625*^9}, {
   3.515683529125*^9, 3.51568352978125*^9}, {3.515683574328125*^9, 
   3.51568360171875*^9}, 3.515686652203125*^9, 3.515855486375*^9, {
   3.51585589378125*^9, 3.51585589428125*^9}, {3.515856060390625*^9, 
   3.5158560630625*^9}, 3.515856410328125*^9, {3.51585677471875*^9, 
   3.51585680621875*^9}, 3.5158570951875*^9, 3.518018907359375*^9, {
   3.519647305734375*^9, 3.519647306796875*^9}, {3.519651750765625*^9, 
   3.519651753296875*^9}, 3.5202765048125*^9, 3.566595702638628*^9, 
   3.566595865496114*^9, {3.5767713637272367`*^9, 3.576771460347372*^9}, {
   3.5767715066124363`*^9, 3.5767715190674543`*^9}, {3.576771807910859*^9, 
   3.576771942791048*^9}, {3.5767730199921527`*^9, 3.5767730241197166`*^9}, {
   3.5767731004908895`*^9, 3.5767731037684393`*^9}, {3.5767731912397833`*^9, 
   3.576773191564788*^9}, {3.5767732407155433`*^9, 3.5767732522657204`*^9}, {
   3.576773359907374*^9, 3.57677337270757*^9}, {3.576773476491665*^9, 
   3.576773513160978*^9}},ExpressionUUID->"34555e4b-065c-490f-a7d4-\
8cd39b919620"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Circle bounding box", "Subsection",
 CellChangeTimes->{{3.515619435859375*^9, 3.515619463203125*^9}, {
  3.515854266515625*^9, 3.5158542678125*^9}, {3.5158594105625*^9, 
  3.515859412515625*^9}, {3.515860078078125*^9, 
  3.515860079015625*^9}},ExpressionUUID->"ed2362f4-53ec-4930-9caa-\
d2f37127b3f4"],

Cell["\<\
currently just calculated as bounding box of principal axis end points
\t-- works for nonrotated ellipse
\t-- will underestimage bounding box for tilted ellipse
\t-- neglects possible restriction to arc\
\>", "Text",
 CellChangeTimes->{{3.51586008065625*^9, 
  3.5158601953125*^9}},ExpressionUUID->"5887400e-2c53-4a59-8642-8db7b07454a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigCircleBoundingBox", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CanvasCenter", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasRadius", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"AngleRange", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"theta1_", "?", "NumericQ"}], ",", 
        RowBox[{"theta2_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"CanvasPivot", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", 
     RowBox[{"RotationAngle_", "?", "NumericQ"}]}], "\[IndentingNewLine]", 
    "]"}], ":=", 
   RowBox[{"FigPointSetBoundingBox", "[", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RectangleOffsetPoint", "[", 
       RowBox[{
       "CanvasCenter", ",", "CanvasRadius", ",", "CanvasPivot", ",", 
        "RotationAngle", ",", "Offset"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Offset", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"+", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"+", "1"}], ",", "0"}], "}"}]}], "}"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51585942346875*^9, 3.5158595128125*^9}, 
   3.5158601023125*^9, {3.515860177234375*^9, 3.51586020246875*^9}, 
   3.566595704978632*^9, 
   3.5665958655273137`*^9},ExpressionUUID->"dff8cbd9-90ab-4d7f-945f-\
9d976e99f2ab"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Anchor manipulation and retrieval", "Section",
 CellChangeTimes->{{3.516036002505125*^9, 3.516036006911375*^9}, {
   3.516039281380125*^9, 3.51603928558325*^9}, 3.519492527984375*^9, {
   3.566665386039364*^9, 3.566665401733261*^9}, {3.625170085020852*^9, 
   3.625170088624459*^9}},ExpressionUUID->"d466a666-2b33-435c-8227-\
faa392015e91"],

Cell[CellGroupData[{

Cell["Anchor translation (displacement)", "Subsection",
 CellChangeTimes->{{3.51595657415625*^9, 3.51595657834375*^9}, {
  3.51603597177075*^9, 
  3.516035974786375*^9}},ExpressionUUID->"f02b4fc3-109a-4d01-b1ab-\
3151ffa380b0"],

Cell["\<\
\tNote: These functions return an anchor *object*, not an anchor name.
\tThese definitions must come after all relevant argument patterns have been \
defined above.\
\>", "Text",
 CellChangeTimes->{{3.515614705796875*^9, 3.51561471359375*^9}, {
   3.51595655615625*^9, 3.51595657075*^9}, {3.51603599058325*^9, 
   3.516035997661375*^9}, {3.516285088953125*^9, 3.516285121140625*^9}, {
   3.516285172265625*^9, 3.5162852559375*^9}, {3.516285722578125*^9, 
   3.5162857229375*^9}, 3.518105071890625*^9, {3.518200813046875*^9, 
   3.5182008155*^9}, {3.625169911673348*^9, 3.62516991273415*^9}, {
   3.6251700170359335`*^9, 
   3.625170039999173*^9}},ExpressionUUID->"739f1d7c-60d4-4ece-b261-\
b75e9982b19a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DisplacePoint", "[", 
    RowBox[{
     RowBox[{"p", ":", "FigPointPattern"}], ",", 
     RowBox[{"Args", ":", 
      RowBox[{"FigDisplacementSequencePattern", "[", "0", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "CanvasPoint"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FigCheckInFigure", "[", "DisplacePoint", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"FigAnchor", "[", "p", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"CanvasPoint", "=", 
       RowBox[{
        RowBox[{"a", "@", 
         RowBox[{"GetPoint", "[", "]"}]}], "+", 
        RowBox[{"Plus", "@@", 
         RowBox[{"(", 
          RowBox[{"FigResolveDisplacement", "/@", 
           RowBox[{"{", "Args", "}"}]}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"FigAnchor", "[", 
       RowBox[{
        RowBox[{"Canvas", "[", "CanvasPoint", "]"}], ",", 
        RowBox[{"a", "@", 
         RowBox[{"GetOffset", "[", "]"}]}], ",", 
        RowBox[{"a", "@", 
         RowBox[{"GetAngle", "[", "]"}]}]}], "]"}]}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DeclareFigFallThroughError", "[", "DisplacePoint", "]"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515614060921875*^9, 3.515614136234375*^9}, {
   3.51561417790625*^9, 3.515614185953125*^9}, {3.515614559984375*^9, 
   3.51561470015625*^9}, {3.515615311875*^9, 3.515615339796875*^9}, {
   3.515616562359375*^9, 3.51561656303125*^9}, 3.515618218171875*^9, {
   3.515861009296875*^9, 3.515861025171875*^9}, {3.515861290765625*^9, 
   3.515861293328125*^9}, 3.51586143853125*^9, 3.516283558390625*^9, {
   3.516284480625*^9, 3.516284488890625*^9}, 3.516284603328125*^9, {
   3.51628507803125*^9, 3.516285083796875*^9}, {3.5162857265625*^9, 
   3.516285736234375*^9}, {3.5162880086875*^9, 3.516288009328125*^9}, 
   3.51801887934375*^9, 3.51810507484375*^9, {3.625164428242117*^9, 
   3.6251644282577167`*^9}, {3.6251673547790565`*^9, 
   3.6251673708158855`*^9}, {3.6251687134498434`*^9, 
   3.625168718488652*^9}},ExpressionUUID->"bd7d4551-3750-4963-8214-\
fafd3c9b03ca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ProjectPoint", "[", 
    RowBox[{
     RowBox[{"p", ":", "FigPointPattern"}], ",", 
     RowBox[{"CoordinateIndexName", ":", 
      RowBox[{"(", 
       RowBox[{"Horizontal", "|", "Vertical"}], ")"}]}], ",", 
     RowBox[{"x", ":", "FigCoordinatePattern"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"CoordinateIndex", ",", "xc", ",", "a", ",", "CanvasPoint"}], 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FigCheckInFigure", "[", "ProjectPoint", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"resolve", " ", "coordinate"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"CoordinateIndex", "=", 
       RowBox[{
       "FigResolveCoordinateIndex", "[", "CoordinateIndexName", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xc", "=", 
       RowBox[{"FigResolveCoordinate", "[", 
        RowBox[{"x", ",", "CoordinateIndex"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"substitute", " ", "coordinate"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"FigAnchor", "[", "p", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"CanvasPoint", "=", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"a", "@", 
           RowBox[{"GetPoint", "[", "]"}]}], ")"}], ",", 
         RowBox[{"CoordinateIndex", "\[Rule]", "xc"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"FigAnchor", "[", 
       RowBox[{
        RowBox[{"Canvas", "[", "CanvasPoint", "]"}], ",", 
        RowBox[{"a", "@", 
         RowBox[{"GetOffset", "[", "]"}]}], ",", 
        RowBox[{"a", "@", 
         RowBox[{"GetAngle", "[", "]"}]}]}], "]"}]}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DeclareFigFallThroughError", "[", "ProjectPoint", "]"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515614060921875*^9, 3.515614136234375*^9}, {
   3.51561417790625*^9, 3.515614185953125*^9}, {3.515614559984375*^9, 
   3.51561470015625*^9}, {3.515615311875*^9, 3.515615339796875*^9}, {
   3.515616562359375*^9, 3.51561656303125*^9}, 3.515618218171875*^9, {
   3.515861009296875*^9, 3.515861025171875*^9}, {3.515861290765625*^9, 
   3.515861293328125*^9}, 3.51586143853125*^9, 3.516283558390625*^9, {
   3.516284480625*^9, 3.516284488890625*^9}, 3.516284603328125*^9, {
   3.51628507803125*^9, 3.516285083796875*^9}, {3.5162857265625*^9, 
   3.516285736234375*^9}, {3.5162880086875*^9, 3.516288009328125*^9}, 
   3.51801887934375*^9, 3.51810507484375*^9, {3.625164428242117*^9, 
   3.6251644282577167`*^9}, {3.625166974029188*^9, 3.6251670039968405`*^9}, 
   3.625167098985408*^9, {3.625167163787922*^9, 3.625167340895033*^9}, {
   3.625167407397949*^9, 3.625167412514758*^9}, {3.6251687219674587`*^9, 
   3.625168727630268*^9}, 3.6251687709359446`*^9, {3.62534276399308*^9, 
   3.6253427669414854`*^9}},ExpressionUUID->"ee48cef3-51aa-4d87-80f9-\
8af18900a503"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DisplaceAlongAnchor", "[", 
     RowBox[{
      RowBox[{"p", ":", "FigPointPattern"}], ",", 
      RowBox[{"d_", "?", "NumericQ"}]}], "]"}], "/;", 
    RowBox[{"(", "SciDraw`Private`$InFigure", ")"}]}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "theta", ",", "CanvasPoint"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FigCheckInFigure", "[", "DisplacePoint", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"FigAnchor", "[", "p", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"theta", "=", 
       RowBox[{"a", "@", 
        RowBox[{"GetAngle", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"CanvasPoint", "=", 
       RowBox[{
        RowBox[{"a", "@", 
         RowBox[{"GetPoint", "[", "]"}]}], "+", 
        RowBox[{"d", "*", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Cos", "[", "theta", "]"}], ",", 
           RowBox[{"Sin", "[", "theta", "]"}]}], "}"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"FigAnchor", "[", 
       RowBox[{
        RowBox[{"Canvas", "[", "CanvasPoint", "]"}], ",", 
        RowBox[{"a", "@", 
         RowBox[{"GetOffset", "[", "]"}]}], ",", 
        RowBox[{"a", "@", 
         RowBox[{"GetAngle", "[", "]"}]}]}], "]"}]}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DeclareFigFallThroughError", "[", "DisplaceAlongAnchor", "]"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515614060921875*^9, 3.515614136234375*^9}, {
   3.51561417790625*^9, 3.515614185953125*^9}, {3.515614559984375*^9, 
   3.51561470015625*^9}, {3.515615311875*^9, 3.515615339796875*^9}, {
   3.515616562359375*^9, 3.51561656303125*^9}, 3.515618218171875*^9, {
   3.515861009296875*^9, 3.515861025171875*^9}, {3.515861290765625*^9, 
   3.515861293328125*^9}, 3.51586143853125*^9, {3.516036046130125*^9, 
   3.516036154380125*^9}, 3.51628355946875*^9, 3.51628512365625*^9, {
   3.516285739765625*^9, 3.516285740015625*^9}, {3.51628801021875*^9, 
   3.516288010859375*^9}, 3.518018887046875*^9, 3.518105077640625*^9, {
   3.51820080809375*^9, 3.51820080990625*^9}, 3.6251644282577167`*^9, 
   3.625166611780952*^9, {3.625167381252303*^9, 3.625167392609123*^9}, {
   3.625168730126273*^9, 
   3.6251687344942803`*^9}},ExpressionUUID->"de16d9f3-5b42-4be7-864a-\
50c23a6a8393"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Anchor rotation", "Subsection",
 CellChangeTimes->{{3.515956585390625*^9, 3.515956604296875*^9}, {
  3.51603601983325*^9, 
  3.51603602120825*^9}},ExpressionUUID->"c31edbd4-af3b-413e-a007-\
a96e5b7082b9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RotateAnchor", "[", 
     RowBox[{
      RowBox[{"p", ":", "FigPointPattern"}], ",", 
      RowBox[{"theta", ":", "ScalarParameterPattern"}]}], "]"}], "/;", 
    RowBox[{"(", "SciDraw`Private`$InFigure", ")"}]}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Anchor", ",", "CanvasPoint"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FigCheckInFigure", "[", "RotateAnchor", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Anchor", "=", 
       RowBox[{"FigAnchor", "[", "p", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"FigAnchor", "[", 
       RowBox[{
        RowBox[{"Canvas", "[", 
         RowBox[{"Anchor", "@", 
          RowBox[{"GetPoint", "[", "]"}]}], "]"}], ",", 
        RowBox[{"Anchor", "@", 
         RowBox[{"GetOffset", "[", "]"}]}], ",", 
        RowBox[{
         RowBox[{"Anchor", "@", 
          RowBox[{"GetAngle", "[", "]"}]}], "+", 
         RowBox[{"UpgradeScalar", "[", "theta", "]"}]}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515614060921875*^9, 3.515614136234375*^9}, {
   3.51561417790625*^9, 3.515614185953125*^9}, {3.515614559984375*^9, 
   3.51561470015625*^9}, {3.515615311875*^9, 3.515615339796875*^9}, {
   3.515616562359375*^9, 3.51561656303125*^9}, 3.515618218171875*^9, {
   3.515685960203125*^9, 3.515686035375*^9}, {3.515861301453125*^9, 
   3.5158613055625*^9}, 3.516285140375*^9, {3.51628576609375*^9, 
   3.516285771078125*^9}, 3.518018893609375*^9, 
   3.5181050800625*^9},ExpressionUUID->"d610392b-7b3e-41f8-b5c4-da817998c851"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Anchor angle retrieval", "Subsection",
 CellChangeTimes->{{3.516039288677*^9, 
  3.516039293942625*^9}},ExpressionUUID->"08f62cca-88fb-45ed-a32b-\
6d45f96154ab"],

Cell["User-level anchor retrieval functions", "Text",
 CellChangeTimes->{{3.5666646506490803`*^9, 
  3.5666646614492464`*^9}},ExpressionUUID->"79e7afa9-1f3b-4c43-9c3d-\
e1241647559c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AnchorAngle", "[", 
    RowBox[{"p", ":", "FigPointPattern"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "Anchor", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FigCheckInFigure", "[", "AnchorAngle", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Anchor", "=", 
       RowBox[{"FigAnchor", "[", "p", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Anchor", "@", 
       RowBox[{"GetAngle", "[", "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.51603926645825*^9, {3.51603929883325*^9, 3.5160393302395*^9}, 
   3.516285143046875*^9, {3.516285773984375*^9, 3.516285778828125*^9}, 
   3.518105080953125*^9, 
   3.566664649116557*^9},ExpressionUUID->"4f665076-548f-4547-85fd-\
5c52849db553"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Anchor offset retrieval", "Subsection",
 CellChangeTimes->{{3.516039288677*^9, 3.516039293942625*^9}, {
  3.5796312984017916`*^9, 
  3.5796312992317924`*^9}},ExpressionUUID->"5b4cd628-964d-4054-8833-\
ee34e8939d41"],

Cell["User-level anchor retrieval functions", "Text",
 CellChangeTimes->{{3.5666646506490803`*^9, 
  3.5666646614492464`*^9}},ExpressionUUID->"2b1f8591-b947-4acc-90f9-\
f5013332d9db"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AnchorOffset", "[", 
    RowBox[{"p", ":", "FigPointPattern"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "Anchor", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FigCheckInFigure", "[", "AnchorAngle", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Anchor", "=", 
       RowBox[{"FigAnchor", "[", "p", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Anchor", "@", 
       RowBox[{"GetOffset", "[", "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.51603926645825*^9, {3.51603929883325*^9, 3.5160393302395*^9}, 
   3.516285143046875*^9, {3.516285773984375*^9, 3.516285778828125*^9}, 
   3.518105080953125*^9, 3.566664649116557*^9, {3.579631303651799*^9, 
   3.5796313111218095`*^9}},ExpressionUUID->"e43ef911-bb6e-456d-97d0-\
bdab9c88b442"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Anchor point retrieval -- in user coordinates", "Subsection",
 CellChangeTimes->{{3.516039288677*^9, 3.516039293942625*^9}, {
  3.5666102060712814`*^9, 3.566610206695283*^9}, {3.5666646658668146`*^9, 
  3.5666646686168566`*^9}},ExpressionUUID->"89b4d533-ce90-4c67-8535-\
627f14bc965d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AnchorCoordinates", "[", 
    RowBox[{"p", ":", "FigPointPattern"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Anchor", ",", "CanvasCoordinates"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FigCheckInFigure", "[", "AnchorCoordinates", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Anchor", "=", 
       RowBox[{"FigAnchor", "[", "p", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"CanvasCoordinates", "=", 
       RowBox[{"Anchor", "@", 
        RowBox[{"GetPoint", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"CurrentWindow", "[", "]"}], "@", 
         RowBox[{"InverseTFunction", "[", "]"}]}], ")"}], "@", 
       "CanvasCoordinates"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.566664353770233*^9, 3.5666644346382627`*^9}, {
  3.566664523324625*^9, 3.5666645890531344`*^9}, {3.5666646332613134`*^9, 
  3.5666646423814535`*^9}, {3.5666818751319184`*^9, 3.5666818859895377`*^9}, {
  3.566935770248131*^9, 
  3.5669357994481716`*^9}},ExpressionUUID->"d3b1dd60-cb51-427c-9db3-\
51bdd11f32c6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Canvas angle for ray between anchors", "Subsection",
 CellChangeTimes->{{3.5666656315404053`*^9, 3.5666656346595836`*^9}, {
  3.5666656767709923`*^9, 
  3.566665680659215*^9}},ExpressionUUID->"9cdddc09-fbaa-4801-920d-\
7ed98e987d56"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CanvasRayAngle", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p1", ":", "FigPointPattern"}], ",", 
      RowBox[{"p2", ":", "FigPointPattern"}]}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"CanvasCoordinates1", ",", "CanvasCoordinates2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FigCheckInFigure", "[", "CanvasAngle", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"VectorArcTan", "[", 
       RowBox[{
        RowBox[{"FigResolvePoint", "[", "p2", "]"}], "-", 
        RowBox[{"FigResolvePoint", "[", "p1", "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.566664353770233*^9, 3.5666644346382627`*^9}, {
  3.566664523324625*^9, 3.5666645890531344`*^9}, {3.5666646332613134`*^9, 
  3.5666646423814535`*^9}, {3.5666656481193533`*^9, 3.5666657733325157`*^9}, {
  3.5666658778294926`*^9, 
  3.566665878212514*^9}},ExpressionUUID->"37b25dac-5297-45e0-a193-\
f3c112a365b3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Curve geometry", "Section",
 CellChangeTimes->{{3.51516648646875*^9, 3.5151664916875*^9}, {
  3.515617659953125*^9, 
  3.515617686125*^9}},ExpressionUUID->"30e49f7f-f24c-4919-bc29-ed73055cf6ba"],

Cell[CellGroupData[{

Cell["Curve pattern", "Subsection",
 CellChangeTimes->{{3.515883408046875*^9, 3.515883414421875*^9}, {
  3.51595348815625*^9, 
  3.5159534889375*^9}},ExpressionUUID->"5779fd2a-0a39-4f18-be66-ab2871aaea59"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FigCurvePointPattern", "=", 
   RowBox[{"FigPointPattern", "|", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"DisplaceTail", "|", "DisplaceHead"}], ")"}], "[", 
     RowBox[{"FigDisplacementSequencePattern", "[", "0", "]"}], "]"}], "|", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"DisplaceAlongTail", "|", "DisplaceAlongHead"}], ")"}], "[", 
     RowBox[{"(", 
      RowBox[{"_", "?", "NumericQ"}], ")"}], "]"}], "|", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"ProjectTail", "|", "ProjectHead"}], ")"}], "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Horizontal", "|", "Vertical"}], ")"}], ",", 
      "FigCoordinatePattern"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FigCurvePointSetPattern", "=", 
   RowBox[{"{", 
    RowBox[{"Repeated", "[", 
     RowBox[{"FigCurvePointPattern", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "Infinity"}], "}"}]}], "]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FigCurvePattern", "=", 
   RowBox[{"FigCurvePointSetPattern", "|", 
    RowBox[{"(", "_Graphics", ")"}], "|", 
    RowBox[{"(", "_ContourGraphics", ")"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.516283186265625*^9, 3.51628318815625*^9}, {
  3.5162832189375*^9, 3.51628329253125*^9}, {3.5162835826875*^9, 
  3.5162836025*^9}, {3.5162837275625*^9, 3.51628374403125*^9}, {
  3.516283788109375*^9, 3.51628381334375*^9}, {3.516284513390625*^9, 
  3.5162845241875*^9}, {3.6253416716323614`*^9, 3.6253417003364115`*^9}, {
  3.6254525300423994`*^9, 3.625452557186447*^9}, {3.6254530234556665`*^9, 
  3.625453035951288*^9}},ExpressionUUID->"12d840d3-a4ad-430d-886c-\
150eb7568e58"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Standard curve options", "Subsection",
 CellChangeTimes->{{3.51568126209375*^9, 3.515681269890625*^9}, {
  3.516046314177*^9, 
  3.5160463161145*^9}},ExpressionUUID->"88e9b229-678d-4f94-9ede-2150106ff66c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FigCurveOptions", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"curve", " ", "geometry"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"TailRecess", "\[Rule]", "None"}], ",", 
     RowBox[{"HeadRecess", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"curve", " ", "extraction"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      StyleBox["Line",
       InitializationCell->True], 
      StyleBox["\[Rule]",
       InitializationCell->True], "1"}]}], 
    StyleBox["\[IndentingNewLine]",
     InitializationCell->True], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515430903687875*^9, 3.515430989031625*^9}, {
   3.515431026844125*^9, 3.515431030625375*^9}, {3.515431105094125*^9, 
   3.5154311113285*^9}, 3.515609867390625*^9, {3.515610068609375*^9, 
   3.51561007096875*^9}, {3.515787829515625*^9, 3.515787850234375*^9}, {
   3.5160413966145*^9, 
   3.516041420942625*^9}},ExpressionUUID->"2a5f3dac-ebc2-405c-88c2-\
801c889869f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigCheckCurveOptions", "[", "Self_Object", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FigCheckOption", "[", 
       RowBox[{
       "Self", ",", "TailRecess", ",", "ScalarParameterPattern", ",", 
        "FigOptions"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{
       "Self", ",", "HeadRecess", ",", "ScalarParameterPattern", ",", 
        "FigOptions"}], "]"}], ";", "\[IndentingNewLine]", 
      StyleBox[
       RowBox[{"FigCheckOption", "[", 
        RowBox[{"Self", ",", "Line", ",", 
         RowBox[{"Join", "|", "All", "|", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", "_Integer", ")"}], "?", "Positive"}], ")"}]}], ",", 
         "FigOptions"}], "]"}],
       InitializationCell->True], 
      StyleBox[";",
       InitializationCell->True]}]}], 
    StyleBox["\[IndentingNewLine]",
     InitializationCell->True], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5156100370625*^9, 3.515610074328125*^9}, {
   3.515610247703125*^9, 3.515610248765625*^9}, 3.515611180921875*^9, 
   3.5157083741875*^9, {3.515708423828125*^9, 3.515708423953125*^9}, {
   3.51578785253125*^9, 3.51578789315625*^9}, {3.51604140527075*^9, 
   3.51604141270825*^9}},ExpressionUUID->"7d1f0df3-888b-4506-9628-\
1b653132a3dc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Curve resolution -- point set", "Subsection",
 CellChangeTimes->{{3.5155389481875*^9, 3.5155389531875*^9}, {
  3.515616414640625*^9, 3.515616416671875*^9}, {3.515883295578125*^9, 
  3.5158832963125*^9}, {3.516039564177*^9, 
  3.51603956602075*^9}},ExpressionUUID->"5798fbba-6ebe-4ffe-b6b3-\
d49dbb98e995"],

Cell["\<\
Resolves list of two or more points into canvas coordinates, making use of \
the special curve options for head and tail positioning.\
\>", "Text",
 CellChangeTimes->{{3.515541825421875*^9, 3.515541838140625*^9}, {
  3.5156001483125*^9, 3.515600176546875*^9}, {3.515600221875*^9, 
  3.515600281890625*^9}, {3.51560485615625*^9, 3.515604856515625*^9}, {
  3.515861223421875*^9, 3.51586124259375*^9}, {3.515883302390625*^9, 
  3.515883324203125*^9}},ExpressionUUID->"e8d0e191-1124-4f68-af2f-\
a2164b213013"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"General", "::", "figcurveref"}], "=", 
   "\"\<Circular reference in curve specification, with tail point `1` and \
head point `2`.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5162839851875*^9, 3.51628400759375*^9}, 
   3.51628776475*^9},ExpressionUUID->"853c17a6-ccb8-49ff-b26a-5942fb70e71c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveCurve", "[", 
    RowBox[{"Self_Object", ",", 
     RowBox[{"Points", ":", "FigCurvePointSetPattern"}], ",", 
     "FullOptions_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "p1", ",", "p2", ",", "DereferencedPoints", ",", "CanvasPoints", ",", 
       "CanvasHead", ",", "CanvasTail"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "resolve", " ", "tail", " ", "and", " ", "head", " ", "displacement", 
       " ", "references"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"p1", "=", 
       RowBox[{"First", "[", "Points", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p2", "=", 
       RowBox[{"Last", "[", "Points", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"sanity", " ", 
          RowBox[{"checks", " ", "--"}], " ", "head", " ", "cannot", " ", 
          "be", " ", "relative", " ", "to", " ", "head"}], ",", " ", 
         RowBox[{
         "tail", " ", "cannot", " ", "be", " ", "relative", " ", "to", " ", 
          "tail"}], ",", " ", 
         RowBox[{"and", " ", "head", " ", 
          RowBox[{"can", "'"}], "t", " ", "be", " ", "chasing", " ", "tail", 
          " ", "circularly"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"p1", ",", 
           RowBox[{
            RowBox[{"(", "_DisplaceTail", ")"}], "|", 
            RowBox[{"(", "_DisplaceAlongTail", ")"}], "|", 
            RowBox[{"(", "_ProjectTail", ")"}]}]}], "]"}], "||", 
         RowBox[{"MatchQ", "[", 
          RowBox[{"p2", ",", 
           RowBox[{
            RowBox[{"(", "_DisplaceHead", ")"}], "|", 
            RowBox[{"(", "_DisplaceAlongHead", ")"}], "|", 
            RowBox[{"(", "_ProjectHead", ")"}]}]}], "]"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{"p1", ",", 
             RowBox[{
              RowBox[{"(", "_DisplaceHead", ")"}], "|", 
              RowBox[{"(", "_DisplaceAlongHead", ")"}], "|", 
              RowBox[{"(", "_ProjectHead", ")"}]}]}], "]"}], "&&", 
           RowBox[{"MatchQ", "[", 
            RowBox[{"p2", ",", 
             RowBox[{
              RowBox[{"(", "_DisplaceTail", ")"}], "|", 
              RowBox[{"(", "_DisplaceAlongTail", ")"}], "|", 
              RowBox[{"(", "_ProjectTail", ")"}]}]}], "]"}]}], ")"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"FigError", "[", 
         RowBox[{"Self", ",", "\"\<figcurveref\>\"", ",", "p1", ",", "p2"}], 
         "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"DereferencedPoints", "=", 
       RowBox[{"Replace", "[", 
        RowBox[{"Points", ",", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"DisplaceTail", "[", "ArgSeq___", "]"}], "\[RuleDelayed]", 
            RowBox[{"DisplacePoint", "[", 
             RowBox[{"p1", ",", "ArgSeq"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ProjectTail", "[", "ArgSeq___", "]"}], "\[RuleDelayed]", 
            
            RowBox[{"ProjectPoint", "[", 
             RowBox[{"p1", ",", "ArgSeq"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"DisplaceAlongTail", "[", "ArgSeq___", "]"}], 
            "\[RuleDelayed]", 
            RowBox[{"DisplaceAlongAnchor", "[", 
             RowBox[{"p1", ",", "ArgSeq"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"DisplaceHead", "[", "ArgSeq___", "]"}], "\[RuleDelayed]", 
            RowBox[{"DisplacePoint", "[", 
             RowBox[{"p2", ",", "ArgSeq"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ProjectHead", "[", "ArgSeq___", "]"}], "\[RuleDelayed]", 
            
            RowBox[{"ProjectPoint", "[", 
             RowBox[{"p2", ",", "ArgSeq"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"DisplaceAlongHead", "[", "ArgSeq___", "]"}], 
            "\[RuleDelayed]", 
            RowBox[{"DisplaceAlongAnchor", "[", 
             RowBox[{"p2", ",", "ArgSeq"}], "]"}]}]}], "\[IndentingNewLine]", 
          "}"}], ",", 
         RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"resolve", " ", "points"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"CanvasPoints", "=", 
       RowBox[{"FigResolvePoint", "/@", "DereferencedPoints"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"do", " ", "tail", " ", "and", " ", "head", " ", "recess"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"CanvasTail", "=", 
       RowBox[{"InterpolateSegment", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Take", "[", 
          RowBox[{"CanvasPoints", ",", "2"}], "]"}], ",", 
         "\[IndentingNewLine]", "Tail", ",", "Absolute", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"UpgradeScalar", "[", 
          RowBox[{"(", 
           RowBox[{"TailRecess", "/.", "FullOptions"}], ")"}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"CanvasHead", "=", 
       RowBox[{"InterpolateSegment", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Take", "[", 
          RowBox[{"CanvasPoints", ",", 
           RowBox[{"-", "2"}]}], "]"}], ",", "\[IndentingNewLine]", "Head", 
         ",", "Absolute", ",", "\[IndentingNewLine]", 
         RowBox[{"-", 
          RowBox[{"UpgradeScalar", "[", 
           RowBox[{"(", 
            RowBox[{"HeadRecess", "/.", "FullOptions"}], ")"}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"CanvasPoints", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "CanvasTail"}], ",", 
          RowBox[{
           RowBox[{"-", "1"}], "\[Rule]", "CanvasHead"}]}], "}"}]}], 
       "]"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.515541817625*^9, {3.515541908421875*^9, 3.515541912828125*^9}, {
   3.515541996375*^9, 3.515541998203125*^9}, {3.515597628171875*^9, 
   3.51559764675*^9}, {3.5155978139375*^9, 3.5155978360625*^9}, {
   3.51559791015625*^9, 3.515597910953125*^9}, 3.51560013915625*^9, 
   3.51560485446875*^9, {3.51561594209375*^9, 3.51561595153125*^9}, {
   3.515616120734375*^9, 3.515616383671875*^9}, {3.51578413475*^9, 
   3.515784134765625*^9}, {3.5158833268125*^9, 3.515883339609375*^9}, {
   3.5158834336875*^9, 3.515883664703125*^9}, {3.515883697390625*^9, 
   3.515883702359375*^9}, {3.515883763125*^9, 3.5158837834375*^9}, {
   3.516039730223875*^9, 3.516039733067625*^9}, 3.516041458442625*^9, {
   3.516283690546875*^9, 3.516283692015625*^9}, {3.5162837529375*^9, 
   3.516283782609375*^9}, {3.51628382984375*^9, 3.516283855359375*^9}, {
   3.51628388653125*^9, 3.5162839798125*^9}, {3.5162840126875*^9, 
   3.516284094875*^9}, {3.516284135125*^9, 3.51628416175*^9}, {
   3.516287709125*^9, 3.516287721984375*^9}, {3.51628800634375*^9, 
   3.516288007140625*^9}, {3.51951355859375*^9, 3.519513605671875*^9}, {
   3.6251644284293165`*^9, 3.6251644284293165`*^9}, {3.6251666043865385`*^9, 
   3.62516660490134*^9}, {3.625341741504884*^9, 3.625341886117138*^9}, {
   3.6254525703528705`*^9, 3.62545263868099*^9}, {3.625452676947858*^9, 
   3.6254527487235837`*^9}, {3.6254530179020567`*^9, 
   3.6254530487901106`*^9}},ExpressionUUID->"1ea54852-9d07-4f68-bdd2-\
b4b13905c4c1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Curve resolution -- from graphics", "Subsection",
 CellChangeTimes->{{3.51543991717225*^9, 3.515439949641*^9}, 
   3.515449053281625*^9, {3.515449138891*^9, 3.515449139687875*^9}, {
   3.516039575130125*^9, 
   3.516039577067625*^9}},ExpressionUUID->"594751e5-ee36-4713-9eb5-\
ac12acd0a337"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigResolveCurve", "[", 
    RowBox[{"Self_Object", ",", 
     RowBox[{"G", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", "_Graphics", ")"}], "|", 
        RowBox[{"(", "_ContourGraphics", ")"}]}], ")"}]}], ",", 
     "FullOptions_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "GrabbedPoints", ",", "CanvasPoints", ",", "CanvasTail", ",", 
       "CanvasHead"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"resolve", " ", "points"}], " ", "*)"}], "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"GrabbedPoints", "=", 
       RowBox[{"GrabPoints", "[", 
        RowBox[{"G", ",", 
         RowBox[{"FilterRules", "[", 
          RowBox[{"FullOptions", ",", 
           RowBox[{"Options", "[", "GrabPoints", "]"}]}], "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"flatten", " ", "a", " ", "list", " ", "of", " ", "curves"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Line", "/.", "FullOptions"}], ")"}], "\[Equal]", "All"}],
           ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "[", "GrabbedPoints", "]"}], "\[NotEqual]", 
           "0"}], ")"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"GrabbedPoints", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"GrabbedPoints", ",", "1"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"FigCheckValue", "[", 
       RowBox[{"Self", ",", "GrabbedPoints", ",", 
        RowBox[{"{", 
         RowBox[{"Repeated", "[", 
          RowBox[{"NumericalPairPattern", ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "Infinity"}], "}"}]}], "]"}], "}"}], ",", 
        "\"\<list of extracted points\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CanvasPoints", "=", 
       RowBox[{"FigResolvePoint", "/@", "GrabbedPoints"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"do", " ", "tail", " ", "and", " ", "head", " ", "recess"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"CanvasTail", "=", 
       RowBox[{"InterpolateSegment", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Take", "[", 
          RowBox[{"CanvasPoints", ",", "2"}], "]"}], ",", 
         "\[IndentingNewLine]", "Tail", ",", "Absolute", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"UpgradeScalar", "[", 
          RowBox[{"(", 
           RowBox[{"TailRecess", "/.", "FullOptions"}], ")"}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"CanvasHead", "=", 
       RowBox[{"InterpolateSegment", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Take", "[", 
          RowBox[{"CanvasPoints", ",", 
           RowBox[{"-", "2"}]}], "]"}], ",", "\[IndentingNewLine]", "Head", 
         ",", "Absolute", ",", "\[IndentingNewLine]", 
         RowBox[{"-", 
          RowBox[{"UpgradeScalar", "[", 
           RowBox[{"(", 
            RowBox[{"HeadRecess", "/.", "FullOptions"}], ")"}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"CanvasPoints", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "CanvasTail"}], ",", 
          RowBox[{
           RowBox[{"-", "1"}], "\[Rule]", "CanvasHead"}]}], "}"}]}], 
       "]"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.515541817625*^9, {3.515541908421875*^9, 3.515541912828125*^9}, {
   3.515541996375*^9, 3.515541998203125*^9}, {3.515597628171875*^9, 
   3.51559764675*^9}, {3.5155978139375*^9, 3.5155978360625*^9}, {
   3.51559791015625*^9, 3.515597910953125*^9}, 3.51560013915625*^9, 
   3.51560485446875*^9, {3.51561594209375*^9, 3.51561595153125*^9}, {
   3.515616120734375*^9, 3.515616383671875*^9}, {3.51578413475*^9, 
   3.515784134765625*^9}, {3.5158833268125*^9, 3.515883339609375*^9}, {
   3.5158834336875*^9, 3.515883664703125*^9}, {3.515883697390625*^9, 
   3.515883702359375*^9}, {3.515883763125*^9, 3.5158837834375*^9}, {
   3.516039730223875*^9, 3.516039733067625*^9}, {3.5160414647395*^9, 
   3.516041467536375*^9}, {3.516041517348875*^9, 3.5160415202395*^9}, {
   3.516041566880125*^9, 3.516041684411375*^9}, {3.516283659921875*^9, 
   3.516283666140625*^9}, {3.516554463296875*^9, 3.516554471078125*^9}, {
   3.538849781453125*^9, 3.538849801171875*^9}, {3.53884989434375*^9, 
   3.538849897390625*^9}, {3.570135398645577*^9, 
   3.570135481438099*^9}},ExpressionUUID->"2bf56953-0b2f-4068-82d5-\
bd1ab8a8de61"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Curve point geometry", "Subsection",
 CellChangeTimes->{{3.515166674140625*^9, 3.515166694546875*^9}, {
  3.519648423203125*^9, 3.519648429890625*^9}, {3.583350744594946*^9, 
  3.58335074693495*^9}},ExpressionUUID->"acc200b6-cd3e-4a5f-ace3-\
0585659f04a8"],

Cell["\<\
Generation of underlying interpolation functions
Returns: {fRx,fRy} where fRx and fRy are scalar-valued functions of the \
scaled arc-length parameter [0,1]
\tfRx: u -> Rx
\tfRy: u -> Ry
The curve which these functions interpolate along is the simple \
segment-by-segment linear interpolation of the given curve points.\t\
\>", "Text",
 CellChangeTimes->{{3.5833503929560165`*^9, 3.5833504365241857`*^9}, {
  3.583350514875389*^9, 3.583350681352435*^9}, {3.583353219847192*^9, 
  3.5833532803422766`*^9}},ExpressionUUID->"0c449e06-bfcd-4260-8cde-\
2a62a6357ac9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
   "LinearInterpolationFunctionsRxRy", "[", "CanvasPoints_List", "]"}], ":=", 
   
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "Segments", ",", "SegmentLengths", ",", "TotalLength", ",", 
       "CurveParameterValues", ",", "\[IndentingNewLine]", "XFunction", ",", 
       "YFunction", ",", "DXFunction", ",", "DYFunction"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Segments", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{"CanvasPoints", ",", "2", ",", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SegmentLengths", "=", 
       RowBox[{"SegmentLength", "/@", "Segments"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CurveParameterValues", "=", 
       RowBox[{"Prepend", "[", 
        RowBox[{
         RowBox[{"Accumulate", "[", "SegmentLengths", "]"}], ",", "0"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"TotalLength", "=", 
       RowBox[{"Last", "[", "CurveParameterValues", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CurveParameterValues", "=", 
       RowBox[{"CurveParameterValues", "/", "TotalLength"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"set", " ", "up", " ", "curve", " ", "interpolation"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"functions", " ", "for", " ", 
         RowBox[{"x", "[", "d", "]"}]}], ",", " ", 
        RowBox[{"y", "[", "d", "]"}], ",", " ", 
        RowBox[{"theta", "[", "d", "]"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"XFunction", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"CurveParameterValues", ",", 
            RowBox[{"First", "/@", "CanvasPoints"}]}], "}"}], "]"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"YFunction", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"CurveParameterValues", ",", 
            RowBox[{"Last", "/@", "CanvasPoints"}]}], "}"}], "]"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"XFunction", ",", "YFunction"}], "}"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5162908211875*^9, 3.51629085715625*^9}, {
   3.520541559109375*^9, 3.520541560109375*^9}, {3.52054178821875*^9, 
   3.52054179059375*^9}, {3.5205420005*^9, 3.520542162859375*^9}, {
   3.520542347953125*^9, 3.520542355609375*^9}, {3.520542426984375*^9, 
   3.520542468265625*^9}, {3.520542553875*^9, 3.520542644640625*^9}, 
   3.5205427534375*^9, {3.5205428831875*^9, 3.520542895140625*^9}, {
   3.5833531409770813`*^9, 
   3.5833531853271437`*^9}},ExpressionUUID->"920cf733-e1a2-4e2e-9950-\
548c5b9395d4"],

Cell["\<\
Interpolation functions -- LEGACY packaging

Generation of underlying interpolation functions
\tfor curve itself and for tangent
Returns: {R,T} where R and T are vector-valued functions of the scaled \
arc-length parameter [0,1]
\tR: u -> {Rx,Ry}
\tT: u -> {Tx,Ty}
The curve which these functions interpolate along is the simple \
segment-by-segment linear interpolation of the given curve points.\t\
\>", "Text",
 CellChangeTimes->{{3.5833503929560165`*^9, 3.5833504365241857`*^9}, {
   3.583350514875389*^9, 3.583350681352435*^9}, 3.583353219847192*^9, {
   3.583353307672315*^9, 3.5833533299723463`*^9}, {3.58335353976764*^9, 
   3.583353550262655*^9}},ExpressionUUID->"84302d7b-1951-4b57-b572-\
6e87f2296bbf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LinearInterpolationFunctionPair", "[", "CanvasPoints_List", "]"}],
    ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "XFunction", ",", "YFunction", ",", "DXFunction", ",", "DYFunction"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"XFunction", ",", "YFunction"}], "}"}], "=", 
       RowBox[{
       "LinearInterpolationFunctionsRxRy", "[", "CanvasPoints", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"DXFunction", ",", "DYFunction"}], "}"}], "=", 
       RowBox[{
        RowBox[{"Derivative", "[", "1", "]"}], "/@", 
        RowBox[{"{", 
         RowBox[{"XFunction", ",", "YFunction"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"construct", " ", "functions"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"note", ":", " ", 
         RowBox[{
         "use", " ", "of", " ", "With", " ", "is", " ", "necessary", " ", 
          "to", " ", "force", " ", "correct", " ", "functions", " ", "into", 
          " ", "pure", " ", "function", " ", "definitions"}]}], ",", " ", 
        RowBox[{
        "rather", " ", "than", " ", "just", " ", "leaving", " ", "references",
          " ", "to", " ", "the", " ", "local", " ", "symbols", " ", 
         "XFunction"}], ",", " ", 
        RowBox[{"etc", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "=", "XFunction"}], ",", 
          RowBox[{"y", "=", "YFunction"}], ",", 
          RowBox[{"dx", "=", "DXFunction"}], ",", 
          RowBox[{"dy", "=", "DYFunction"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", "[", "#", "]"}], ",", 
             RowBox[{"y", "[", "#", "]"}]}], "}"}], "&"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"dx", "[", "#", "]"}], ",", 
             RowBox[{"dy", "[", "#", "]"}]}], "}"}], "&"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5162908211875*^9, 3.51629085715625*^9}, {
   3.520541559109375*^9, 3.520541560109375*^9}, {3.52054178821875*^9, 
   3.52054179059375*^9}, {3.5205420005*^9, 3.520542162859375*^9}, {
   3.520542347953125*^9, 3.520542355609375*^9}, {3.520542426984375*^9, 
   3.520542468265625*^9}, {3.520542553875*^9, 3.520542644640625*^9}, 
   3.5205427534375*^9, {3.5205428831875*^9, 3.520542895140625*^9}, {
   3.5833534722875457`*^9, 
   3.583353524507619*^9}},ExpressionUUID->"7f235f92-b619-405f-bd56-\
7256f708a957"],

Cell["Segment extraction", "Text",
 CellChangeTimes->{{3.583350737060133*^9, 
  3.5833507393689365`*^9}},ExpressionUUID->"596305e4-b24c-4964-8351-\
519bcb87d2bb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CurveSegment", "::", "badsegment"}], "=", 
   "\"\<A curve with `1` points does not have a segment numbered `2`.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CurveSegment", "::", "badsegmentzero"}], "=", 
   "\"\<Zero is not a valid segment number.\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51949611628125*^9, 3.5194961466875*^9}, {
  3.519496259609375*^9, 
  3.519496286515625*^9}},ExpressionUUID->"5511c307-e485-4447-be3a-\
8dbd2dc0593f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CurveSegment", "[", 
    RowBox[{"Points_List", ",", "s_Integer"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "Points", "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", ">", 
        RowBox[{"n", "-", "1"}]}], ",", 
       RowBox[{"FigError", "[", 
        RowBox[{
        "CurveSegment", ",", "\"\<badsegment\>\"", ",", "n", ",", "s"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"s", "<", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}]}]}], ",", 
       RowBox[{"FigError", "[", 
        RowBox[{
        "CurveSegment", ",", "\"\<badsegment\>\"", ",", "n", ",", "s"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"s", "\[Equal]", "0"}], ",", 
       RowBox[{"FigError", "[", 
        RowBox[{"CurveSegment", ",", "\"\<badsegmentzero\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"s", ">", "0"}], ",", 
       RowBox[{"Points", "[", 
        RowBox[{"[", 
         RowBox[{"s", ";;", 
          RowBox[{"s", "+", "1"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"s", "<", "0"}], ",", 
       RowBox[{"Points", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"s", "-", "1"}], ";;", "s"}], "]"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.519496050109375*^9, 3.519496102953125*^9}, {
  3.519496179078125*^9, 3.51949624621875*^9}, {3.519496300828125*^9, 
  3.51949637259375*^9}, {3.51949663690625*^9, 3.519496638390625*^9}, {
  3.583351136951235*^9, 
  3.5833511436592464`*^9}},ExpressionUUID->"67d1e0cb-f026-40c9-bbcf-\
060c2edbff25"],

Cell["Point extraction", "Text",
 CellChangeTimes->{{3.583351542285843*^9, 
  3.583351544415846*^9}},ExpressionUUID->"97239e2e-3c41-4ca4-a341-\
5aedffcfd72d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CurvePoint", "::", "badpoint"}], "=", 
   "\"\<A curve with `1` points does not have a point numbered `2`.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CurvePoint", "::", "badpointzero"}], "=", 
   "\"\<Zero is not a valid segment number.\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.516289231890625*^9, 3.516289257859375*^9}, {
  3.5195154558125*^9, 3.51951546165625*^9}, {3.519515525296875*^9, 
  3.51951554675*^9}},ExpressionUUID->"66e0b027-4de4-4201-902c-5f6e6cf61d91"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CurvePoint", "[", 
    RowBox[{"Points_List", ",", "k_Integer"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "Points", "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"k", ">", "n"}], ",", 
       RowBox[{"FigError", "[", 
        RowBox[{"CurvePoint", ",", "\"\<badsegment\>\"", ",", "n", ",", "k"}],
         "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"k", "<", 
        RowBox[{"-", "n"}]}], ",", 
       RowBox[{"FigError", "[", 
        RowBox[{"CurvePoint", ",", "\"\<badsegment\>\"", ",", "n", ",", "k"}],
         "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"k", "\[Equal]", "0"}], ",", 
       RowBox[{"FigError", "[", 
        RowBox[{"CurvePoint", ",", "\"\<badsegmentzero\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"k", ">", "0"}], ",", 
       RowBox[{"Points", "[", 
        RowBox[{"[", "k", "]"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"k", "<", "0"}], ",", 
       RowBox[{"Points", "[", 
        RowBox[{"[", "k", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51951551075*^9, 3.519515576375*^9}, 
   3.5195156611875*^9},ExpressionUUID->"e9f29cd5-222b-44e1-a04e-6dc1c18a52bb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Wrapper for case where interpolation should be linear interpolation of points\
\
\>", "Subsection",
 CellChangeTimes->{
  3.5833516185259495`*^9},ExpressionUUID->"a844c19c-73b8-4d94-a415-\
23a72ca36fa8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigCurveAnchorFromPoints", "[", 
    RowBox[{"Points_List", ",", "Name_", ",", "Arg_"}], "]"}], ":=", 
   RowBox[{"FigCurveAnchor", "[", 
    RowBox[{"Points", ",", 
     RowBox[{"LinearInterpolationFunctionPair", "[", "Points", "]"}], ",", 
     "Name", ",", "Arg"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.516291345609375*^9, 3.516291394421875*^9}, {
   3.519651488390625*^9, 3.519651500046875*^9}, {3.520542242359375*^9, 
   3.520542245453125*^9}, 
   3.52054276134375*^9},ExpressionUUID->"85d43af0-8512-44b4-a86c-\
95b7da539d92"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Curve anchor -- on a segment", "Subsection",
 CellChangeTimes->{{3.5833509859585695`*^9, 
  3.5833509965665884`*^9}},ExpressionUUID->"92f84239-a193-40f0-b9e9-\
41ddcef6c658"],

Cell["\<\
wraps recursive call to FigCurveAnchor zooming on given segment

Argument: {s,...} -- within segment s\
\>", "Text",
 CellChangeTimes->{{3.583351000107795*^9, 3.5833510130558176`*^9}, {
  3.5833511783069077`*^9, 
  3.5833511814425135`*^9}},ExpressionUUID->"03476a0f-c7e2-4b8f-bc3c-\
a7044e6d4a84"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigCurveAnchor", "[", 
    RowBox[{"Points_List", ",", 
     RowBox[{"InterpolationFunctionPair", ":", 
      RowBox[{"{", 
       RowBox[{"InterpolationFunction_", ",", "TangentFunction_"}], "}"}]}], 
     ",", "Name_", ",", 
     RowBox[{"{", 
      RowBox[{"s_Integer", ",", "Arg_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"FigCurveAnchorFromPoints", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CurveSegment", "[", 
      RowBox[{"Points", ",", "s"}], "]"}], ",", "\[IndentingNewLine]", "Name",
      ",", "\[IndentingNewLine]", "Arg"}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5833510296854467`*^9, 3.583351127372818*^9}, {
  3.5833511866529226`*^9, 3.5833512856654835`*^9}, {3.5833516349259725`*^9, 
  3.5833516758560295`*^9}},ExpressionUUID->"df65e55c-47da-4464-9974-\
c6f68923a1f7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Curve anchors relative to full curve -- Left/Center/Right", "Subsection",
 CellChangeTimes->{{3.5833507512405577`*^9, 3.5833507735017967`*^9}, {
  3.5833508423759174`*^9, 3.5833508476487265`*^9}, {3.5833513293755445`*^9, 
  3.583351331005547*^9}, {3.583351391005631*^9, 
  3.583351403445648*^9}},ExpressionUUID->"cfc6dbc7-d83a-459e-b548-\
76af15cb20a0"],

Cell["Argument: None -- resolves to scaled arc length 0.5", "Text",
 CellChangeTimes->{{3.583351359635587*^9, 3.5833513791356144`*^9}, {
  3.5833514463657084`*^9, 
  3.5833514477557106`*^9}},ExpressionUUID->"9478db33-97b2-4b34-8e05-\
11495ee42775"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigCurveAnchor", "[", 
    RowBox[{"Points_List", ",", 
     RowBox[{"InterpolationFunctionPair", ":", 
      RowBox[{"{", 
       RowBox[{"InterpolationFunction_", ",", "TangentFunction_"}], "}"}]}], 
     ",", 
     RowBox[{"Side", ":", 
      RowBox[{"(", 
       RowBox[{"Left", "|", "Center", "|", "Right"}], ")"}]}], ",", "None"}], 
    "]"}], ":=", 
   RowBox[{"FigCurveAnchor", "[", 
    RowBox[{
    "Points", ",", "InterpolationFunctionPair", ",", "Side", ",", "0.5"}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.519651668*^9, 3.519651695421875*^9}, {3.5205421875*^9, 
  3.5205422019375*^9}, {3.520542682296875*^9, 3.52054269153125*^9}, {
  3.520542754921875*^9, 
  3.520542755796875*^9}},ExpressionUUID->"ff099cda-a53c-4be0-8585-\
cd13255d3bd0"],

Cell["Argument: u -- scaled arc length", "Text",
 CellChangeTimes->{{3.583350856259942*^9, 3.5833508748863745`*^9}, {
   3.583350912622841*^9, 3.583350957004919*^9}, {3.5833511762633038`*^9, 
   3.5833511765285044`*^9}, 
   3.583351449765713*^9},ExpressionUUID->"89f80113-f25a-4fc9-ae73-\
1b8b5832b321"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigCurveAnchor", "[", 
    RowBox[{"Points_List", ",", 
     RowBox[{"InterpolationFunctionPair", ":", 
      RowBox[{"{", 
       RowBox[{"InterpolationFunction_", ",", "TangentFunction_"}], "}"}]}], 
     ",", 
     RowBox[{"Side", ":", 
      RowBox[{"(", 
       RowBox[{"Left", "|", "Center", "|", "Right"}], ")"}]}], ",", 
     RowBox[{"u", ":", 
      RowBox[{"(", 
       RowBox[{"_", "?", "NumericQ"}], ")"}]}]}], "]"}], ":=", 
   RowBox[{"Quiet", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FigAnchor", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Canvas", "[", 
        RowBox[{"InterpolationFunction", "[", "u", "]"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{"Side", ",", "Right", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"+", "1"}]}], "}"}], ",", "Center", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", "Left", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"VectorArcTan", "[", 
        RowBox[{"TangentFunction", "[", "u", "]"}], "]"}]}], " ", 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"InterpolatingFunction", "::", "dmval"}], "}"}]}], "  ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "allow", " ", "anchors", " ", "past", " ", "end", " ", "of", " ", 
      "line"}], " ", "*)"}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.516288605859375*^9, 3.516288606140625*^9}, 
   3.5162887196875*^9, {3.5162888203125*^9, 3.516288864875*^9}, {
   3.516288997890625*^9, 3.51628899990625*^9}, {3.51629023153125*^9, 
   3.51629023346875*^9}, {3.516290271109375*^9, 3.516290273875*^9}, {
   3.5162903079375*^9, 3.516290309765625*^9}, 3.516290356953125*^9, 
   3.51801893303125*^9, 3.5194957400625*^9, {3.519651547234375*^9, 
   3.519651610390625*^9}, 3.519651659203125*^9, {3.519728616296875*^9, 
   3.51972864125*^9}, 3.5197287649375*^9, {3.5205421776875*^9, 
   3.520542206140625*^9}, 3.52054275425*^9, {3.6347579621728563`*^9, 
   3.63475797547968*^9}},ExpressionUUID->"32e1f14b-45f8-44d7-857d-\
be5812ab8940"],

Cell["\<\
Arg: {DisplaceAlongHead|DisplaceAlongTail,d} -- tangent displacement from \
tail/head\
\>", "Text",
 CellChangeTimes->{{3.522196309140625*^9, 3.5221963134375*^9}, {
  3.5833477625915565`*^9, 3.5833477711966887`*^9}, {3.5833488139100037`*^9, 
  3.583348827702716*^9}, {3.5833517009260645`*^9, 3.5833517444261255`*^9}, {
  3.58335185457628*^9, 3.5833518620162907`*^9}, {3.583351920496372*^9, 
  3.583351920826373*^9}, {3.625454537216856*^9, 
  3.625454537652881*^9}},ExpressionUUID->"a107f7c8-46e6-4e14-86a2-\
d184e72f2532"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FigCurveAnchor", "[", 
    RowBox[{"Points_List", ",", 
     RowBox[{"InterpolationFunctionPair", ":", 
      RowBox[{"{", 
       RowBox[{"InterpolationFunction_", ",", "TangentFunction_"}], "}"}]}], 
     ",", 
     RowBox[{"Side", ":", 
      RowBox[{"(", 
       RowBox[{"Left", "|", "Center", "|", "Right"}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"DisplaceAlongTail", ",", 
       RowBox[{"d_", "?", "NumericQ"}]}], "}"}]}], "]"}], ":=", 
   RowBox[{"DisplaceAlongAnchor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FigCurveAnchor", "[", 
      RowBox[{
      "Points", ",", "InterpolationFunctionPair", ",", "Center", ",", "0"}], 
      "]"}], ",", "\[IndentingNewLine]", "d"}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FigCurveAnchor", "[", 
    RowBox[{"Points_List", ",", 
     RowBox[{"InterpolationFunctionPair", ":", 
      RowBox[{"{", 
       RowBox[{"InterpolationFunction_", ",", "TangentFunction_"}], "}"}]}], 
     ",", 
     RowBox[{"Side", ":", 
      RowBox[{"(", 
       RowBox[{"Left", "|", "Center", "|", "Right"}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"DisplaceAlongHead", ",", 
       RowBox[{"d_", "?", "NumericQ"}]}], "}"}]}], "]"}], ":=", 
   RowBox[{"DisplaceAlongAnchor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FigCurveAnchor", "[", 
      RowBox[{
      "Points", ",", "InterpolationFunctionPair", ",", "Center", ",", "1"}], 
      "]"}], ",", "\[IndentingNewLine]", "d"}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.52219633125*^9, 3.522196341078125*^9}, {
  3.522196396234375*^9, 3.522196469515625*^9}, {3.522196565890625*^9, 
  3.52219656940625*^9}, {3.583347774771744*^9, 3.58334778885196*^9}, {
  3.625166606976144*^9, 3.625166610064949*^9}, {3.625454538728943*^9, 
  3.625454539519988*^9}},ExpressionUUID->"ae7622ab-ddd5-4f08-b5c8-\
e27f601d4d97"],

Cell["\<\
Arg: {Horizontal|Vertical,x} -- at given horizontal/vertical coordinate (with \
x in general syntax for individual coordinate)\
\>", "Text",
 CellChangeTimes->{{3.522196309140625*^9, 3.5221963134375*^9}, {
  3.5833477625915565`*^9, 3.5833477711966887`*^9}, {3.5833488139100037`*^9, 
  3.583348827702716*^9}, {3.5833517009260645`*^9, 3.5833517444261255`*^9}, {
  3.58335185457628*^9, 3.5833518620162907`*^9}, {3.583351941816402*^9, 
  3.5833519766564507`*^9}},ExpressionUUID->"97560fa1-3484-4a7a-bd0c-\
aef4590aadde"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigCurveAnchor", "[", 
    RowBox[{"Points_List", ",", 
     RowBox[{"InterpolationFunctionPair", ":", 
      RowBox[{"{", 
       RowBox[{"InterpolationFunction_", ",", "TangentFunction_"}], "}"}]}], 
     ",", 
     RowBox[{"Side", ":", 
      RowBox[{"(", 
       RowBox[{"Left", "|", "Center", "|", "Right"}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"CoordinateIndexName", ":", 
        RowBox[{"(", 
         RowBox[{"Horizontal", "|", "Vertical"}], ")"}]}], ",", 
       RowBox[{"x", ":", "FigCoordinatePattern"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "fRc", ",", "xc", ",", "uRule", ",", "u", ",", "CoordinateIndex", ",", 
       "CanvasPoint"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fRc", "=", 
       RowBox[{"LinearInterpolationFunctionsRxRy", "[", "Points", "]"}]}], 
      ";", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{"AD", " ", 
        RowBox[{"HOC", " ", "--"}], " ", "perhaps", " ", "to", " ", "be", " ",
         "revised", " ", "if", " ", "these", " ", "become", " ", "the", " ", 
        "stored", " ", "interpolation", " ", "functions"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"CoordinateIndex", "=", 
       RowBox[{
       "FigResolveCoordinateIndex", "[", "CoordinateIndexName", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xc", "=", 
       RowBox[{"FigResolveCoordinate", "[", 
        RowBox[{"x", ",", "CoordinateIndex"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"recover", " ", "curve", " ", "parameter"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Quiet", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"uRule", "=", "\[IndentingNewLine]", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"fRc", "[", 
               RowBox[{"[", "CoordinateIndex", "]"}], "]"}], "[", "u", "]"}], 
             "-", "xc"}], ",", 
            RowBox[{"{", 
             RowBox[{"u", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"u", "=", 
          RowBox[{"Last", "@", 
           RowBox[{"Last", "@", "uRule"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"CanvasPoint", "=", 
          RowBox[{"InterpolationFunction", "[", "u", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"FigAnchor", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Canvas", "[", "CanvasPoint", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Switch", "[", 
            RowBox[{"Side", ",", "Right", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"+", "1"}]}], "}"}], ",", "Center", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "Left", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"VectorArcTan", "[", 
            RowBox[{"TangentFunction", "[", "u", "]"}], "]"}]}], " ", 
          "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"InterpolatingFunction", "::", "dmval"}], "}"}]}], "  ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "allow", " ", "anchors", " ", "past", " ", "end", " ", "of", " ", 
         "line"}], " ", "*)"}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.52219633125*^9, 3.522196341078125*^9}, {
   3.522196396234375*^9, 3.522196469515625*^9}, {3.522196565890625*^9, 
   3.52219656940625*^9}, {3.583347774771744*^9, 3.58334778885196*^9}, {
   3.5833520134765024`*^9, 3.583352026736521*^9}, {3.5833520943366156`*^9, 
   3.5833521264766607`*^9}, {3.58335591533827*^9, 3.58335592922829*^9}, {
   3.583355961678335*^9, 3.583355987418371*^9}, {3.5835089821272354`*^9, 
   3.58350899404392*^9}, {3.5913934729327726`*^9, 3.591393668213916*^9}, {
   3.5913937186956043`*^9, 3.5913938085361624`*^9}, {3.5913938508278365`*^9, 
   3.591393876193481*^9}, {3.591394001368101*^9, 3.5913940030061035`*^9}, {
   3.5913940370297637`*^9, 3.591394118071906*^9}, {3.5913942191600833`*^9, 
   3.591394249564537*^9}, {3.5913942930886135`*^9, 3.5913943096246424`*^9}, {
   3.634757018542799*^9, 3.634757032146023*^9}, {3.6347571925455046`*^9, 
   3.634757295677286*^9}, 3.634757853144265*^9, {3.634757939038016*^9, 
   3.6347579427820225`*^9}, 
   3.634758044993402*^9},ExpressionUUID->"4df9f6e9-76cd-4a55-a8c4-\
9b40c082ebea"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Curve anchors at ends of curve -- Tail/Head", "Subsection",
 CellChangeTimes->{{3.5833507512405577`*^9, 3.5833507735017967`*^9}, {
  3.5833508423759174`*^9, 3.5833508476487265`*^9}, {3.5833513293755445`*^9, 
  3.583351331005547*^9}, {3.583351391005631*^9, 3.583351403445648*^9}, {
  3.5833514363856945`*^9, 
  3.5833514429457035`*^9}},ExpressionUUID->"45c2568a-d9ff-4cda-9fd5-\
e802f93a4f6f"],

Cell["Argument: None", "Text",
 CellChangeTimes->{{3.5162890259375*^9, 3.5162890281875*^9}, {
  3.583351454075719*^9, 
  3.583351455265721*^9}},ExpressionUUID->"e62b8666-bff7-4684-b539-\
c3256ba42f60"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FigCurveAnchor", "[", 
    RowBox[{"Points_List", ",", 
     RowBox[{"InterpolationFunctionPair", ":", 
      RowBox[{"{", 
       RowBox[{"InterpolationFunction_", ",", "TangentFunction_"}], "}"}]}], 
     ",", "Tail", ",", "None"}], "]"}], ":=", 
   RowBox[{"FigAnchor", "[", 
    RowBox[{
     RowBox[{"FigCurveAnchor", "[", 
      RowBox[{
      "Points", ",", "InterpolationFunctionPair", ",", "Center", ",", "0"}], 
      "]"}], ",", "Right"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigCurveAnchor", "[", 
    RowBox[{"Points_List", ",", 
     RowBox[{"InterpolationFunctionPair", ":", 
      RowBox[{"{", 
       RowBox[{"InterpolationFunction_", ",", "TangentFunction_"}], "}"}]}], 
     ",", "Head", ",", "None"}], "]"}], ":=", 
   RowBox[{"FigAnchor", "[", 
    RowBox[{
     RowBox[{"FigCurveAnchor", "[", 
      RowBox[{
      "Points", ",", "InterpolationFunctionPair", ",", "Center", ",", "1"}], 
      "]"}], ",", "Left"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51517464803125*^9, 3.515174666234375*^9}, {
  3.5151749220625*^9, 3.515174944015625*^9}, {3.51525866915625*^9, 
  3.515258669703125*^9}, {3.51544000385975*^9, 3.5154400110785*^9}, {
  3.515448814344125*^9, 3.515448817391*^9}, {3.515885061484375*^9, 
  3.515885123609375*^9}, {3.515885158765625*^9, 3.515885177*^9}, {
  3.51588520975*^9, 3.515885211890625*^9}, {3.515885305546875*^9, 
  3.515885334171875*^9}, {3.5159692698125*^9, 3.515969316375*^9}, {
  3.5162888859375*^9, 3.516288899609375*^9}, {3.51628900478125*^9, 
  3.516289008140625*^9}, {3.51628907375*^9, 3.516289104984375*^9}, {
  3.518105316125*^9, 3.518105318203125*^9}, {3.51949590825*^9, 
  3.51949591465625*^9}, {3.519648480609375*^9, 3.5196484845625*^9}, {
  3.520542224234375*^9, 3.520542228875*^9}, {3.52054273165625*^9, 
  3.520542759203125*^9}},ExpressionUUID->"c5139bfa-b011-4bde-b9e3-\
35ee216123a1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Curve anchor at enumerated point -- Point", "Subsection",
 CellChangeTimes->{{3.5833507512405577`*^9, 3.5833507735017967`*^9}, {
  3.5833508423759174`*^9, 3.5833508476487265`*^9}, {3.5833513293755445`*^9, 
  3.583351331005547*^9}, {3.583351391005631*^9, 3.583351403445648*^9}, {
  3.5833514363856945`*^9, 3.5833514429457035`*^9}, {3.583351498095781*^9, 
  3.583351526495821*^9}},ExpressionUUID->"02622fcb-94d0-4584-a85d-\
b68523100a46"],

Cell["Argument: None", "Text",
 CellChangeTimes->{{3.516289165328125*^9, 3.51628916840625*^9}, 
   3.516289318390625*^9, {3.5833515305258265`*^9, 
   3.58335153331583*^9}},ExpressionUUID->"caa7e43c-a91e-423d-a07e-\
f2f37a40d75b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigCurveAnchor", "[", 
    RowBox[{"Points_List", ",", 
     RowBox[{"InterpolationFunctionPair", ":", 
      RowBox[{"{", 
       RowBox[{"InterpolationFunction_", ",", "TangentFunction_"}], "}"}]}], 
     ",", "Point", ",", "k_Integer"}], "]"}], ":=", 
   RowBox[{"FigAnchor", "[", 
    RowBox[{"Canvas", "[", 
     RowBox[{"CurvePoint", "[", 
      RowBox[{"Points", ",", "k"}], "]"}], "]"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51628918009375*^9, 3.516289224453125*^9}, {
   3.51628926325*^9, 3.516289308546875*^9}, 3.5180189345625*^9, {
   3.5195154745625*^9, 3.5195154914375*^9}, {3.519515589265625*^9, 
   3.51951559771875*^9}, {3.51951568890625*^9, 3.519515698796875*^9}, {
   3.519515875859375*^9, 3.519515890453125*^9}, {3.519591909765625*^9, 
   3.519591910703125*^9}, 3.520542236609375*^9, 
   3.52054276034375*^9},ExpressionUUID->"833d47a6-d245-40ac-bee9-\
b896002322b9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bounding box (extremal values)", "Subsection",
 CellChangeTimes->{{3.515166499828125*^9, 
  3.515166506484375*^9}},ExpressionUUID->"511f26ae-1d14-455f-9229-\
287b61e77a2b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FigCurveBoundingBox", "[", 
     RowBox[{"CanvasCurve", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], "..."}], "}"}]}], "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Length", "[", "CanvasCurve", "]"}], "<", "1"}], ")"}]}], ":=", 
   "None"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FigCurveBoundingBox", "[", 
     RowBox[{"CanvasCurve", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], "..."}], "}"}]}], "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Length", "[", "CanvasCurve", "]"}], "\[GreaterEqual]", "1"}], 
     ")"}]}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Min", "[", 
        RowBox[{"First", "/@", "CanvasCurve"}], "]"}], ",", 
       RowBox[{"Max", "[", 
        RowBox[{"First", "/@", "CanvasCurve"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Min", "[", 
        RowBox[{"Last", "/@", "CanvasCurve"}], "]"}], ",", 
       RowBox[{"Max", "[", 
        RowBox[{"Last", "/@", "CanvasCurve"}], "]"}]}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51516616575*^9, 3.51516620196875*^9}, {
   3.515166363734375*^9, 3.51516642103125*^9}, {3.5151665123125*^9, 
   3.51516652478125*^9}, 3.515167326484375*^9, {3.515167359171875*^9, 
   3.515167378671875*^9}, {3.515167540625*^9, 3.515167556453125*^9}, {
   3.515450416844125*^9, 3.515450418844125*^9}, {3.515683051140625*^9, 
   3.51568305628125*^9}},ExpressionUUID->"46c3b365-1826-4e1c-8f9d-\
4043dee5abc3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Standard arrowhead options", "Subsection",
 CellChangeTimes->{{3.51568126209375*^9, 3.515681269890625*^9}, {
  3.5160463231145*^9, 
  3.516046323411375*^9}},ExpressionUUID->"39e757fb-77ee-4447-a765-\
8caf35bda4e7"],

Cell["\<\
End-tagged versions are for bracket, with default equal head and tail \
parameters EndLength and EndLip\
\>", "Text",
 CellChangeTimes->{{3.5670374626436653`*^9, 3.567037476106489*^9}, {
  3.5670940329812355`*^9, 
  3.5670940443692555`*^9}},ExpressionUUID->"78a0d4c5-b159-4ace-a1ef-\
8d54a1b7cd38"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FigArrowheadOptions", "[", 
    RowBox[{
     RowBox[{"st", ":", "LogicalPattern"}], ",", 
     RowBox[{"sh", ":", "LogicalPattern"}], ",", 
     RowBox[{"len_:", "6"}], ",", 
     RowBox[{"lip_:", "3"}]}], "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"TailLength", "\[Rule]", "len"}], ",", 
     RowBox[{"TailLip", "\[Rule]", "lip"}], ",", 
     RowBox[{"ShowTail", "\[Rule]", "st"}], ",", "\[IndentingNewLine]", 
     RowBox[{"HeadLength", "\[Rule]", "len"}], ",", 
     RowBox[{"HeadLip", "\[Rule]", "lip"}], ",", 
     RowBox[{"ShowHead", "\[Rule]", "sh"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigArrowheadOptions", "[", 
    RowBox[{
     RowBox[{"show", ":", "LogicalPattern"}], ",", "len_", ",", "lip_", ",", 
     "End"}], "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"TailLength", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"TailLip", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"ShowTail", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]", 
     RowBox[{"HeadLength", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"HeadLip", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"ShowHead", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]", 
     RowBox[{"EndLength", "\[Rule]", "len"}], ",", 
     RowBox[{"EndLip", "\[Rule]", "lip"}], ",", 
     RowBox[{"ShowEnd", "\[Rule]", "show"}]}], "\[IndentingNewLine]", "}"}]}],
   ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515430903687875*^9, 3.515430989031625*^9}, {
   3.515431026844125*^9, 3.515431030625375*^9}, {3.515431105094125*^9, 
   3.5154311113285*^9}, 3.515609867390625*^9, {3.516046331536375*^9, 
   3.516046383911375*^9}, {3.516299224796875*^9, 3.516299225890625*^9}, {
   3.56703744241043*^9, 3.567037487322909*^9}, {3.567094048596863*^9, 
   3.567094080374119*^9}, {3.5670941662054696`*^9, 3.567094199573928*^9}, {
   3.567094579270195*^9, 
   3.5670945796913958`*^9}},ExpressionUUID->"517599ba-a578-4846-9152-\
c995e44957bc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigCheckArrowheadOptions", "[", "Self_Object", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FigCheckOption", "[", 
       RowBox[{"Self", ",", "TailLength", ",", 
        RowBox[{"_", "?", "NumericQ"}], ",", "FigOptions"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{"Self", ",", "HeadLength", ",", 
        RowBox[{"_", "?", "NumericQ"}], ",", "FigOptions"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{"Self", ",", "TailLip", ",", 
        RowBox[{"NonNegativePattern", "|", 
         RowBox[{"{", 
          RowBox[{"NonNegativePattern", ",", "NonNegativePattern"}], "}"}]}], 
        ",", "FigOptions"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{"Self", ",", "HeadLip", ",", 
        RowBox[{"NonNegativePattern", "|", 
         RowBox[{"{", 
          RowBox[{"NonNegativePattern", ",", "NonNegativePattern"}], "}"}]}], 
        ",", "FigOptions"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{
       "Self", ",", "ShowTail", ",", "LogicalPattern", ",", "FigOptions"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{
       "Self", ",", "ShowHead", ",", "LogicalPattern", ",", "FigOptions"}], 
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515609878875*^9, 3.515609880859375*^9}, {
  3.515609969484375*^9, 3.51560997471875*^9}, {3.51561002109375*^9, 
  3.515610021390625*^9}, {3.515708373859375*^9, 3.515708374140625*^9}, {
  3.515708405015625*^9, 3.5157084079375*^9}, {3.567094109078169*^9, 
  3.567094113258977*^9}},ExpressionUUID->"e5186efd-86a8-4de6-b46e-\
729af21af320"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigCheckArrowheadOptions", "[", 
    RowBox[{"Self_Object", ",", "End"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FigCheckOption", "[", 
       RowBox[{"Self", ",", "EndLength", ",", 
        RowBox[{"_", "?", "NumericQ"}], ",", "FigOptions"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{"Self", ",", "TailLength", ",", 
        RowBox[{"Automatic", "|", 
         RowBox[{"(", 
          RowBox[{"_", "?", "NumericQ"}], ")"}]}], ",", "FigOptions"}], "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{"Self", ",", "HeadLength", ",", 
        RowBox[{"Automatic", "|", 
         RowBox[{"(", 
          RowBox[{"_", "?", "NumericQ"}], ")"}]}], ",", "FigOptions"}], "]"}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{"Self", ",", "EndLip", ",", 
        RowBox[{"NonNegativePattern", "|", 
         RowBox[{"{", 
          RowBox[{"NonNegativePattern", ",", "NonNegativePattern"}], "}"}]}], 
        ",", "FigOptions"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{"Self", ",", "TailLip", ",", 
        RowBox[{"Automatic", "|", "NonNegativePattern", "|", 
         RowBox[{"{", 
          RowBox[{"NonNegativePattern", ",", "NonNegativePattern"}], "}"}]}], 
        ",", "FigOptions"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{"Self", ",", "HeadLip", ",", 
        RowBox[{"Automatic", "|", "NonNegativePattern", "|", 
         RowBox[{"{", 
          RowBox[{"NonNegativePattern", ",", "NonNegativePattern"}], "}"}]}], 
        ",", "FigOptions"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{
       "Self", ",", "ShowEnd", ",", "LogicalPattern", ",", "FigOptions"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{"Self", ",", "ShowTail", ",", 
        RowBox[{"Automatic", "|", "LogicalPattern"}], ",", "FigOptions"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"FigCheckOption", "[", 
       RowBox[{"Self", ",", "ShowHead", ",", 
        RowBox[{"Automatic", "|", "LogicalPattern"}], ",", "FigOptions"}], 
       "]"}], ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515609878875*^9, 3.515609880859375*^9}, {
  3.515609969484375*^9, 3.51560997471875*^9}, {3.51561002109375*^9, 
  3.515610021390625*^9}, {3.515708373859375*^9, 3.515708374140625*^9}, {
  3.515708405015625*^9, 3.5157084079375*^9}, {3.567037274023734*^9, 
  3.567037355939478*^9}, {3.567037393348344*^9, 3.567037437200021*^9}, {
  3.56709408645813*^9, 3.5670941397946234`*^9}, {3.567094211305149*^9, 
  3.567094258011631*^9}},ExpressionUUID->"2d3dda3e-957e-48ac-a6d1-\
1ef0e2254288"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Arrowhead generation", "Subsection",
 CellChangeTimes->{{3.51543692048475*^9, 
  3.515436924094125*^9}},ExpressionUUID->"7286adab-a65e-434a-8b2b-\
1f14e5992271"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"BasicArrowheadPoints", "::", "usage"}], "=", 
    "\"\<BasicArrowheadPoints[anchor,headlength,{headlipl,headlipr},sense] \
generates the points for an arrowhead with location and orientation given by \
anchor.\>\""}], ";"}], "*)"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"0541f4a2-71eb-4156-9408-358313b520f1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BasicArrowheadPoints", "[", 
    RowBox[{
     RowBox[{"a", ":", 
      RowBox[{"ObjectPattern", "[", "FigAnchor", "]"}]}], ",", 
     RowBox[{"HeadLength_", "?", "NumericQ"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"HeadLipL_", "?", "NumericQ"}], ",", 
       RowBox[{"HeadLipR_", "?", "NumericQ"}]}], "}"}], ",", 
     RowBox[{"Sense", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "|", "1"}], ")"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"P", ",", "theta"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"P", "=", 
       RowBox[{"(", 
        RowBox[{"a", "@", 
         RowBox[{"GetPoint", "[", "]"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"theta", "=", 
       RowBox[{"(", 
        RowBox[{"a", "@", 
         RowBox[{"GetAngle", "[", "]"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"P", "+", 
         RowBox[{
          RowBox[{"RotationTransform", "[", 
           RowBox[{"N", "@", "theta"}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"HeadLength", ",", "HeadLipL"}], "}"}], "*", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "Sense"}], ",", 
             RowBox[{"+", "1"}]}], "}"}], "*", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"HeadLipL", ">", "0"}], ",", "1", ",", "0"}], "]"}]}], 
          "]"}]}], ",", "\[IndentingNewLine]", "P", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"P", "+", 
         RowBox[{
          RowBox[{"RotationTransform", "[", 
           RowBox[{"N", "@", "theta"}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"HeadLength", ",", "HeadLipR"}], "}"}], "*", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "Sense"}], ",", 
             RowBox[{"-", "1"}]}], "}"}], "*", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"HeadLipR", ">", "0"}], ",", "1", ",", "0"}], "]"}]}], 
          "]"}]}]}], "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.515433515266*^9, 3.515433532406625*^9}, {
   3.51543358142225*^9, 3.51543369329725*^9}, {3.515436948812875*^9, 
   3.515436980016*^9}, {3.51543703835975*^9, 3.51543713579725*^9}, {
   3.515437198344125*^9, 3.515437203437875*^9}, {3.515437434594125*^9, 
   3.51543759873475*^9}, {3.515437720187875*^9, 3.515437721656625*^9}, {
   3.515437809937875*^9, 3.51543781460975*^9}, 3.51568263378125*^9, {
   3.515682783328125*^9, 3.515682784953125*^9}, {3.51951328603125*^9, 
   3.519513362078125*^9}},ExpressionUUID->"3cbe2cf9-4aa2-4801-a190-\
23a4f98ee010"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigCurveArrowheadPoints", "[", 
    RowBox[{
     RowBox[{"TailAnchor", ":", 
      RowBox[{"ObjectPattern", "[", "FigAnchor", "]"}]}], ",", 
     RowBox[{"HeadAnchor", ":", 
      RowBox[{"ObjectPattern", "[", "FigAnchor", "]"}]}], ",", 
     "FullOptions_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "tail", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ShowTail", "/.", "FullOptions"}], ")"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"BasicArrowheadPoints", "[", 
          RowBox[{"TailAnchor", ",", 
           RowBox[{"(", 
            RowBox[{"TailLength", "/.", "FullOptions"}], ")"}], ",", 
           RowBox[{"UpgradePair", "[", 
            RowBox[{"(", 
             RowBox[{"TailLip", "/.", "FullOptions"}], ")"}], "]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "head", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ShowHead", "/.", "FullOptions"}], ")"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"BasicArrowheadPoints", "[", 
          RowBox[{"HeadAnchor", ",", 
           RowBox[{"(", 
            RowBox[{"HeadLength", "/.", "FullOptions"}], ")"}], ",", 
           RowBox[{"UpgradePair", "[", 
            RowBox[{"(", 
             RowBox[{"HeadLip", "/.", "FullOptions"}], ")"}], "]"}], ",", 
           RowBox[{"+", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51543307960975*^9, 3.5154332384535*^9}, {
  3.51543331317225*^9, 3.515433417641*^9}, {3.51543349635975*^9, 
  3.515433497281625*^9}, {3.515437939750375*^9, 3.515438047656625*^9}, {
  3.515438849906625*^9, 3.515438850625375*^9}, {3.51544736198475*^9, 
  3.515447362531625*^9}, {3.51544749329725*^9, 3.515447497312875*^9}, {
  3.515447902156625*^9, 3.5154479028285*^9}, {3.51553712946875*^9, 
  3.515537154546875*^9}, {3.51560043484375*^9, 3.515600446765625*^9}, {
  3.51560995946875*^9, 3.515609960328125*^9}, {3.515682415078125*^9, 
  3.515682442609375*^9}, {3.51568250925*^9, 3.515682521015625*^9}, {
  3.515682551234375*^9, 3.5156826011875*^9}, {3.51568278784375*^9, 
  3.5156827915*^9}, {3.515708374296875*^9, 3.51570837440625*^9}, {
  3.5670375679438505`*^9, 
  3.5670375855094814`*^9}},ExpressionUUID->"1f341573-3453-4f76-b545-\
c8b03a69885e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FigCurveArrowheadPoints", "[", 
    RowBox[{
     RowBox[{"TailAnchor", ":", 
      RowBox[{"ObjectPattern", "[", "FigAnchor", "]"}]}], ",", 
     RowBox[{"HeadAnchor", ":", 
      RowBox[{"ObjectPattern", "[", "FigAnchor", "]"}]}], ",", 
     RowBox[{"ReversedSide", ":", "LogicalPattern"}], ",", "FullOptions_List",
      ",", "End"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "UsedTailLength", ",", "UsedHeadLength", ",", "UsedTailLip", ",", 
       "UsedHeadLip", ",", "UsedShowTail", ",", "UsedShowHead"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "tail", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"UsedShowTail", "=", 
         RowBox[{"ResolveOption", "[", 
          RowBox[{"ShowTail", ",", 
           RowBox[{"{", 
            RowBox[{"Automatic", "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{"ShowEnd", "/.", "FullOptions"}], ")"}]}], "}"}], ",", 
           "FullOptions"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{"UsedShowTail", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"UsedTailLength", "=", 
            RowBox[{"ResolveOption", "[", 
             RowBox[{"TailLength", ",", 
              RowBox[{"{", 
               RowBox[{"Automatic", "\[RuleDelayed]", 
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{"EndLength", "/.", "FullOptions"}], ")"}]}]}], 
               "}"}], ",", "FullOptions"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"UsedTailLip", "=", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"ReversedSide", ",", "Reverse", ",", "Identity"}], 
              "]"}], "@", 
             RowBox[{"UpgradePair", "[", 
              RowBox[{"ResolveOption", "[", 
               RowBox[{"TailLip", ",", 
                RowBox[{"{", 
                 RowBox[{"Automatic", "\[RuleDelayed]", 
                  RowBox[{"(", 
                   RowBox[{"EndLip", "/.", "FullOptions"}], ")"}]}], "}"}], 
                ",", "FullOptions"}], "]"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"BasicArrowheadPoints", "[", 
            RowBox[{
            "TailAnchor", ",", "UsedTailLength", ",", "UsedTailLip", ",", 
             RowBox[{"-", "1"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "head", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"UsedShowHead", "=", 
         RowBox[{"ResolveOption", "[", 
          RowBox[{"ShowHead", ",", 
           RowBox[{"{", 
            RowBox[{"Automatic", "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{"ShowEnd", "/.", "FullOptions"}], ")"}]}], "}"}], ",", 
           "FullOptions"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{"UsedShowHead", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"UsedHeadLength", "=", 
            RowBox[{"ResolveOption", "[", 
             RowBox[{"HeadLength", ",", 
              RowBox[{"{", 
               RowBox[{"Automatic", "\[RuleDelayed]", 
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{"EndLength", "/.", "FullOptions"}], ")"}]}]}], 
               "}"}], ",", "FullOptions"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"UsedHeadLip", "=", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"ReversedSide", ",", "Reverse", ",", "Identity"}], 
              "]"}], "@", 
             RowBox[{"UpgradePair", "[", 
              RowBox[{"ResolveOption", "[", 
               RowBox[{"HeadLip", ",", 
                RowBox[{"{", 
                 RowBox[{"Automatic", "\[RuleDelayed]", 
                  RowBox[{"(", 
                   RowBox[{"EndLip", "/.", "FullOptions"}], ")"}]}], "}"}], 
                ",", "FullOptions"}], "]"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"BasicArrowheadPoints", "[", 
            RowBox[{
            "HeadAnchor", ",", "UsedHeadLength", ",", "UsedHeadLip", ",", 
             RowBox[{"+", "1"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51543307960975*^9, 3.5154332384535*^9}, {
   3.51543331317225*^9, 3.515433417641*^9}, {3.51543349635975*^9, 
   3.515433497281625*^9}, {3.515437939750375*^9, 3.515438047656625*^9}, {
   3.515438849906625*^9, 3.515438850625375*^9}, {3.51544736198475*^9, 
   3.515447362531625*^9}, {3.51544749329725*^9, 3.515447497312875*^9}, {
   3.515447902156625*^9, 3.5154479028285*^9}, {3.51553712946875*^9, 
   3.515537154546875*^9}, {3.51560043484375*^9, 3.515600446765625*^9}, {
   3.51560995946875*^9, 3.515609960328125*^9}, {3.515682415078125*^9, 
   3.515682442609375*^9}, {3.51568250925*^9, 3.515682521015625*^9}, {
   3.515682551234375*^9, 3.5156826011875*^9}, {3.51568278784375*^9, 
   3.5156827915*^9}, {3.515708374296875*^9, 3.51570837440625*^9}, {
   3.5670375679438505`*^9, 3.5670375855094814`*^9}, {3.567037680591648*^9, 
   3.5670377900258403`*^9}, {3.5670937497783384`*^9, 3.567093837232092*^9}, {
   3.5670938814269695`*^9, 3.5670940214684153`*^9}, {3.567094276404063*^9, 
   3.567094349817792*^9}, {3.567094810509401*^9, 3.567094811585803*^9}, {
   3.5670948550318794`*^9, 3.56709486119389*^9}, 3.5670949372128234`*^9, {
   3.5670950192221675`*^9, 3.567095034385394*^9}, 
   3.5670951692788305`*^9},ExpressionUUID->"6566bb5d-8f70-4bdc-a06c-\
3ae28a9ee362"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Curve extraction from graphics", "Subsection",
 CellChangeTimes->{{3.51603981358325*^9, 
  3.516039817817625*^9}},ExpressionUUID->"84fea35e-589f-4fa4-8f4b-\
73593028801a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GrabPoints", "::", "nocurve"}], "=", "\"\<No curves found.\>\""}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GrabPoints", "::", "fewcurve"}], "=", 
   "\"\<Requested Line->`1` is greater than the number `2` of curves found.\>\
\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GrabPoints", "::", "shortcurve"}], "=", 
   "\"\<Curve obtained `1` has fewer than two points and therefore may be \
unsuitable for use as an argument to functions or objects.\>\""}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.516040455755125*^9, 3.5160405058645*^9}, {
   3.516040619067625*^9, 3.516040684473875*^9}, {3.51604075527075*^9, 
   3.516040808692625*^9}, {3.51604095052075*^9, 3.516040967442625*^9}, 
   3.516041153973875*^9},ExpressionUUID->"aef6e4a7-617d-424b-99bc-\
3b7738187de5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Point2D3DPattern", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"_", "?", "NumericQ"}], ",", 
      RowBox[{"_", "?", "NumericQ"}]}], "}"}], "|", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"_", "?", "NumericQ"}], ",", 
      RowBox[{"_", "?", "NumericQ"}], ",", 
      RowBox[{"_", "?", "NumericQ"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "GrabPoints", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"Line", "\[Rule]", "1"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GrabPoints", "[", 
    RowBox[{
     RowBox[{"G", ":", 
      RowBox[{"(", 
       RowBox[{"_Graphics", "|", "_Graphics3D"}], ")"}]}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FullOptions", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Opts", ",", 
           RowBox[{"Options", "[", "GrabPoints", "]"}]}], "}"}], "]"}]}], ",",
        "LineSet", ",", "CurveSet", ",", "Curve"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"validate", " ", "options"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FigCheckOption", "[", 
       RowBox[{"GrabPoints", ",", "Line", ",", 
        RowBox[{"Join", "|", "All", "|", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", "_Integer", ")"}], "?", "Positive"}], ")"}]}], ",", 
        "FullOptions"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"grab", " ", "all", " ", "curves"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "use", " ", "Normal", " ", "to", " ", "resolve", " ", 
        "GraphicsComplex", " ", "into", " ", "Line", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"e", ".", "g", "."}], ",", " ", 
          RowBox[{"in", " ", "output", " ", "of", " ", "ContourPlot"}]}], 
         ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"LineSet", "=", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"Normal", "[", "G", "]"}], ",", 
         RowBox[{
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{"Point2D3DPattern", ".."}], "}"}], "]"}], "|", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Point2D3DPattern", ".."}], "}"}], ".."}], "}"}], 
           "]"}]}], ",", "Infinity"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"CurveSet", "=", 
       RowBox[{"Replace", "[", 
        RowBox[{"LineSet", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Line", "[", 
             RowBox[{"c", ":", 
              RowBox[{"{", 
               RowBox[{"Point2D3DPattern", ".."}], "}"}]}], "]"}], 
            "\[RuleDelayed]", 
            RowBox[{"{", "c", "}"}]}], ",", 
           RowBox[{
            RowBox[{"Line", "[", 
             RowBox[{"cc", ":", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Point2D3DPattern", ".."}], "}"}], ".."}], "}"}]}], 
             "]"}], "\[RuleDelayed]", "cc"}]}], "}"}], ",", 
         RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"CurveSet", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"CurveSet", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "CurveSet", "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{
         RowBox[{"FigMessage", "[", 
          RowBox[{"GrabPoints", ",", "\"\<nocurve\>\""}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"{", "}"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"process", " ", "resulting", " ", "curve", " ", "set"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Line", "/.", "FullOptions"}], ")"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"case", ":", 
          RowBox[{"grab", " ", "specific", " ", "curve"}]}], "*)"}], 
        "\[IndentingNewLine]", "_Integer", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "CurveSet", "]"}], "<", 
            RowBox[{"(", 
             RowBox[{"Line", "/.", "FullOptions"}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"FigMessage", "[", 
             RowBox[{"GrabPoints", ",", "\"\<fewcurve\>\"", ",", 
              RowBox[{"(", 
               RowBox[{"Line", "/.", "FullOptions"}], ")"}], ",", 
              RowBox[{"Length", "[", "CurveSet", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Return", "[", 
             RowBox[{"{", "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Curve", "=", 
          RowBox[{"CurveSet", "[", 
           RowBox[{"[", 
            RowBox[{"(", 
             RowBox[{"Line", "/.", "FullOptions"}], ")"}], "]"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "Curve", "]"}], "<", "2"}], ",", 
           RowBox[{"FigMessage", "[", 
            RowBox[{"GrabPoints", ",", "\"\<shortcurve\>\"", ",", "Curve"}], 
            "]"}]}], "]"}], ";", "\[IndentingNewLine]", "Curve"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"case", ":", 
          RowBox[{"merge", " ", "all", " ", "curves"}]}], "*)"}], 
        "\[IndentingNewLine]", "Join", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Curve", "=", 
          RowBox[{"Join", "@@", "CurveSet"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "Curve", "]"}], "<", "2"}], ",", 
           RowBox[{"FigMessage", "[", 
            RowBox[{"GrabPoints", ",", "\"\<shortcurve\>\"", ",", "Curve"}], 
            "]"}]}], "]"}], ";", "\[IndentingNewLine]", "Curve"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"case", ":", 
          RowBox[{"return", " ", "curve", " ", "list"}]}], "*)"}], 
        "\[IndentingNewLine]", "All", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "Curve", "]"}], "<", "2"}], ",", 
             RowBox[{"FigMessage", "[", 
              RowBox[{"GrabPoints", ",", "\"\<shortcurve\>\"", ",", "Curve"}],
               "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"Curve", ",", "CurveSet"}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "CurveSet"}]}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GrabPoints", "[", 
    RowBox[{
     RowBox[{"CG", ":", 
      RowBox[{"(", "_ContourGraphics", ")"}]}], ",", 
     RowBox[{"Opts___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"GrabPoints", "[", 
    RowBox[{
     RowBox[{"Graphics", "[", "CG", "]"}], ",", "Opts"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5182738013125*^9, 3.518273890390625*^9}, {
  3.538849909703125*^9, 3.538849945859375*^9}, {3.538862665125*^9, 
  3.53886271709375*^9}},ExpressionUUID->"f01e8ea5-b639-430e-9591-\
5c0cfb54faa0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["List manipulation for curves", "Section",
 CellChangeTimes->{{3.56650866302003*^9, 
  3.5665086673568373`*^9}},ExpressionUUID->"1cec407a-1c2b-4218-9117-\
f024ec16274d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SplitByDelimiter", "[", 
    RowBox[{"l_List", ",", "d_Symbol"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "SplitList", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SplitList", "=", 
       RowBox[{"Split", "[", 
        RowBox[{"l", ",", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#1", ",", "#2"}], "}"}], ",", "d"}], "]"}]}], "&"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Cases", "[", 
       RowBox[{"SplitList", ",", 
        RowBox[{"Except", "[", 
         RowBox[{"{", "d", "}"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PurgeOfDelimiter", "[", 
    RowBox[{"l_List", ",", "d_Symbol"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Cases", "[", 
      RowBox[{"l", ",", 
       RowBox[{"Except", "[", "d", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5665084698292904`*^9, 3.5665086055027285`*^9}, {
  3.5665087929994583`*^9, 3.5665088313599253`*^9}, {3.566508929983299*^9, 
  3.5665089701533694`*^9}},ExpressionUUID->"de871b85-75a4-45f7-b095-\
1dbfcb581316"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"SplitByDelimiter", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1", ",", "2", ",", "Split", ",", "4", ",", "Split", ",", "Split"}], 
    "}"}], ",", "Split"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"PurgeOfDelimiter", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1", ",", "2", ",", "Split", ",", "4", ",", "Split", ",", "Split"}], 
    "}"}], ",", "Split"}], "]"}]}], "Input",
 CellChangeTimes->{{3.566508838598338*^9, 3.5665088580515723`*^9}, {
  3.5665099813471456`*^9, 
  3.566509984576351*^9}},ExpressionUUID->"755e1ab2-8c4e-4565-8f1b-\
5129313f4ea3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", "4", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5665088584571733`*^9, {3.5665089365197105`*^9, 3.566508973382575*^9}, 
   3.566509984841552*^9},ExpressionUUID->"98015a34-e4b6-45b5-a685-\
3fcaea8c83a8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "2", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{
  3.5665088584571733`*^9, {3.5665089365197105`*^9, 3.566508973382575*^9}, 
   3.566509984841552*^9},ExpressionUUID->"b29ad33c-afa7-497d-b48e-\
c31580caf98d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AppendFirst", "[", "l_List", "]"}], ":=", 
   RowBox[{"Append", "[", 
    RowBox[{"l", ",", 
     RowBox[{"First", "[", "l", "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.566509986058354*^9, 3.5665100052619877`*^9}, {
  3.566510035744441*^9, 
  3.5665100359160414`*^9}},ExpressionUUID->"22a8871c-3010-44ae-a0a5-\
39b46e9a1ce0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AppendFirst", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.5665100133428016`*^9, 
  3.5665100210648155`*^9}},ExpressionUUID->"b3f0e21c-c19b-43cb-bd0d-\
53e90f8d89ba"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "2", ",", "3", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{{3.5665100212832155`*^9, 
  3.566510037944045*^9}},ExpressionUUID->"a805e116-cbd1-4ef5-8284-\
8f5762788be8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["End package", "Section",
 CellChangeTimes->{{3.514823047703125*^9, 
  3.51482305353125*^9}},ExpressionUUID->"cea95807-39ee-44ee-9fc5-\
9cd2b144e472"],

Cell[CellGroupData[{

Cell["Exit private context", "Subsection",
 CellChangeTimes->{{3.514823086015625*^9, 
  3.5148231094375*^9}},ExpressionUUID->"fc06cd40-67f4-4e19-860c-bceaeb281294"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"00d86ed7-8158-4d59-86b7-5783e789f0b6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Exit package context", "Subsection",
 CellChangeTimes->{{3.514823092890625*^9, 
  3.51482312965625*^9}},ExpressionUUID->"edc0c8db-c8ad-4b8e-a338-\
f89c966128d5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Protect", "[", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"$Context", "<>", "\"\<*\>\""}], "]"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Unprotect", "[", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"$Context", "<>", "\"\<$*\>\""}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"5c463979-f038-4db2-bfc8-971b6ac41378"]
}, Open  ]]
}, Open  ]]
},
WindowToolbars->"EditBar",
WindowSize->{1912, 1145},
WindowMargins->{{-2, Automatic}, {1, Automatic}},
WindowFrame->"Normal",
ShowSelection->True,
Magnification->1.2000000476837158`,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 89, 0, 80, "Section",ExpressionUUID->"208c6ac7-148a-4bd3-9797-2677b1b2219a"],
Cell[671, 24, 3008, 70, 248, "Input",ExpressionUUID->"e26d7ff7-95c1-4171-a54d-cbf17ff9b91f",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[3716, 99, 87, 0, 80, "Section",ExpressionUUID->"7a78406e-7fb0-4e01-9a1d-e8bdf654019b"],
Cell[CellGroupData[{
Cell[3828, 103, 103, 0, 65, "Subsection",ExpressionUUID->"b95caa02-f4a5-4794-800a-7b930824d15e"],
Cell[3934, 105, 1527, 24, 55, "Input",ExpressionUUID->"89275891-c9ce-4dba-98c1-8da5fdce3f76",
 InitializationCell->True],
Cell[5464, 131, 242, 6, 55, "Input",ExpressionUUID->"a0831773-ee1b-4863-b544-d0cd8c29fc9f",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[5743, 142, 98, 0, 65, "Subsection",ExpressionUUID->"db87bdc9-5fc4-48d5-ad56-38892d5f9fe8"],
Cell[5844, 144, 241, 5, 55, "Input",ExpressionUUID->"39efb280-7684-42f3-8dcc-af9689130a29",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[6122, 154, 159, 3, 65, "Subsection",ExpressionUUID->"3e656e35-a0e5-4284-84eb-9d8e6eaa7558"],
Cell[6284, 159, 221, 4, 55, "Input",ExpressionUUID->"19346fc8-0241-4a7a-83b5-de1aa09d4fb3",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[6554, 169, 313, 5, 80, "Section",ExpressionUUID->"a78321a6-1c5b-4c17-be82-b6fcc8d3e5db"],
Cell[CellGroupData[{
Cell[6892, 178, 172, 3, 65, "Subsection",ExpressionUUID->"ba6b3160-b54c-456b-8080-be3b64e63276"],
Cell[7067, 183, 473, 13, 82, "Input",ExpressionUUID->"85c9dda3-1a9f-444c-a46c-79f79f042562",
 InitializationCell->True],
Cell[7543, 198, 412, 12, 80, "Input",ExpressionUUID->"51a029bd-8f36-4bc6-8a38-9717b4f3f83d",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[7992, 215, 165, 3, 65, "Subsection",ExpressionUUID->"1ad1c096-caa8-43dd-a9c1-eee94709351c"],
Cell[8160, 220, 329, 7, 68, "Text",ExpressionUUID->"140798ec-6970-442c-b221-bd29ca833664"],
Cell[8492, 229, 837, 25, 55, "Input",ExpressionUUID->"f3390b97-879a-4d47-abb0-cabb04cf15c3",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[9366, 259, 158, 3, 65, "Subsection",ExpressionUUID->"735cca9f-ea7e-4743-8715-b248d5f8b27b"],
Cell[9527, 264, 422, 13, 55, "Input",ExpressionUUID->"65cb372f-6c9e-4a7a-88c6-e34525072afe",
 InitializationCell->True],
Cell[9952, 279, 818, 27, 55, "Input",ExpressionUUID->"f80975ef-e2de-46b5-bc3f-2801669f6829",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[10807, 311, 279, 4, 65, "Subsection",ExpressionUUID->"5f11e87f-04e0-4c55-b2fe-23ae9c55e93d"],
Cell[11089, 317, 150, 2, 41, "Text",ExpressionUUID->"a555013a-509d-468e-96a1-d91caf55df81"],
Cell[11242, 321, 1770, 51, 66, "Input",ExpressionUUID->"67eb8c8a-803a-4a99-a339-b3748cfb4638",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[13061, 378, 154, 2, 102, "Section",ExpressionUUID->"6771cbc5-8f43-4500-8d5e-991ca920dddc"],
Cell[CellGroupData[{
Cell[13240, 384, 104, 0, 51, "Subsection",ExpressionUUID->"b3e6b489-3718-4518-b422-adc9943cda15"],
Cell[13347, 386, 947, 29, 40, "Input",ExpressionUUID->"6ccb850e-fe47-4485-ab46-05a63a47c0d0",
 InitializationCell->True],
Cell[14297, 417, 1884, 58, 90, "Input",ExpressionUUID->"a7bb0fad-f054-4d23-9a2b-a2f71d7e5e03",
 InitializationCell->True],
Cell[16184, 477, 463, 14, 40, "Input",ExpressionUUID->"c1a3b33b-4bce-48a4-9ece-7aa5a32b23ae",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[16684, 496, 168, 3, 51, "Subsection",ExpressionUUID->"c63da412-2fca-4adb-84f5-e7e6bbba9712"],
Cell[16855, 501, 153, 3, 38, "Text",ExpressionUUID->"57ffcbc7-638c-4622-bc3c-a85721a419c3"],
Cell[17011, 506, 1444, 39, 141, "Input",ExpressionUUID->"8963bc36-24f8-4e14-806f-85e8c737eda8",
 InitializationCell->True],
Cell[18458, 547, 695, 14, 157, "Text",ExpressionUUID->"d767bf86-d478-4b09-93d4-70c94aef7830"],
Cell[19156, 563, 4564, 129, 460, "Input",ExpressionUUID->"f330bd3e-41c3-4748-9548-e7d89a30ef7c",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[23769, 698, 157, 2, 122, "Section",ExpressionUUID->"701badaa-a2b8-4af2-a2ed-8e651dfb587d"],
Cell[CellGroupData[{
Cell[23951, 704, 219, 4, 61, "Subsection",ExpressionUUID->"17d47039-8a8f-45f0-b3ea-287fa227e893"],
Cell[24173, 710, 318, 8, 62, "Text",ExpressionUUID->"072b3020-da10-4dd6-8dfa-aa3e6b64778d"],
Cell[24494, 720, 422, 11, 40, "Input",ExpressionUUID->"d61b79ee-8eb8-4373-aafc-8cf040508b24",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[24953, 736, 147, 3, 61, "Subsection",ExpressionUUID->"9a669006-c628-47ab-ba97-c1178cb1343e"],
Cell[25103, 741, 248, 6, 38, "Text",ExpressionUUID->"1177a4ed-63f7-4e20-8c10-7ea0f33d46a0"],
Cell[25354, 749, 754, 21, 66, "Input",ExpressionUUID->"615afd7c-d3f7-454d-ac3c-ff11178b1421",
 InitializationCell->True],
Cell[26111, 772, 247, 6, 38, "Text",ExpressionUUID->"ab37621b-20d3-45e9-9001-742063a90d22"],
Cell[26361, 780, 873, 25, 69, "Input",ExpressionUUID->"9a131ad3-411d-492b-b55a-bad3241e1600",
 InitializationCell->True],
Cell[27237, 807, 918, 26, 90, "Input",ExpressionUUID->"fea616f4-e1a3-4978-b7c4-a62cc17da301",
 InitializationCell->True],
Cell[28158, 835, 883, 25, 90, "Input",ExpressionUUID->"4ee36305-0fc4-4a40-a984-11b2b4d401ac",
 InitializationCell->True],
Cell[29044, 862, 923, 26, 90, "Input",ExpressionUUID->"2e628984-f7c6-4606-afbd-9d2b3ecbaa0b",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[30016, 894, 255, 4, 175, "Section",ExpressionUUID->"0c3ddaf8-aaac-4118-9599-766acce470e1"],
Cell[CellGroupData[{
Cell[30296, 902, 320, 5, 87, "Subsection",ExpressionUUID->"26685b6d-14d6-4671-bc81-dc03a854be21"],
Cell[30619, 909, 458, 8, 38, "Text",ExpressionUUID->"254c29a8-93ed-4ba4-a724-b46d210e4555"],
Cell[31080, 919, 1250, 37, 121, "Input",ExpressionUUID->"c7adb5bb-5daf-46a4-a7ca-b912a139f3c8",
 InitializationCell->True],
Cell[32333, 958, 1056, 20, 43, "Input",ExpressionUUID->"2b9073b4-f2fb-4d29-8712-d7852b520a9a",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[33426, 983, 209, 4, 87, "Subsection",ExpressionUUID->"db0fc866-0139-4dd5-937d-292a826efeaa"],
Cell[33638, 989, 761, 14, 109, "Text",ExpressionUUID->"a9e0ce27-3397-43b5-aaf2-badabab99033"],
Cell[34402, 1005, 2284, 64, 138, "Input",ExpressionUUID->"a81007ca-5aa6-4fa7-ad05-51d68f3c9603",
 InitializationCell->True],
Cell[36689, 1071, 201, 3, 38, "Text",ExpressionUUID->"bd1a1afe-2e51-4971-9bf2-eddd49549481"],
Cell[36893, 1076, 1724, 47, 240, "Input",ExpressionUUID->"edfa5353-75fb-4627-9270-54869d77fc7a",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[38654, 1128, 289, 3, 51, "Subsection",ExpressionUUID->"51c9cb8d-2e80-4c85-89f3-0308a68f166a"],
Cell[38946, 1133, 873, 22, 40, "Input",ExpressionUUID->"67e826a6-767a-4695-a512-d1d24d6837e5",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[39868, 1161, 213, 4, 175, "Section",ExpressionUUID->"32e9363a-b8b2-4a2e-8668-2cad17879ad9"],
Cell[40084, 1167, 284, 6, 64, "Text",ExpressionUUID->"60396592-c283-4f82-804b-840748e65fcb"],
Cell[CellGroupData[{
Cell[40393, 1177, 190, 3, 51, "Subsection",ExpressionUUID->"ef3078e0-94c1-46e3-98a9-1b568eaf78d8"],
Cell[40586, 1182, 2650, 77, 169, "Input",ExpressionUUID->"517bc679-d72d-4dc9-997d-a30da08dd9e7",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[43273, 1264, 213, 4, 51, "Subsection",ExpressionUUID->"caf9bb40-ecf0-4b37-a302-1380e7b71326"],
Cell[43489, 1270, 1961, 55, 114, "Input",ExpressionUUID->"b124f1b0-61cd-4e09-be93-045f43a5447c",
 InitializationCell->True],
Cell[45453, 1327, 201, 3, 38, "Text",ExpressionUUID->"1325483e-27ea-49ed-94ac-bc8cc9d88abf"],
Cell[45657, 1332, 1852, 48, 240, "Input",ExpressionUUID->"d207621c-bfbc-4293-8233-bd281a7ad634",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[47558, 1386, 160, 3, 175, "Section",ExpressionUUID->"67643ee0-f947-4a37-9d25-09810b19ac35"],
Cell[47721, 1391, 244, 4, 64, "Text",ExpressionUUID->"c4d68c22-7f4e-4ab9-8b24-54327377ad98"],
Cell[CellGroupData[{
Cell[47990, 1399, 165, 3, 87, "Subsection",ExpressionUUID->"c24f996d-6392-4792-b960-4e840c4b522f"],
Cell[48158, 1404, 317, 9, 38, "Text",ExpressionUUID->"c83f4e83-9fe8-4cdd-8665-6c796e5dc604"],
Cell[48478, 1415, 438, 11, 43, "Input",ExpressionUUID->"2cb856f1-0d13-4cb9-97a5-bfdd2772bd74",
 InitializationCell->True],
Cell[48919, 1428, 1104, 33, 138, "Input",ExpressionUUID->"4615960a-efde-44dc-accb-730f22f35b56",
 InitializationCell->True],
Cell[50026, 1463, 994, 32, 114, "Input",ExpressionUUID->"e1784ee3-804d-4d81-bff6-1ad542d80282",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[51057, 1500, 162, 3, 51, "Subsection",ExpressionUUID->"5d28b025-c74c-471a-8b1c-b7177e1bfa62"],
Cell[51222, 1505, 336, 8, 43, "Input",ExpressionUUID->"9d5729f7-e8c0-4e68-84ed-20fb52a5414c",
 InitializationCell->True],
Cell[51561, 1515, 627, 16, 66, "Input",ExpressionUUID->"261a6e33-1616-4046-8999-19417b19e197",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[52237, 1537, 303, 5, 175, "Section",ExpressionUUID->"bbc9ccdb-6453-4825-a926-4f7e8e16bf98"],
Cell[CellGroupData[{
Cell[52565, 1546, 321, 5, 51, "Subsection",ExpressionUUID->"66eddeb1-9d21-4ff9-8664-c48bd6baa024"],
Cell[52889, 1553, 2202, 63, 94, "Input",ExpressionUUID->"0e666322-1f9b-4019-a107-eb0ad3755213",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[55128, 1621, 177, 3, 87, "Subsection",ExpressionUUID->"0d790c14-3521-4975-b711-745905641067"],
Cell[55308, 1626, 579, 17, 226, "Text",ExpressionUUID->"fc984117-d415-4087-8dbb-abd560b943f0"],
Cell[55890, 1645, 2039, 60, 114, "Input",ExpressionUUID->"43197aa7-6f0d-4426-b2db-121afed95c85",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[57966, 1710, 180, 2, 87, "Subsection",ExpressionUUID->"60f630fb-de67-4b93-9cd4-fb2cc9da631b"],
Cell[58149, 1714, 361, 6, 38, "Text",ExpressionUUID->"40ea30dd-a0a4-40e5-b606-37191d2e7c23"],
Cell[58513, 1722, 2990, 90, 66, "Input",ExpressionUUID->"7fe9e50c-40e2-4360-8bbe-3ec5a710d9f5",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[61540, 1817, 205, 3, 124, "Subsection",ExpressionUUID->"2e579d98-5cdc-4e30-81b2-a54ada6af043"],
Cell[61748, 1822, 273, 6, 38, "Text",ExpressionUUID->"e0f77f4a-3a57-4574-a74c-b1d17d5aba64"],
Cell[62024, 1830, 1176, 34, 43, "Input",ExpressionUUID->"2da40daf-b77e-44ef-8959-f8123500655c",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[63237, 1869, 328, 5, 51, "Subsection",ExpressionUUID->"cfefe12a-c6ac-43ac-a401-80f15043c5b6"],
Cell[63568, 1876, 2956, 80, 114, "Input",ExpressionUUID->"35a54482-b6da-4bfd-9d3d-cef98f8a7100",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[66561, 1961, 205, 3, 124, "Subsection",ExpressionUUID->"9a452c93-ccd1-4523-a270-19933479eca0"],
Cell[66769, 1966, 710, 13, 211, "Text",ExpressionUUID->"3aa30291-1e76-42bf-8e4b-da05a4896928"],
Cell[67482, 1981, 436, 8, 38, "Text",ExpressionUUID->"9a69bb8b-0bb2-45e6-92c6-8f5d820ec53f"],
Cell[67921, 1991, 4239, 118, 138, "Input",ExpressionUUID->"72b40dfc-9d38-4e7d-a8ba-0e4e25934732",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[72197, 2114, 175, 3, 124, "Subsection",ExpressionUUID->"6a418b69-9b77-4555-ad06-6fcfa9871aa1"],
Cell[72375, 2119, 326, 7, 62, "Text",ExpressionUUID->"26513b28-611b-4dd3-8f08-6b428851b27f"],
Cell[72704, 2128, 748, 15, 43, "Input",ExpressionUUID->"3aa29102-4c33-4987-94f9-f0596e6e6b7f",
 InitializationCell->True],
Cell[73455, 2145, 3452, 79, 608, "Input",ExpressionUUID->"42d0bd03-b3ba-4bca-80b5-6d022b6eddbf",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[76944, 2229, 160, 3, 65, "Subsection",ExpressionUUID->"916f83ca-b12f-4406-b724-c83f333ce62e"],
Cell[77107, 2234, 175, 3, 41, "Text",ExpressionUUID->"35f65e10-3f62-45fd-9c70-4caeb8eed901"],
Cell[77285, 2239, 1739, 43, 320, "Input",ExpressionUUID->"06a66e4a-814e-422d-8bfc-01f06ddc53d7",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[79061, 2287, 170, 3, 65, "Subsection",ExpressionUUID->"cd6a7f03-3c07-44e4-80d3-584fd81b48fe"],
Cell[79234, 2292, 1218, 36, 82, "Input",ExpressionUUID->"bbac4e1d-a630-4eda-86df-9bbeff9ab0d8",
 InitializationCell->True],
Cell[80455, 2330, 2290, 59, 177, "Input",ExpressionUUID->"64d9ce5d-4691-40c8-a44d-0a79b5ac88e7",
 InitializationCell->True],
Cell[82748, 2391, 177, 3, 41, "Text",ExpressionUUID->"6dda4a23-0913-4eca-a7e5-43f585502de5"],
Cell[82928, 2396, 2286, 50, 298, "Input",ExpressionUUID->"174302b5-5ac1-4b2d-8e6e-5261564683c1",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[85263, 2452, 274, 4, 80, "Section",ExpressionUUID->"eca6dfd6-bdf9-461f-956f-208235dcfae9"],
Cell[85540, 2458, 2373, 36, 520, "Text",ExpressionUUID->"f2b0cd9d-e3e0-4b5e-ba25-980f28990857"],
Cell[87916, 2496, 423, 8, 95, "Text",ExpressionUUID->"28087a24-e31a-4934-904e-eef2b802b8d0"],
Cell[CellGroupData[{
Cell[88364, 2508, 164, 2, 65, "Subsection",ExpressionUUID->"d0a95032-68d4-4ffe-8298-157c0852091c"],
Cell[88531, 2512, 417, 8, 68, "Text",ExpressionUUID->"bf5505f0-4f58-4da1-8959-975b09d12663"],
Cell[88951, 2522, 852, 23, 138, "Input",ExpressionUUID->"0c6a486e-80e1-4270-93d4-4cc4733135b7",
 InitializationCell->True],
Cell[89806, 2547, 1853, 49, 237, "Input",ExpressionUUID->"70126a37-ecd1-4305-91bf-12ea632e61fd",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[91696, 2601, 225, 4, 51, "Subsection",ExpressionUUID->"09530716-44cc-4f07-b111-127b1d65af0b"],
Cell[91924, 2607, 1458, 39, 210, "Input",ExpressionUUID->"60137c80-199b-4e3c-9867-5c7122a4c159",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[93407, 2650, 597, 18, 68, "Input",ExpressionUUID->"ae5f97c5-b970-4f5c-a652-d20ab6a04a61"],
Cell[94007, 2670, 327, 10, 72, "Output",ExpressionUUID->"6b05f4f4-50ae-4f1f-9e5d-1fc4c62ba43a"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[94395, 2687, 170, 3, 175, "Section",ExpressionUUID->"17471a25-cb62-4674-939a-fae2000932cd"],
Cell[CellGroupData[{
Cell[94590, 2694, 171, 3, 51, "Subsection",ExpressionUUID->"d43df64b-a3da-4f71-ad3e-b48c9b59c935"],
Cell[94764, 2699, 578, 16, 43, "Input",ExpressionUUID->"4195cfa5-dfbc-4a20-aa25-9c861a5a0afb",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[95379, 2720, 177, 3, 51, "Subsection",ExpressionUUID->"84c8c44d-40f5-4bb5-bfa0-5a1fbd393b71"],
Cell[95559, 2725, 390, 12, 66, "Input",ExpressionUUID->"1c58ff43-61ae-4a77-9385-83a2555cbd34",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[95986, 2742, 251, 4, 51, "Subsection",ExpressionUUID->"be4d95a0-8668-409c-9b1e-3b08cb957106"],
Cell[96240, 2748, 609, 15, 66, "Input",ExpressionUUID->"e35731fb-93fb-4356-997f-5296b88bfe86",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[96886, 2768, 198, 2, 87, "Subsection",ExpressionUUID->"c606a2e2-384b-4689-ace6-309048c158e1"],
Cell[97087, 2772, 453, 8, 105, "Text",ExpressionUUID->"a6234ed8-4b88-4445-8ada-e22d47967c71"],
Cell[97543, 2782, 153, 3, 38, "Text",ExpressionUUID->"ddce322a-6838-4a9c-9bc3-7cc171553005"],
Cell[97699, 2787, 2033, 58, 122, "Input",ExpressionUUID->"a2b96656-f855-4767-a630-0e2ad1ad1c06",
 InitializationCell->True],
Cell[99735, 2847, 183, 3, 38, "Text",ExpressionUUID->"93b4ae06-cea4-4965-8b3d-825deb9658b1"],
Cell[99921, 2852, 739, 18, 66, "Input",ExpressionUUID->"807dbd7d-6422-4352-a333-3abd625efbcc",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[100697, 2875, 198, 2, 87, "Subsection",ExpressionUUID->"926c5a61-8fa5-4524-832b-a38afea69b25"],
Cell[100898, 2879, 153, 3, 38, "Text",ExpressionUUID->"3cb2893a-37f3-4212-89f3-7b4b0889c004"],
Cell[101054, 2884, 2152, 58, 122, "Input",ExpressionUUID->"44de38e4-9159-4182-a3a2-2dd3193e0cdf",
 InitializationCell->True],
Cell[103209, 2944, 183, 3, 38, "Text",ExpressionUUID->"c8a4a6ea-5746-4da3-8ec9-e92f295f7df2"],
Cell[103395, 2949, 839, 19, 66, "Input",ExpressionUUID->"dca82be7-0848-469f-be57-44b1eb2a77d9",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[104283, 2974, 163, 3, 175, "Section",ExpressionUUID->"b7ed01c5-cb36-4cc2-80d8-74ad697dd93b"],
Cell[CellGroupData[{
Cell[104471, 2981, 212, 4, 51, "Subsection",ExpressionUUID->"a798bf59-9dd0-429d-b4f7-2a6f15c95907"],
Cell[104686, 2987, 1029, 21, 40, "Input",ExpressionUUID->"d1803c0a-9940-4477-965e-9001171571f1",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[105752, 3013, 168, 3, 87, "Subsection",ExpressionUUID->"a20d4996-56df-4e15-a237-9128f9a10302"],
Cell[105923, 3018, 353, 7, 38, "Text",ExpressionUUID->"fb0382cd-f379-4c98-9718-71e80c6e64b6"],
Cell[106279, 3027, 597, 15, 40, "Input",ExpressionUUID->"194eb7ca-73f7-4bc3-8036-4dc384eec197",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[106913, 3047, 308, 5, 51, "Subsection",ExpressionUUID->"212e9662-e5b5-4a73-8794-e7e32fe03ea9"],
Cell[107224, 3054, 1111, 28, 40, "Input",ExpressionUUID->"55d0e707-89a8-4523-bf20-602d1217b15c",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[108384, 3088, 362, 6, 175, "Section",ExpressionUUID->"3c24d3d3-44aa-4f29-9240-50a3b1b07941"],
Cell[CellGroupData[{
Cell[108771, 3098, 161, 3, 51, "Subsection",ExpressionUUID->"57b1f488-0390-45c1-a26a-bf0e4c313dac"],
Cell[108935, 3103, 1477, 38, 121, "Input",ExpressionUUID->"a3ecbc5b-ddb4-4bf8-bf00-908e6610fe4d",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[110449, 3146, 169, 3, 87, "Subsection",ExpressionUUID->"b04e78d3-25f1-4f45-83a6-bce06a243c00"],
Cell[110621, 3151, 376, 8, 105, "Text",ExpressionUUID->"535b24c2-8e49-41b9-97d1-dba5a183a7df"],
Cell[111000, 3161, 175, 3, 38, "Text",ExpressionUUID->"0646e09c-6520-45ad-8b0f-7c9a8d721bd1"],
Cell[111178, 3166, 3066, 73, 450, "Input",ExpressionUUID->"dbb5a96b-d478-4236-bd7e-c6587d990607",
 InitializationCell->True],
Cell[114247, 3241, 160, 3, 38, "Text",ExpressionUUID->"8e383f66-74c6-44ac-813f-fd268fde4db8"],
Cell[114410, 3246, 5381, 105, 402, "Input",ExpressionUUID->"d8c305a4-aac9-4035-b10d-dccbb52641ba",
 InitializationCell->True],
Cell[119794, 3353, 168, 3, 38, "Text",ExpressionUUID->"be2226b4-5580-451a-a405-ba82998d14c1"],
Cell[119965, 3358, 5487, 107, 378, "Input",ExpressionUUID->"e94c2c15-03a8-40f0-a653-a70cfcda4066",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[125489, 3470, 189, 3, 104, "Subsection",ExpressionUUID->"8ce08940-67a2-4914-be71-bdac61abad24"],
Cell[125681, 3475, 302, 7, 126, "Text",ExpressionUUID->"a455493a-3c0a-438d-8453-511ed5e3516f"],
Cell[125986, 3484, 178, 3, 38, "Text",ExpressionUUID->"adafc5ea-8ea4-40fa-b8c0-ca1e97235d2e"],
Cell[126167, 3489, 540, 13, 40, "Input",ExpressionUUID->"4367fed4-b022-42a3-96e7-391b3e86c480",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[126744, 3507, 369, 6, 51, "Subsection",ExpressionUUID->"afbe4314-bee8-40b0-8fa3-e46be0e3afb7"],
Cell[127116, 3515, 1207, 21, 90, "Input",ExpressionUUID->"d2cd1ff7-d7fb-4e04-84bb-c211dbcafef5",
 InitializationCell->True],
Cell[128326, 3538, 1750, 36, 192, "Input",ExpressionUUID->"9425a7ff-f8d8-400e-bee4-27207a797e72",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[130113, 3579, 164, 3, 104, "Subsection",ExpressionUUID->"c82253e9-91b7-4c7f-9bb6-c417cb79b39b"],
Cell[130280, 3584, 406, 9, 224, "Text",ExpressionUUID->"06c5f997-9bf0-481c-aa2f-4a850b82792c"],
Cell[130689, 3595, 177, 3, 38, "Text",ExpressionUUID->"09c430bf-ce29-4720-bd11-626cdaa6d3cf"],
Cell[130869, 3600, 596, 15, 40, "Input",ExpressionUUID->"e090ec7f-9d98-443d-978a-bd32822a4eb6",
 InitializationCell->True],
Cell[131468, 3617, 233, 6, 38, "Text",ExpressionUUID->"d5ca4f72-f932-4462-b9ca-bf512a1e2a30"],
Cell[131704, 3625, 1050, 28, 138, "Input",ExpressionUUID->"97576ddc-192f-46a3-a3de-788028e8dc88",
 InitializationCell->True],
Cell[132757, 3655, 270, 6, 38, "Text",ExpressionUUID->"6168432d-b464-430d-8f84-10e80748c3b8"],
Cell[133030, 3663, 1047, 28, 138, "Input",ExpressionUUID->"9b201589-aa61-492b-b025-715d4719e45e",
 InitializationCell->True],
Cell[134080, 3693, 259, 6, 38, "Text",ExpressionUUID->"934aff96-5ff2-480d-8aef-00b0fc057ae0"],
Cell[134342, 3701, 490, 12, 40, "Input",ExpressionUUID->"dbce92f3-5ce5-45d5-9d48-cfd57a96aaf1",
 InitializationCell->True],
Cell[134835, 3715, 300, 5, 38, "Text",ExpressionUUID->"2a43717b-816c-41fe-9ad2-e9af2b14afbb"],
Cell[135138, 3722, 768, 19, 40, "Input",ExpressionUUID->"39f0dbb2-878b-4fa6-a118-3fe79284a8ba",
 InitializationCell->True],
Cell[135909, 3743, 203, 3, 38, "Text",ExpressionUUID->"d4379402-cb93-4385-9e17-70d3f04f539e"],
Cell[136115, 3748, 1710, 43, 240, "Input",ExpressionUUID->"63c6f0a2-9cb8-4a5c-bde8-58e18412b5eb",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[137862, 3796, 225, 4, 148, "Subsection",ExpressionUUID->"e3a8fb19-2051-49a8-96aa-2d0616f6630c"],
Cell[138090, 3802, 164, 2, 38, "Text",ExpressionUUID->"5a1942ac-99fe-4066-8c15-e1affc396d08"],
Cell[138257, 3806, 1397, 36, 66, "Input",ExpressionUUID->"8e421d79-41b4-4286-bfcc-72969fccc67c",
 InitializationCell->True],
Cell[139657, 3844, 365, 8, 38, "Text",ExpressionUUID->"871d035a-cf7e-431c-9263-ec51894195a3"],
Cell[140025, 3854, 6027, 167, 402, "Input",ExpressionUUID->"b0e2c9fb-f41e-4a58-b483-a589437dcf20",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[146089, 4026, 210, 3, 177, "Subsection",ExpressionUUID->"d0f63447-6cc7-4e8e-99d6-88998158d9f2"],
Cell[146302, 4031, 293, 5, 130, "Text",ExpressionUUID->"69521328-098d-4556-adf5-f195a1e5da96"],
Cell[146598, 4038, 351, 7, 62, "Text",ExpressionUUID->"06e62720-11de-47cc-92fc-2d6b8bdf6797"],
Cell[146952, 4047, 2085, 47, 138, "Input",ExpressionUUID->"8a61ca0e-7553-4b87-8f19-a082559245d5",
 InitializationCell->True],
Cell[149040, 4096, 1535, 41, 138, "Input",ExpressionUUID->"30b71bfe-9d6e-4bf9-95fa-8dd9265cf541",
 InitializationCell->True],
Cell[150578, 4139, 623, 10, 86, "Text",ExpressionUUID->"1c41848a-a10c-4c0a-a92a-8d2b562bbc5b"],
Cell[151204, 4151, 2974, 61, 357, "Input",ExpressionUUID->"c83150e9-9a96-4814-93a3-b0a5cd41e276",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[154215, 4217, 261, 4, 51, "Subsection",ExpressionUUID->"22c2652e-5a89-4137-866e-d67e4dde522b"],
Cell[154479, 4223, 1901, 53, 186, "Input",ExpressionUUID->"0ac0f7c1-0cdf-4231-81b8-dcc64ff3562b",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[156417, 4281, 162, 3, 177, "Subsection",ExpressionUUID->"ff04d625-d0e9-48aa-b92c-7c388585882f"],
Cell[156582, 4286, 240, 4, 130, "Text",ExpressionUUID->"8ea4812b-e943-4812-8dc4-a9d550562c31"],
Cell[156825, 4292, 195, 3, 38, "Text",ExpressionUUID->"e7213795-cf38-40cd-9e82-8b6d7f4363bc"],
Cell[157023, 4297, 2391, 56, 141, "Input",ExpressionUUID->"ee7267d9-321f-40de-8f76-7ffab812fea0",
 InitializationCell->True],
Cell[159417, 4355, 1719, 46, 138, "Input",ExpressionUUID->"9a77910e-7329-44ea-8e75-baad40f2f69c",
 InitializationCell->True],
Cell[161139, 4403, 926, 17, 217, "Text",ExpressionUUID->"60225616-0117-4ed4-872e-adaf375989d8"],
Cell[162068, 4422, 451, 10, 217, "Text",ExpressionUUID->"ccdba59c-c9e7-410b-aa7e-24ddc9d211b7"],
Cell[162522, 4434, 667, 12, 217, "Text",ExpressionUUID->"65feec02-a20c-4bbe-a6eb-4f7c2985e0a7"],
Cell[163192, 4448, 2080, 40, 738, "Program",ExpressionUUID->"54560d93-197f-4121-86ae-fc1317d00063"],
Cell[165275, 4490, 648, 11, 38, "Text",ExpressionUUID->"eaeadbab-0439-4ef9-b679-6df044da3e21"],
Cell[165926, 4503, 8963, 213, 751, "Input",ExpressionUUID->"a14a7c6c-e1d2-42bb-80f5-c7bc9f6b456e",
 InitializationCell->True],
Cell[174892, 4718, 191, 3, 38, "Text",ExpressionUUID->"32378bb0-b885-40fc-905f-d8313151ab17"],
Cell[175086, 4723, 3140, 77, 258, "Input",ExpressionUUID->"98c3299a-fa50-4ba7-acc3-d32c9e19e5f5",
 InitializationCell->True],
Cell[178229, 4802, 380, 9, 62, "Text",ExpressionUUID->"0a4ebbd7-3cc0-43a9-b757-dd202b030946"],
Cell[178612, 4813, 5166, 122, 409, "Input",ExpressionUUID->"34555e4b-065c-490f-a7d4-8cd39b919620",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[183815, 4940, 307, 5, 73, "Subsection",ExpressionUUID->"ed2362f4-53ec-4930-9caa-d2f37127b3f4"],
Cell[184125, 4947, 347, 7, 109, "Text",ExpressionUUID->"5887400e-2c53-4a59-8642-8db7b07454a6"],
Cell[184475, 4956, 2092, 57, 186, "Input",ExpressionUUID->"dff8cbd9-90ab-4d7f-945f-9d976e99f2ab",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[186616, 5019, 346, 5, 146, "Section",ExpressionUUID->"d466a666-2b33-435c-8227-faa392015e91"],
Cell[CellGroupData[{
Cell[186987, 5028, 227, 4, 73, "Subsection",ExpressionUUID->"f02b4fc3-109a-4d01-b1ab-3151ffa380b0"],
Cell[187217, 5034, 714, 13, 62, "Text",ExpressionUUID->"739f1d7c-60d4-4ece-b261-b75e9982b19a"],
Cell[187934, 5049, 2292, 51, 210, "Input",ExpressionUUID->"bd7d4551-3750-4963-8214-fafd3c9b03ca",
 InitializationCell->True],
Cell[190229, 5102, 3213, 69, 380, "Input",ExpressionUUID->"ee48cef3-51aa-4d87-80f9-8af18900a503",
 InitializationCell->True],
Cell[193445, 5173, 2498, 57, 234, "Input",ExpressionUUID->"de16d9f3-5b42-4be7-864a-50c23a6a8393",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[195980, 5235, 210, 4, 51, "Subsection",ExpressionUUID->"c31edbd4-af3b-413e-a007-a96e5b7082b9"],
Cell[196193, 5241, 1713, 39, 162, "Input",ExpressionUUID->"d610392b-7b3e-41f8-b5c4-da817998c851",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[197943, 5285, 167, 3, 61, "Subsection",ExpressionUUID->"08f62cca-88fb-45ed-a32b-6d45f96154ab"],
Cell[198113, 5290, 183, 3, 38, "Text",ExpressionUUID->"79e7afa9-1f3b-4c43-9c3d-e1241647559c"],
Cell[198299, 5295, 889, 22, 162, "Input",ExpressionUUID->"4f665076-548f-4547-85fd-5c52849db553",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[199225, 5322, 221, 4, 61, "Subsection",ExpressionUUID->"5b4cd628-964d-4054-8833-ee34e8939d41"],
Cell[199449, 5328, 183, 3, 38, "Text",ExpressionUUID->"2b1f8591-b947-4acc-90f9-f5013332d9db"],
Cell[199635, 5333, 939, 22, 162, "Input",ExpressionUUID->"e43ef911-bb6e-456d-97d0-bdab9c88b442",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[200611, 5360, 291, 4, 51, "Subsection",ExpressionUUID->"89b4d533-ce90-4c67-8535-627f14bc965d"],
Cell[200905, 5366, 1288, 31, 186, "Input",ExpressionUUID->"d3b1dd60-cb51-427c-9db3-51bdd11f32c6",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[202230, 5402, 239, 4, 51, "Subsection",ExpressionUUID->"9cdddc09-fbaa-4801-920d-7ed98e987d56"],
Cell[202472, 5408, 1113, 27, 138, "Input",ExpressionUUID->"37b25dac-5297-45e0-a193-f3c112a365b3",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[203634, 5441, 200, 3, 122, "Section",ExpressionUUID->"30e49f7f-f24c-4919-bc29-ed73055cf6ba"],
Cell[CellGroupData[{
Cell[203859, 5448, 205, 3, 51, "Subsection",ExpressionUUID->"5779fd2a-0a39-4f18-be66-ab2871aaea59"],
Cell[204067, 5453, 1711, 41, 121, "Input",ExpressionUUID->"12d840d3-a4ad-430d-886c-150eb7568e58",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[205815, 5499, 211, 3, 51, "Subsection",ExpressionUUID->"88e9b229-678d-4f94-9ede-2150106ff66c"],
Cell[206029, 5504, 1164, 28, 210, "Input",ExpressionUUID->"2a5f3dac-ebc2-405c-88c2-801c889869f5",
 InitializationCell->True],
Cell[207196, 5534, 1499, 36, 189, "Input",ExpressionUUID->"7d1f0df3-888b-4506-9628-1b653132a3dc",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[208732, 5575, 311, 5, 61, "Subsection",ExpressionUUID->"5798fbba-6ebe-4ffe-b6b3-d49dbb98e995"],
Cell[209046, 5582, 515, 9, 38, "Text",ExpressionUUID->"e8d0e191-1124-4f68-af2f-a2164b213013"],
Cell[209564, 5593, 370, 8, 40, "Input",ExpressionUUID->"853c17a6-ccb8-49ff-b26a-5942fb70e71c",
 InitializationCell->True],
Cell[209937, 5603, 7985, 171, 936, "Input",ExpressionUUID->"1ea54852-9d07-4f68-bdd2-b4b13905c4c1",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[217959, 5779, 297, 5, 51, "Subsection",ExpressionUUID->"594751e5-ee36-4713-9eb5-ac12acd0a337"],
Cell[218259, 5786, 5011, 113, 668, "Input",ExpressionUUID->"2bf56953-0b2f-4068-82d5-bd1ab8a8de61",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[223307, 5904, 262, 4, 61, "Subsection",ExpressionUUID->"acc200b6-cd3e-4a5f-ace3-0585659f04a8"],
Cell[223572, 5910, 572, 12, 133, "Text",ExpressionUUID->"0c449e06-bfcd-4260-8cde-2a62a6357ac9"],
Cell[224147, 5924, 3266, 73, 498, "Input",ExpressionUUID->"920cf733-e1a2-4e2e-9950-548c5b9395d4",
 InitializationCell->True],
Cell[227416, 5999, 723, 16, 170, "Text",ExpressionUUID->"84302d7b-1951-4b57-b572-6e87f2296bbf"],
Cell[228142, 6017, 3071, 73, 315, "Input",ExpressionUUID->"7f235f92-b619-405f-bd56-7256f708a957",
 InitializationCell->True],
Cell[231216, 6092, 162, 3, 32, "Text",ExpressionUUID->"596305e4-b24c-4964-8351-519bcb87d2bb"],
Cell[231381, 6097, 551, 14, 55, "Input",ExpressionUUID->"5511c307-e485-4447-be3a-8dbd2dc0593f",
 InitializationCell->True],
Cell[231935, 6113, 1914, 49, 215, "Input",ExpressionUUID->"67d1e0cb-f026-40c9-bbcf-060c2edbff25",
 InitializationCell->True],
Cell[233852, 6164, 158, 3, 32, "Text",ExpressionUUID->"97239e2e-3c41-4ca4-a341-5aedffcfd72d"],
Cell[234013, 6169, 581, 13, 55, "Input",ExpressionUUID->"66e0b027-4de4-4201-902c-5f6e6cf61d91",
 InitializationCell->True],
Cell[234597, 6184, 1489, 35, 215, "Input",ExpressionUUID->"e9f29cd5-222b-44e1-a04e-6dc1c18a52bb",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[236123, 6224, 213, 6, 43, "Subsection",ExpressionUUID->"a844c19c-73b8-4d94-a415-23a72ca36fa8"],
Cell[236339, 6232, 616, 14, 34, "Input",ExpressionUUID->"85d43af0-8512-44b4-a86c-95b7da539d92",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[236992, 6251, 180, 3, 43, "Subsection",ExpressionUUID->"92f84239-a193-40f0-b9e9-41ddcef6c658"],
Cell[237175, 6256, 307, 8, 72, "Text",ExpressionUUID->"03476a0f-c7e2-4b8f-bc3c-a7044e6d4a84"],
Cell[237485, 6266, 905, 21, 115, "Input",ExpressionUUID->"df65e55c-47da-4464-9974-c6f68923a1f7",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[238427, 6292, 359, 5, 43, "Subsection",ExpressionUUID->"cfc6dbc7-d83a-459e-b548-76af15cb20a0"],
Cell[238789, 6299, 248, 4, 32, "Text",ExpressionUUID->"9478db33-97b2-4b34-8e05-11495ee42775"],
Cell[239040, 6305, 840, 22, 36, "Input",ExpressionUUID->"ff099cda-a53c-4be0-8585-cd13255d3bd0",
 InitializationCell->True],
Cell[239883, 6329, 303, 5, 32, "Text",ExpressionUUID->"89f80113-f25a-4fc9-ae73-1b8b5832b321"],
Cell[240189, 6336, 2323, 52, 177, "Input",ExpressionUUID->"32e1f14b-45f8-44d7-857d-be5812ab8940",
 InitializationCell->True],
Cell[242515, 6390, 532, 10, 32, "Text",ExpressionUUID->"a107f7c8-46e6-4e14-86a2-d184e72f2532"],
Cell[243050, 6402, 1988, 49, 180, "Input",ExpressionUUID->"ae7622ab-ddd5-4f08-b5c8-e27f601d4d97",
 InitializationCell->True],
Cell[245041, 6453, 526, 9, 32, "Text",ExpressionUUID->"97560fa1-3484-4a7a-bd0c-aef4590aadde"],
Cell[245570, 6464, 4846, 107, 437, "Input",ExpressionUUID->"4df9f6e9-76cd-4a55-a8c4-9b40c082ebea",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[250453, 6576, 398, 6, 43, "Subsection",ExpressionUUID->"45c2568a-d9ff-4cda-9fd5-e802f93a4f6f"],
Cell[250854, 6584, 201, 4, 32, "Text",ExpressionUUID->"e62b8666-bff7-4684-b539-c3256ba42f60"],
Cell[251058, 6590, 1970, 43, 55, "Input",ExpressionUUID->"c5139bfa-b011-4bde-b9e3-35ee216123a1",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[253065, 6638, 442, 6, 43, "Subsection",ExpressionUUID->"02622fcb-94d0-4584-a85d-b68523100a46"],
Cell[253510, 6646, 229, 4, 32, "Text",ExpressionUUID->"caa7e43c-a91e-423d-a07e-f2f37a40d75b"],
Cell[253742, 6652, 970, 21, 34, "Input",ExpressionUUID->"833d47a6-d245-40ac-bee9-b896002322b9",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[254749, 6678, 178, 3, 43, "Subsection",ExpressionUUID->"511f26ae-1d14-455f-9229-287b61e77a2b"],
Cell[254930, 6683, 1958, 54, 115, "Input",ExpressionUUID->"46c3b365-1826-4e1c-8f9d-4043dee5abc3",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[256925, 6742, 220, 4, 43, "Subsection",ExpressionUUID->"39e757fb-77ee-4447-a765-8caf35bda4e7"],
Cell[257148, 6748, 308, 7, 32, "Text",ExpressionUUID->"78a0d4c5-b159-4ace-a1ef-8d54a1b7cd38"],
Cell[257459, 6757, 2105, 45, 195, "Input",ExpressionUUID->"517599ba-a578-4846-9152-c995e44957bc",
 InitializationCell->True],
Cell[259567, 6804, 2044, 43, 260, "Input",ExpressionUUID->"e5186efd-86a8-4de6-b46e-729af21af320",
 InitializationCell->True],
Cell[261614, 6849, 3129, 65, 352, "Input",ExpressionUUID->"2d3dda3e-957e-48ac-a6d1-1ef0e2254288",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[264780, 6919, 167, 3, 51, "Subsection",ExpressionUUID->"7286adab-a65e-434a-8b2b-1f14e5992271"],
Cell[264950, 6924, 393, 9, 40, "Input",ExpressionUUID->"0541f4a2-71eb-4156-9408-358313b520f1",
 InitializationCell->True],
Cell[265346, 6935, 2925, 75, 284, "Input",ExpressionUUID->"3cbe2cf9-4aa2-4801-a190-23a4f98ee010",
 InitializationCell->True],
Cell[268274, 7012, 3066, 62, 546, "Input",ExpressionUUID->"1f341573-3453-4f76-b545-c8b03a69885e",
 InitializationCell->True],
Cell[271343, 7076, 6124, 126, 690, "Input",ExpressionUUID->"6566bb5d-8f70-4bdc-a06c-3ae28a9ee362",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[277504, 7207, 177, 3, 51, "Subsection",ExpressionUUID->"84fea35e-589f-4fa4-8f4b-73593028801a"],
Cell[277684, 7212, 893, 21, 90, "Input",ExpressionUUID->"aef6e4a7-617d-424b-99bc-3b7738187de5",
 InitializationCell->True],
Cell[278580, 7235, 8024, 203, 1087, "Input",ExpressionUUID->"f01e8ea5-b639-430e-9591-5c0cfb54faa0",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[286653, 7444, 174, 3, 102, "Section",ExpressionUUID->"1cec407a-1c2b-4218-9117-f024ec16274d"],
Cell[286830, 7449, 1478, 39, 234, "Input",ExpressionUUID->"de871b85-75a4-45f7-b095-1dbfcb581316",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[288333, 7492, 596, 16, 66, "Input",ExpressionUUID->"755e1ab2-8c4e-4565-8f1b-5129313f4ea3"],
Cell[288932, 7510, 324, 9, 42, "Output",ExpressionUUID->"98015a34-e4b6-45b5-a685-3fcaea8c83a8"],
Cell[289259, 7521, 261, 6, 42, "Output",ExpressionUUID->"b29ad33c-afa7-497d-b48e-c31580caf98d"]
}, Open  ]],
Cell[289535, 7530, 412, 11, 40, "Input",ExpressionUUID->"22a8871c-3010-44ae-a0a5-39b46e9a1ce0",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[289972, 7545, 251, 6, 40, "Input",ExpressionUUID->"b3f0e21c-c19b-43cb-bd0d-53e90f8d89ba"],
Cell[290226, 7553, 221, 5, 42, "Output",ExpressionUUID->"a805e116-cbd1-4ef5-8284-8f5762788be8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[290496, 7564, 155, 3, 102, "Section",ExpressionUUID->"cea95807-39ee-44ee-9fc5-9cd2b144e472"],
Cell[CellGroupData[{
Cell[290676, 7571, 164, 2, 51, "Subsection",ExpressionUUID->"fc06cd40-67f4-4e19-860c-bceaeb281294"],
Cell[290843, 7575, 154, 4, 40, "Input",ExpressionUUID->"00d86ed7-8158-4d59-86b7-5783e789f0b6",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[291034, 7584, 167, 3, 51, "Subsection",ExpressionUUID->"edc0c8db-c8ad-4b8e-a338-f89c966128d5"],
Cell[291204, 7589, 464, 13, 90, "Input",ExpressionUUID->"5c463979-f038-4db2-bfc8-971b6ac41378",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}
]
*)

